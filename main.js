!function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=50)}([function(t,e,n){"use strict";e.__esModule=!0;var r=n(52);e.erosionParams=new r.default,e.setGL=function(t){e.gl=t}},function(t,e,n){"use strict";(function(t){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
var r=n(56),i=n(57),o=n(28);function a(){return u.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function s(t,e){if(a()<e)throw new RangeError("Invalid typed array length");return u.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=u.prototype:(null===t&&(t=new u(e)),t.length=e),t}function u(t,e,n){if(!(u.TYPED_ARRAY_SUPPORT||this instanceof u))return new u(t,e,n);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return c(this,t)}return l(this,t,e,n)}function l(t,e,n,r){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,n,r){if(e.byteLength,n<0||e.byteLength<n)throw new RangeError("'offset' is out of bounds");if(e.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");e=void 0===n&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,n):new Uint8Array(e,n,r);u.TYPED_ARRAY_SUPPORT?(t=e).__proto__=u.prototype:t=f(t,e);return t}(t,e,n,r):"string"==typeof e?function(t,e,n){"string"==typeof n&&""!==n||(n="utf8");if(!u.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|g(e,n),i=(t=s(t,r)).write(e,n);i!==r&&(t=t.slice(0,i));return t}(t,e,n):function(t,e){if(u.isBuffer(e)){var n=0|d(e.length);return 0===(t=s(t,n)).length?t:(e.copy(t,0,0,n),t)}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||(r=e.length)!=r?s(t,0):f(t,e);if("Buffer"===e.type&&o(e.data))return f(t,e.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function h(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function c(t,e){if(h(e),t=s(t,e<0?0:0|d(e)),!u.TYPED_ARRAY_SUPPORT)for(var n=0;n<e;++n)t[n]=0;return t}function f(t,e){var n=e.length<0?0:0|d(e.length);t=s(t,n);for(var r=0;r<n;r+=1)t[r]=255&e[r];return t}function d(t){if(t>=a())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a().toString(16)+" bytes");return 0|t}function g(t,e){if(u.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var n=t.length;if(0===n)return 0;for(var r=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return N(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return G(t).length;default:if(r)return N(t).length;e=(""+e).toLowerCase(),r=!0}}function p(t,e,n){var r=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return P(this,e,n);case"utf8":case"utf-8":return S(this,e,n);case"ascii":return A(this,e,n);case"latin1":case"binary":return R(this,e,n);case"base64":return M(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return C(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}function v(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function m(t,e,n,r,i){if(0===t.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(i)return-1;n=t.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof e&&(e=u.from(e,r)),u.isBuffer(e))return 0===e.length?-1:_(t,e,n,r,i);if("number"==typeof e)return e&=255,u.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):_(t,[e],n,r,i);throw new TypeError("val must be string, number or Buffer")}function _(t,e,n,r,i){var o,a=1,s=t.length,u=e.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;a=2,s/=2,u/=2,n/=2}function l(t,e){return 1===a?t[e]:t.readUInt16BE(e*a)}if(i){var h=-1;for(o=n;o<s;o++)if(l(t,o)===l(e,-1===h?0:o-h)){if(-1===h&&(h=o),o-h+1===u)return h*a}else-1!==h&&(o-=o-h),h=-1}else for(n+u>s&&(n=s-u),o=n;o>=0;o--){for(var c=!0,f=0;f<u;f++)if(l(t,o+f)!==l(e,f)){c=!1;break}if(c)return o}return-1}function y(t,e,n,r){n=Number(n)||0;var i=t.length-n;r?(r=Number(r))>i&&(r=i):r=i;var o=e.length;if(o%2!=0)throw new TypeError("Invalid hex string");r>o/2&&(r=o/2);for(var a=0;a<r;++a){var s=parseInt(e.substr(2*a,2),16);if(isNaN(s))return a;t[n+a]=s}return a}function b(t,e,n,r){return j(N(e,t.length-n),t,n,r)}function x(t,e,n,r){return j(function(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}(e),t,n,r)}function w(t,e,n,r){return x(t,e,n,r)}function T(t,e,n,r){return j(G(e),t,n,r)}function E(t,e,n,r){return j(function(t,e){for(var n,r,i,o=[],a=0;a<t.length&&!((e-=2)<0);++a)n=t.charCodeAt(a),r=n>>8,i=n%256,o.push(i),o.push(r);return o}(e,t.length-n),t,n,r)}function M(t,e,n){return 0===e&&n===t.length?r.fromByteArray(t):r.fromByteArray(t.slice(e,n))}function S(t,e,n){n=Math.min(t.length,n);for(var r=[],i=e;i<n;){var o,a,s,u,l=t[i],h=null,c=l>239?4:l>223?3:l>191?2:1;if(i+c<=n)switch(c){case 1:l<128&&(h=l);break;case 2:128==(192&(o=t[i+1]))&&(u=(31&l)<<6|63&o)>127&&(h=u);break;case 3:o=t[i+1],a=t[i+2],128==(192&o)&&128==(192&a)&&(u=(15&l)<<12|(63&o)<<6|63&a)>2047&&(u<55296||u>57343)&&(h=u);break;case 4:o=t[i+1],a=t[i+2],s=t[i+3],128==(192&o)&&128==(192&a)&&128==(192&s)&&(u=(15&l)<<18|(63&o)<<12|(63&a)<<6|63&s)>65535&&u<1114112&&(h=u)}null===h?(h=65533,c=1):h>65535&&(h-=65536,r.push(h>>>10&1023|55296),h=56320|1023&h),r.push(h),i+=c}return function(t){var e=t.length;if(e<=L)return String.fromCharCode.apply(String,t);var n="",r=0;for(;r<e;)n+=String.fromCharCode.apply(String,t.slice(r,r+=L));return n}(r)}e.Buffer=u,e.SlowBuffer=function(t){+t!=t&&(t=0);return u.alloc(+t)},e.INSPECT_MAX_BYTES=50,u.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),e.kMaxLength=a(),u.poolSize=8192,u._augment=function(t){return t.__proto__=u.prototype,t},u.from=function(t,e,n){return l(null,t,e,n)},u.TYPED_ARRAY_SUPPORT&&(u.prototype.__proto__=Uint8Array.prototype,u.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&u[Symbol.species]===u&&Object.defineProperty(u,Symbol.species,{value:null,configurable:!0})),u.alloc=function(t,e,n){return function(t,e,n,r){return h(e),e<=0?s(t,e):void 0!==n?"string"==typeof r?s(t,e).fill(n,r):s(t,e).fill(n):s(t,e)}(null,t,e,n)},u.allocUnsafe=function(t){return c(null,t)},u.allocUnsafeSlow=function(t){return c(null,t)},u.isBuffer=function(t){return!(null==t||!t._isBuffer)},u.compare=function(t,e){if(!u.isBuffer(t)||!u.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var n=t.length,r=e.length,i=0,o=Math.min(n,r);i<o;++i)if(t[i]!==e[i]){n=t[i],r=e[i];break}return n<r?-1:r<n?1:0},u.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(t,e){if(!o(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return u.alloc(0);var n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;var r=u.allocUnsafe(e),i=0;for(n=0;n<t.length;++n){var a=t[n];if(!u.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(r,i),i+=a.length}return r},u.byteLength=g,u.prototype._isBuffer=!0,u.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)v(this,e,e+1);return this},u.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)v(this,e,e+3),v(this,e+1,e+2);return this},u.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)v(this,e,e+7),v(this,e+1,e+6),v(this,e+2,e+5),v(this,e+3,e+4);return this},u.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?S(this,0,t):p.apply(this,arguments)},u.prototype.equals=function(t){if(!u.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===u.compare(this,t)},u.prototype.inspect=function(){var t="",n=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(t+=" ... ")),"<Buffer "+t+">"},u.prototype.compare=function(t,e,n,r,i){if(!u.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),e<0||n>t.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&e>=n)return 0;if(r>=i)return-1;if(e>=n)return 1;if(this===t)return 0;for(var o=(i>>>=0)-(r>>>=0),a=(n>>>=0)-(e>>>=0),s=Math.min(o,a),l=this.slice(r,i),h=t.slice(e,n),c=0;c<s;++c)if(l[c]!==h[c]){o=l[c],a=h[c];break}return o<a?-1:a<o?1:0},u.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},u.prototype.indexOf=function(t,e,n){return m(this,t,e,n,!0)},u.prototype.lastIndexOf=function(t,e,n){return m(this,t,e,n,!1)},u.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-e;if((void 0===n||n>i)&&(n=i),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var o=!1;;)switch(r){case"hex":return y(this,t,e,n);case"utf8":case"utf-8":return b(this,t,e,n);case"ascii":return x(this,t,e,n);case"latin1":case"binary":return w(this,t,e,n);case"base64":return T(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return E(this,t,e,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var L=4096;function A(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(127&t[i]);return r}function R(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(t[i]);return r}function P(t,e,n){var r=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>r)&&(n=r);for(var i="",o=e;o<n;++o)i+=H(t[o]);return i}function C(t,e,n){for(var r=t.slice(e,n),i="",o=0;o<r.length;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function I(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function F(t,e,n,r,i,o){if(!u.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<o)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}function k(t,e,n,r){e<0&&(e=65535+e+1);for(var i=0,o=Math.min(t.length-n,2);i<o;++i)t[n+i]=(e&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function D(t,e,n,r){e<0&&(e=4294967295+e+1);for(var i=0,o=Math.min(t.length-n,4);i<o;++i)t[n+i]=e>>>8*(r?i:3-i)&255}function O(t,e,n,r,i,o){if(n+r>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function U(t,e,n,r,o){return o||O(t,0,n,4),i.write(t,e,n,r,23,4),n+4}function z(t,e,n,r,o){return o||O(t,0,n,8),i.write(t,e,n,r,52,8),n+8}u.prototype.slice=function(t,e){var n,r=this.length;if((t=~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),(e=void 0===e?r:~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t),u.TYPED_ARRAY_SUPPORT)(n=this.subarray(t,e)).__proto__=u.prototype;else{var i=e-t;n=new u(i,void 0);for(var o=0;o<i;++o)n[o]=this[o+t]}return n},u.prototype.readUIntLE=function(t,e,n){t|=0,e|=0,n||I(t,e,this.length);for(var r=this[t],i=1,o=0;++o<e&&(i*=256);)r+=this[t+o]*i;return r},u.prototype.readUIntBE=function(t,e,n){t|=0,e|=0,n||I(t,e,this.length);for(var r=this[t+--e],i=1;e>0&&(i*=256);)r+=this[t+--e]*i;return r},u.prototype.readUInt8=function(t,e){return e||I(t,1,this.length),this[t]},u.prototype.readUInt16LE=function(t,e){return e||I(t,2,this.length),this[t]|this[t+1]<<8},u.prototype.readUInt16BE=function(t,e){return e||I(t,2,this.length),this[t]<<8|this[t+1]},u.prototype.readUInt32LE=function(t,e){return e||I(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},u.prototype.readUInt32BE=function(t,e){return e||I(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},u.prototype.readIntLE=function(t,e,n){t|=0,e|=0,n||I(t,e,this.length);for(var r=this[t],i=1,o=0;++o<e&&(i*=256);)r+=this[t+o]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*e)),r},u.prototype.readIntBE=function(t,e,n){t|=0,e|=0,n||I(t,e,this.length);for(var r=e,i=1,o=this[t+--r];r>0&&(i*=256);)o+=this[t+--r]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*e)),o},u.prototype.readInt8=function(t,e){return e||I(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},u.prototype.readInt16LE=function(t,e){e||I(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt16BE=function(t,e){e||I(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt32LE=function(t,e){return e||I(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},u.prototype.readInt32BE=function(t,e){return e||I(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},u.prototype.readFloatLE=function(t,e){return e||I(t,4,this.length),i.read(this,t,!0,23,4)},u.prototype.readFloatBE=function(t,e){return e||I(t,4,this.length),i.read(this,t,!1,23,4)},u.prototype.readDoubleLE=function(t,e){return e||I(t,8,this.length),i.read(this,t,!0,52,8)},u.prototype.readDoubleBE=function(t,e){return e||I(t,8,this.length),i.read(this,t,!1,52,8)},u.prototype.writeUIntLE=function(t,e,n,r){(t=+t,e|=0,n|=0,r)||F(this,t,e,n,Math.pow(2,8*n)-1,0);var i=1,o=0;for(this[e]=255&t;++o<n&&(i*=256);)this[e+o]=t/i&255;return e+n},u.prototype.writeUIntBE=function(t,e,n,r){(t=+t,e|=0,n|=0,r)||F(this,t,e,n,Math.pow(2,8*n)-1,0);var i=n-1,o=1;for(this[e+i]=255&t;--i>=0&&(o*=256);)this[e+i]=t/o&255;return e+n},u.prototype.writeUInt8=function(t,e,n){return t=+t,e|=0,n||F(this,t,e,1,255,0),u.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},u.prototype.writeUInt16LE=function(t,e,n){return t=+t,e|=0,n||F(this,t,e,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):k(this,t,e,!0),e+2},u.prototype.writeUInt16BE=function(t,e,n){return t=+t,e|=0,n||F(this,t,e,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):k(this,t,e,!1),e+2},u.prototype.writeUInt32LE=function(t,e,n){return t=+t,e|=0,n||F(this,t,e,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):D(this,t,e,!0),e+4},u.prototype.writeUInt32BE=function(t,e,n){return t=+t,e|=0,n||F(this,t,e,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):D(this,t,e,!1),e+4},u.prototype.writeIntLE=function(t,e,n,r){if(t=+t,e|=0,!r){var i=Math.pow(2,8*n-1);F(this,t,e,n,i-1,-i)}var o=0,a=1,s=0;for(this[e]=255&t;++o<n&&(a*=256);)t<0&&0===s&&0!==this[e+o-1]&&(s=1),this[e+o]=(t/a>>0)-s&255;return e+n},u.prototype.writeIntBE=function(t,e,n,r){if(t=+t,e|=0,!r){var i=Math.pow(2,8*n-1);F(this,t,e,n,i-1,-i)}var o=n-1,a=1,s=0;for(this[e+o]=255&t;--o>=0&&(a*=256);)t<0&&0===s&&0!==this[e+o+1]&&(s=1),this[e+o]=(t/a>>0)-s&255;return e+n},u.prototype.writeInt8=function(t,e,n){return t=+t,e|=0,n||F(this,t,e,1,127,-128),u.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},u.prototype.writeInt16LE=function(t,e,n){return t=+t,e|=0,n||F(this,t,e,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):k(this,t,e,!0),e+2},u.prototype.writeInt16BE=function(t,e,n){return t=+t,e|=0,n||F(this,t,e,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):k(this,t,e,!1),e+2},u.prototype.writeInt32LE=function(t,e,n){return t=+t,e|=0,n||F(this,t,e,4,2147483647,-2147483648),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):D(this,t,e,!0),e+4},u.prototype.writeInt32BE=function(t,e,n){return t=+t,e|=0,n||F(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):D(this,t,e,!1),e+4},u.prototype.writeFloatLE=function(t,e,n){return U(this,t,e,!0,n)},u.prototype.writeFloatBE=function(t,e,n){return U(this,t,e,!1,n)},u.prototype.writeDoubleLE=function(t,e,n){return z(this,t,e,!0,n)},u.prototype.writeDoubleBE=function(t,e,n){return z(this,t,e,!1,n)},u.prototype.copy=function(t,e,n,r){if(n||(n=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);var i,o=r-n;if(this===t&&n<e&&e<r)for(i=o-1;i>=0;--i)t[i+e]=this[i+n];else if(o<1e3||!u.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)t[i+e]=this[i+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+o),e);return o},u.prototype.fill=function(t,e,n,r){if("string"==typeof t){if("string"==typeof e?(r=e,e=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===t.length){var i=t.charCodeAt(0);i<256&&(t=i)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!u.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;var o;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(o=e;o<n;++o)this[o]=t;else{var a=u.isBuffer(t)?t:N(new u(t,r).toString()),s=a.length;for(o=0;o<n-e;++o)this[o+e]=a[o%s]}return this};var B=/[^+\/0-9A-Za-z-_]/g;function H(t){return t<16?"0"+t.toString(16):t.toString(16)}function N(t,e){var n;e=e||1/0;for(var r=t.length,i=null,o=[],a=0;a<r;++a){if((n=t.charCodeAt(a))>55295&&n<57344){if(!i){if(n>56319){(e-=3)>-1&&o.push(239,191,189);continue}if(a+1===r){(e-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(e-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(e-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((e-=1)<0)break;o.push(n)}else if(n<2048){if((e-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function G(t){return r.toByteArray(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(B,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function j(t,e,n,r){for(var i=0;i<r&&!(i+n>=e.length||i>=t.length);++i)e[i+n]=t[i];return i}}).call(this,n(6))},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});e.__esModule=!0;var o=n(0),a=n(10),s=n(27).default,u=n(53).default,l=function(){function t(e){t.vertexShader||(t.vertexShader=a.default.compile(s,o.gl.VERTEX_SHADER)),this.shader=new a.default(t.vertexShader,e)}return t.prototype.finalizePass=function(t){},t}();e.Pass=l;var h=function(t){function e(){return t.call(this,u)||this}return i(e,t),e.prototype.initalizePass=function(t,e){t.heightMap.current().bind(0),this.shader.setUniformI(this.shader.getUniformLocation("uTexture"),0),e.setColorAttachment(t.heightMap.next())},e}(l);e.InvertPass=h},function(t,e){var n,r,i=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(t){if(n===setTimeout)return setTimeout(t,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(t){n=o}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(t){r=a}}();var u,l=[],h=!1,c=-1;function f(){h&&u&&(h=!1,u.length?l=u.concat(l):c=-1,l.length&&d())}function d(){if(!h){var t=s(f);h=!0;for(var e=l.length;e;){for(u=l,l=[];++c<e;)u&&u[c].run();c=-1,e=l.length}u=null,h=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function g(t,e){this.fun=t,this.array=e}function p(){}i.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];l.push(new g(t,e)),1!==l.length||h||s(d)},g.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=p,i.addListener=p,i.once=p,i.off=p,i.removeListener=p,i.removeAllListeners=p,i.emit=p,i.prependListener=p,i.prependOnceListener=p,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(t,e,n){"use strict";e.__esModule=!0;var r=n(8),i=n(0),o=n(97),a=n(25),s=n(117),u=function(){function t(t,e){this.mouseOverCanvas=!1,this.mousePosX=0,this.mousePosY=0,this.brushWorldSpacePosX=0,this.brushWorldSpacePosY=0,this.brushRadius=20,this.sunDir=[0,.5620833778521306,.8270805742745618];var n,r,u=t.getContext("webgl2",{antialias:!1});if(!u)throw new Error("Unable to initialize WebGL. Please use a different or newer browser.");if(i.setGL(u),this.canvas=t,this.camera=e,i.gl.getExtension("OES_texture_float_linear"),i.gl.getExtension("EXT_color_buffer_float"),i.gl.clearColor(0,0,0,0),i.gl.clearDepth(1),i.gl.enable(i.gl.DEPTH_TEST),i.gl.depthFunc(i.gl.LEQUAL),(i.gl.getParameter(i.gl.MAX_VERTEX_TEXTURE_IMAGE_UNITS)<=0||i.gl.getParameter(i.gl.MAX_VERTEX_UNIFORM_VECTORS)<256)&&alert("The website might not work correctly, please use a newer or different browser"),this.layers=new a.default,-1===(n=0))throw new Error("Couldnt allocate layer.");if((r=this.layers.getLayerMaterial(n)).setColor([.2,.2,.2]),r.setRoughness(.7),this.layers.setLayerActive(0,!0),-1===(n=1))throw new Error("Couldnt allocate layer.");if((r=this.layers.getLayerMaterial(n)).setColor([.2,.1,.05]),r.setRoughness(.9),this.layers.setLayerActive(1,!0),-1===(n=2))throw new Error("Couldnt allocate layer.");if((r=this.layers.getLayerMaterial(n)).setColor([.07,.4,.05]),r.setRoughness(.6),this.layers.setLayerActive(2,!0),-1===(n=3))throw new Error("Couldnt allocate layer.");(r=this.layers.getLayerMaterial(n)).setColor([1,1,1]),r.setRoughness(.6),this.layers.setLayerActive(3,!0),this.heightmapController=new o.default(this.layers),this.terrain=new s.default,this.resized()}return t.checkGLError=function(t){var e;for(t&&console.warn(t);(e=i.gl.getError())!==i.gl.NO_ERROR;){switch(e){case i.gl.INVALID_ENUM:console.error("INVALID_ENUM","An unacceptable value is specified for an enumerated argument.The offending command is ignored and has no other side effect than to set the error flag.");break;case i.gl.INVALID_VALUE:console.error("INVALID_VALUE","A numeric argument is out of range.The offending command is ignored and has no other side effect than to set the error flag.");break;case i.gl.INVALID_OPERATION:console.error("INVALID_OPERATION","The specified operation is not allowed in the current state.The offending command is ignored and has no other side effect than to set the error flag.");break;case i.gl.INVALID_FRAMEBUFFER_OPERATION:console.error("INVALID_FRAMEBUFFER_OPERATION","The framebuffer object is not complete.The offending command is ignored and has no other side effect than to set the error flag.");break;case i.gl.OUT_OF_MEMORY:console.error("OUT_OF_MEMORY","There is not enough memory left to execute the command.The state of the GL is undefined, except for the state of the error flags, after this error is recorded.");break;default:console.error(e)}t=void 0}},t.prototype.render=function(t,e){this.heightmapController.queuePass(this.heightmapController.erosionWaterFluxPass),this.heightmapController.queuePass(this.heightmapController.erosionSoilFluxPass),this.heightmapController.queuePass(this.heightmapController.erosionSuspensionDepositionPass),this.heightmapController.queuePass(this.heightmapController.erosionSedimentAdvectionPass),this.heightmapController.queuePass(this.heightmapController.erosionSoilAdvectionPass),this.heightmapController.render(),i.gl.clear(i.gl.COLOR_BUFFER_BIT|i.gl.DEPTH_BUFFER_BIT);var n=r.mat4.create();r.mat4.multiply(n,this.camera.projectionMatrix,this.camera.viewMatrix),this.terrain.draw(t,n,this.camera.getPosition(),this.sunDir,this.heightmapController.textures,this.layers,this.brushRadius,this.mouseOverCanvas,this.mousePosX,this.mousePosY,this.brushWorldSpacePosX,this.brushWorldSpacePosY,0!==this.brushWorldSpacePosX||0!==this.brushWorldSpacePosY)},t.prototype.resized=function(){var t=this.canvas.clientWidth,e=this.canvas.clientHeight;i.gl.canvas.width=t,i.gl.canvas.height=e,i.gl.viewport(0,0,t,e),this.camera.aspectRatio=t/e,this.camera.updateProjectionMatrix(),this.terrain.resize()},t.prototype.getTerrain=function(){return this.terrain},t.prototype.getHeightmapRenderer=function(){return this.heightmapController},t.prototype.setCanvasMouseState=function(t,e,n,r,i,o){this.mouseOverCanvas=t,this.mousePosX=e,this.mousePosY=n,this.brushWorldSpacePosX=r,this.brushWorldSpacePosY=i,this.brushRadius=o},t}();e.default=u},function(t,e,n){(function(t){var r=Object.getOwnPropertyDescriptors||function(t){for(var e=Object.keys(t),n={},r=0;r<e.length;r++)n[e[r]]=Object.getOwnPropertyDescriptor(t,e[r]);return n},i=/%[sdj%]/g;e.format=function(t){if(!m(t)){for(var e=[],n=0;n<arguments.length;n++)e.push(s(arguments[n]));return e.join(" ")}n=1;for(var r=arguments,o=r.length,a=String(t).replace(i,(function(t){if("%%"===t)return"%";if(n>=o)return t;switch(t){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(t){return"[Circular]"}default:return t}})),u=r[n];n<o;u=r[++n])p(u)||!b(u)?a+=" "+u:a+=" "+s(u);return a},e.deprecate=function(n,r){if(void 0!==t&&!0===t.noDeprecation)return n;if(void 0===t)return function(){return e.deprecate(n,r).apply(this,arguments)};var i=!1;return function(){if(!i){if(t.throwDeprecation)throw new Error(r);t.traceDeprecation?console.trace(r):console.error(r),i=!0}return n.apply(this,arguments)}};var o,a={};function s(t,n){var r={seen:[],stylize:l};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),g(n)?r.showHidden=n:n&&e._extend(r,n),_(r.showHidden)&&(r.showHidden=!1),_(r.depth)&&(r.depth=2),_(r.colors)&&(r.colors=!1),_(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=u),h(r,t,r.depth)}function u(t,e){var n=s.styles[e];return n?"["+s.colors[n][0]+"m"+t+"["+s.colors[n][1]+"m":t}function l(t,e){return t}function h(t,n,r){if(t.customInspect&&n&&T(n.inspect)&&n.inspect!==e.inspect&&(!n.constructor||n.constructor.prototype!==n)){var i=n.inspect(r,t);return m(i)||(i=h(t,i,r)),i}var o=function(t,e){if(_(e))return t.stylize("undefined","undefined");if(m(e)){var n="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(n,"string")}if(v(e))return t.stylize(""+e,"number");if(g(e))return t.stylize(""+e,"boolean");if(p(e))return t.stylize("null","null")}(t,n);if(o)return o;var a=Object.keys(n),s=function(t){var e={};return t.forEach((function(t,n){e[t]=!0})),e}(a);if(t.showHidden&&(a=Object.getOwnPropertyNames(n)),w(n)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return c(n);if(0===a.length){if(T(n)){var u=n.name?": "+n.name:"";return t.stylize("[Function"+u+"]","special")}if(y(n))return t.stylize(RegExp.prototype.toString.call(n),"regexp");if(x(n))return t.stylize(Date.prototype.toString.call(n),"date");if(w(n))return c(n)}var l,b="",E=!1,M=["{","}"];(d(n)&&(E=!0,M=["[","]"]),T(n))&&(b=" [Function"+(n.name?": "+n.name:"")+"]");return y(n)&&(b=" "+RegExp.prototype.toString.call(n)),x(n)&&(b=" "+Date.prototype.toUTCString.call(n)),w(n)&&(b=" "+c(n)),0!==a.length||E&&0!=n.length?r<0?y(n)?t.stylize(RegExp.prototype.toString.call(n),"regexp"):t.stylize("[Object]","special"):(t.seen.push(n),l=E?function(t,e,n,r,i){for(var o=[],a=0,s=e.length;a<s;++a)A(e,String(a))?o.push(f(t,e,n,r,String(a),!0)):o.push("");return i.forEach((function(i){i.match(/^\d+$/)||o.push(f(t,e,n,r,i,!0))})),o}(t,n,r,s,a):a.map((function(e){return f(t,n,r,s,e,E)})),t.seen.pop(),function(t,e,n){if(t.reduce((function(t,e){return e.indexOf("\n")>=0&&0,t+e.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60)return n[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+n[1];return n[0]+e+" "+t.join(", ")+" "+n[1]}(l,b,M)):M[0]+b+M[1]}function c(t){return"["+Error.prototype.toString.call(t)+"]"}function f(t,e,n,r,i,o){var a,s,u;if((u=Object.getOwnPropertyDescriptor(e,i)||{value:e[i]}).get?s=u.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):u.set&&(s=t.stylize("[Setter]","special")),A(r,i)||(a="["+i+"]"),s||(t.seen.indexOf(u.value)<0?(s=p(n)?h(t,u.value,null):h(t,u.value,n-1)).indexOf("\n")>-1&&(s=o?s.split("\n").map((function(t){return"  "+t})).join("\n").substr(2):"\n"+s.split("\n").map((function(t){return"   "+t})).join("\n")):s=t.stylize("[Circular]","special")),_(a)){if(o&&i.match(/^\d+$/))return s;(a=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=t.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=t.stylize(a,"string"))}return a+": "+s}function d(t){return Array.isArray(t)}function g(t){return"boolean"==typeof t}function p(t){return null===t}function v(t){return"number"==typeof t}function m(t){return"string"==typeof t}function _(t){return void 0===t}function y(t){return b(t)&&"[object RegExp]"===E(t)}function b(t){return"object"==typeof t&&null!==t}function x(t){return b(t)&&"[object Date]"===E(t)}function w(t){return b(t)&&("[object Error]"===E(t)||t instanceof Error)}function T(t){return"function"==typeof t}function E(t){return Object.prototype.toString.call(t)}function M(t){return t<10?"0"+t.toString(10):t.toString(10)}e.debuglog=function(n){if(_(o)&&(o=t.env.NODE_DEBUG||""),n=n.toUpperCase(),!a[n])if(new RegExp("\\b"+n+"\\b","i").test(o)){var r=t.pid;a[n]=function(){var t=e.format.apply(e,arguments);console.error("%s %d: %s",n,r,t)}}else a[n]=function(){};return a[n]},e.inspect=s,s.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},s.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},e.isArray=d,e.isBoolean=g,e.isNull=p,e.isNullOrUndefined=function(t){return null==t},e.isNumber=v,e.isString=m,e.isSymbol=function(t){return"symbol"==typeof t},e.isUndefined=_,e.isRegExp=y,e.isObject=b,e.isDate=x,e.isError=w,e.isFunction=T,e.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},e.isBuffer=n(59);var S=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function L(){var t=new Date,e=[M(t.getHours()),M(t.getMinutes()),M(t.getSeconds())].join(":");return[t.getDate(),S[t.getMonth()],e].join(" ")}function A(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.log=function(){console.log("%s - %s",L(),e.format.apply(e,arguments))},e.inherits=n(60),e._extend=function(t,e){if(!e||!b(e))return t;for(var n=Object.keys(e),r=n.length;r--;)t[n[r]]=e[n[r]];return t};var R="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function P(t,e){if(!t){var n=new Error("Promise was rejected with a falsy value");n.reason=t,t=n}return e(t)}e.promisify=function(t){if("function"!=typeof t)throw new TypeError('The "original" argument must be of type Function');if(R&&t[R]){var e;if("function"!=typeof(e=t[R]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(e,R,{value:e,enumerable:!1,writable:!1,configurable:!0}),e}function e(){for(var e,n,r=new Promise((function(t,r){e=t,n=r})),i=[],o=0;o<arguments.length;o++)i.push(arguments[o]);i.push((function(t,r){t?n(t):e(r)}));try{t.apply(this,i)}catch(t){n(t)}return r}return Object.setPrototypeOf(e,Object.getPrototypeOf(t)),R&&Object.defineProperty(e,R,{value:e,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(e,r(t))},e.promisify.custom=R,e.callbackify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');function n(){for(var n=[],r=0;r<arguments.length;r++)n.push(arguments[r]);var i=n.pop();if("function"!=typeof i)throw new TypeError("The last argument must be of type Function");var o=this,a=function(){return i.apply(o,arguments)};e.apply(this,n).then((function(e){t.nextTick(a,null,e)}),(function(e){t.nextTick(P,e,a)}))}return Object.setPrototypeOf(n,Object.getPrototypeOf(e)),Object.defineProperties(n,r(e)),n}}).call(this,n(3))},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){"use strict";var r=n(17),i=Object.keys||function(t){var e=[];for(var n in t)e.push(n);return e};t.exports=c;var o=n(12);o.inherits=n(11);var a=n(29),s=n(22);o.inherits(c,a);for(var u=i(s.prototype),l=0;l<u.length;l++){var h=u[l];c.prototype[h]||(c.prototype[h]=s.prototype[h])}function c(t){if(!(this instanceof c))return new c(t);a.call(this,t),s.call(this,t),t&&!1===t.readable&&(this.readable=!1),t&&!1===t.writable&&(this.writable=!1),this.allowHalfOpen=!0,t&&!1===t.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",f)}function f(){this.allowHalfOpen||this._writableState.ended||r.nextTick(d,this)}function d(t){t.end()}Object.defineProperty(c.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(c.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(t){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=t,this._writableState.destroyed=t)}}),c.prototype._destroy=function(t,e){this.push(null),this.end(),r.nextTick(e,t)}},function(t,e,n){"use strict";n.r(e);var r={};n.r(r),n.d(r,"EPSILON",(function(){return d})),n.d(r,"ARRAY_TYPE",(function(){return g})),n.d(r,"RANDOM",(function(){return p})),n.d(r,"setMatrixArrayType",(function(){return v})),n.d(r,"toRadian",(function(){return _})),n.d(r,"equals",(function(){return y}));var i={};n.r(i),n.d(i,"create",(function(){return b})),n.d(i,"clone",(function(){return x})),n.d(i,"copy",(function(){return w})),n.d(i,"identity",(function(){return T})),n.d(i,"fromValues",(function(){return E})),n.d(i,"set",(function(){return M})),n.d(i,"transpose",(function(){return S})),n.d(i,"invert",(function(){return L})),n.d(i,"adjoint",(function(){return A})),n.d(i,"determinant",(function(){return R})),n.d(i,"multiply",(function(){return P})),n.d(i,"rotate",(function(){return C})),n.d(i,"scale",(function(){return I})),n.d(i,"fromRotation",(function(){return F})),n.d(i,"fromScaling",(function(){return k})),n.d(i,"str",(function(){return D})),n.d(i,"frob",(function(){return O})),n.d(i,"LDU",(function(){return U})),n.d(i,"add",(function(){return z})),n.d(i,"subtract",(function(){return B})),n.d(i,"exactEquals",(function(){return H})),n.d(i,"equals",(function(){return N})),n.d(i,"multiplyScalar",(function(){return G})),n.d(i,"multiplyScalarAndAdd",(function(){return j})),n.d(i,"mul",(function(){return W})),n.d(i,"sub",(function(){return X}));var o={};n.r(o),n.d(o,"create",(function(){return Y})),n.d(o,"clone",(function(){return q})),n.d(o,"copy",(function(){return V})),n.d(o,"identity",(function(){return Z})),n.d(o,"fromValues",(function(){return K})),n.d(o,"set",(function(){return Q})),n.d(o,"invert",(function(){return J})),n.d(o,"determinant",(function(){return $})),n.d(o,"multiply",(function(){return tt})),n.d(o,"rotate",(function(){return et})),n.d(o,"scale",(function(){return nt})),n.d(o,"translate",(function(){return rt})),n.d(o,"fromRotation",(function(){return it})),n.d(o,"fromScaling",(function(){return ot})),n.d(o,"fromTranslation",(function(){return at})),n.d(o,"str",(function(){return st})),n.d(o,"frob",(function(){return ut})),n.d(o,"add",(function(){return lt})),n.d(o,"subtract",(function(){return ht})),n.d(o,"multiplyScalar",(function(){return ct})),n.d(o,"multiplyScalarAndAdd",(function(){return ft})),n.d(o,"exactEquals",(function(){return dt})),n.d(o,"equals",(function(){return gt})),n.d(o,"mul",(function(){return pt})),n.d(o,"sub",(function(){return vt}));var a={};n.r(a),n.d(a,"create",(function(){return mt})),n.d(a,"fromMat4",(function(){return _t})),n.d(a,"clone",(function(){return yt})),n.d(a,"copy",(function(){return bt})),n.d(a,"fromValues",(function(){return xt})),n.d(a,"set",(function(){return wt})),n.d(a,"identity",(function(){return Tt})),n.d(a,"transpose",(function(){return Et})),n.d(a,"invert",(function(){return Mt})),n.d(a,"adjoint",(function(){return St})),n.d(a,"determinant",(function(){return Lt})),n.d(a,"multiply",(function(){return At})),n.d(a,"translate",(function(){return Rt})),n.d(a,"rotate",(function(){return Pt})),n.d(a,"scale",(function(){return Ct})),n.d(a,"fromTranslation",(function(){return It})),n.d(a,"fromRotation",(function(){return Ft})),n.d(a,"fromScaling",(function(){return kt})),n.d(a,"fromMat2d",(function(){return Dt})),n.d(a,"fromQuat",(function(){return Ot})),n.d(a,"normalFromMat4",(function(){return Ut})),n.d(a,"projection",(function(){return zt})),n.d(a,"str",(function(){return Bt})),n.d(a,"frob",(function(){return Ht})),n.d(a,"add",(function(){return Nt})),n.d(a,"subtract",(function(){return Gt})),n.d(a,"multiplyScalar",(function(){return jt})),n.d(a,"multiplyScalarAndAdd",(function(){return Wt})),n.d(a,"exactEquals",(function(){return Xt})),n.d(a,"equals",(function(){return Yt})),n.d(a,"mul",(function(){return qt})),n.d(a,"sub",(function(){return Vt}));var s={};n.r(s),n.d(s,"create",(function(){return Zt})),n.d(s,"clone",(function(){return Kt})),n.d(s,"copy",(function(){return Qt})),n.d(s,"fromValues",(function(){return Jt})),n.d(s,"set",(function(){return $t})),n.d(s,"identity",(function(){return te})),n.d(s,"transpose",(function(){return ee})),n.d(s,"invert",(function(){return ne})),n.d(s,"adjoint",(function(){return re})),n.d(s,"determinant",(function(){return ie})),n.d(s,"multiply",(function(){return oe})),n.d(s,"translate",(function(){return ae})),n.d(s,"scale",(function(){return se})),n.d(s,"rotate",(function(){return ue})),n.d(s,"rotateX",(function(){return le})),n.d(s,"rotateY",(function(){return he})),n.d(s,"rotateZ",(function(){return ce})),n.d(s,"fromTranslation",(function(){return fe})),n.d(s,"fromScaling",(function(){return de})),n.d(s,"fromRotation",(function(){return ge})),n.d(s,"fromXRotation",(function(){return pe})),n.d(s,"fromYRotation",(function(){return ve})),n.d(s,"fromZRotation",(function(){return me})),n.d(s,"fromRotationTranslation",(function(){return _e})),n.d(s,"fromQuat2",(function(){return ye})),n.d(s,"getTranslation",(function(){return be})),n.d(s,"getScaling",(function(){return xe})),n.d(s,"getRotation",(function(){return we})),n.d(s,"fromRotationTranslationScale",(function(){return Te})),n.d(s,"fromRotationTranslationScaleOrigin",(function(){return Ee})),n.d(s,"fromQuat",(function(){return Me})),n.d(s,"frustum",(function(){return Se})),n.d(s,"perspective",(function(){return Le})),n.d(s,"perspectiveFromFieldOfView",(function(){return Ae})),n.d(s,"ortho",(function(){return Re})),n.d(s,"lookAt",(function(){return Pe})),n.d(s,"targetTo",(function(){return Ce})),n.d(s,"str",(function(){return Ie})),n.d(s,"frob",(function(){return Fe})),n.d(s,"add",(function(){return ke})),n.d(s,"subtract",(function(){return De})),n.d(s,"multiplyScalar",(function(){return Oe})),n.d(s,"multiplyScalarAndAdd",(function(){return Ue})),n.d(s,"exactEquals",(function(){return ze})),n.d(s,"equals",(function(){return Be})),n.d(s,"mul",(function(){return He})),n.d(s,"sub",(function(){return Ne}));var u={};n.r(u),n.d(u,"create",(function(){return Ge})),n.d(u,"clone",(function(){return je})),n.d(u,"length",(function(){return We})),n.d(u,"fromValues",(function(){return Xe})),n.d(u,"copy",(function(){return Ye})),n.d(u,"set",(function(){return qe})),n.d(u,"add",(function(){return Ve})),n.d(u,"subtract",(function(){return Ze})),n.d(u,"multiply",(function(){return Ke})),n.d(u,"divide",(function(){return Qe})),n.d(u,"ceil",(function(){return Je})),n.d(u,"floor",(function(){return $e})),n.d(u,"min",(function(){return tn})),n.d(u,"max",(function(){return en})),n.d(u,"round",(function(){return nn})),n.d(u,"scale",(function(){return rn})),n.d(u,"scaleAndAdd",(function(){return on})),n.d(u,"distance",(function(){return an})),n.d(u,"squaredDistance",(function(){return sn})),n.d(u,"squaredLength",(function(){return un})),n.d(u,"negate",(function(){return ln})),n.d(u,"inverse",(function(){return hn})),n.d(u,"normalize",(function(){return cn})),n.d(u,"dot",(function(){return fn})),n.d(u,"cross",(function(){return dn})),n.d(u,"lerp",(function(){return gn})),n.d(u,"hermite",(function(){return pn})),n.d(u,"bezier",(function(){return vn})),n.d(u,"random",(function(){return mn})),n.d(u,"transformMat4",(function(){return _n})),n.d(u,"transformMat3",(function(){return yn})),n.d(u,"transformQuat",(function(){return bn})),n.d(u,"rotateX",(function(){return xn})),n.d(u,"rotateY",(function(){return wn})),n.d(u,"rotateZ",(function(){return Tn})),n.d(u,"angle",(function(){return En})),n.d(u,"zero",(function(){return Mn})),n.d(u,"str",(function(){return Sn})),n.d(u,"exactEquals",(function(){return Ln})),n.d(u,"equals",(function(){return An})),n.d(u,"sub",(function(){return Pn})),n.d(u,"mul",(function(){return Cn})),n.d(u,"div",(function(){return In})),n.d(u,"dist",(function(){return Fn})),n.d(u,"sqrDist",(function(){return kn})),n.d(u,"len",(function(){return Dn})),n.d(u,"sqrLen",(function(){return On})),n.d(u,"forEach",(function(){return Un}));var l={};n.r(l),n.d(l,"create",(function(){return zn})),n.d(l,"clone",(function(){return Bn})),n.d(l,"fromValues",(function(){return Hn})),n.d(l,"copy",(function(){return Nn})),n.d(l,"set",(function(){return Gn})),n.d(l,"add",(function(){return jn})),n.d(l,"subtract",(function(){return Wn})),n.d(l,"multiply",(function(){return Xn})),n.d(l,"divide",(function(){return Yn})),n.d(l,"ceil",(function(){return qn})),n.d(l,"floor",(function(){return Vn})),n.d(l,"min",(function(){return Zn})),n.d(l,"max",(function(){return Kn})),n.d(l,"round",(function(){return Qn})),n.d(l,"scale",(function(){return Jn})),n.d(l,"scaleAndAdd",(function(){return $n})),n.d(l,"distance",(function(){return tr})),n.d(l,"squaredDistance",(function(){return er})),n.d(l,"length",(function(){return nr})),n.d(l,"squaredLength",(function(){return rr})),n.d(l,"negate",(function(){return ir})),n.d(l,"inverse",(function(){return or})),n.d(l,"normalize",(function(){return ar})),n.d(l,"dot",(function(){return sr})),n.d(l,"cross",(function(){return ur})),n.d(l,"lerp",(function(){return lr})),n.d(l,"random",(function(){return hr})),n.d(l,"transformMat4",(function(){return cr})),n.d(l,"transformQuat",(function(){return fr})),n.d(l,"zero",(function(){return dr})),n.d(l,"str",(function(){return gr})),n.d(l,"exactEquals",(function(){return pr})),n.d(l,"equals",(function(){return vr})),n.d(l,"sub",(function(){return mr})),n.d(l,"mul",(function(){return _r})),n.d(l,"div",(function(){return yr})),n.d(l,"dist",(function(){return br})),n.d(l,"sqrDist",(function(){return xr})),n.d(l,"len",(function(){return wr})),n.d(l,"sqrLen",(function(){return Tr})),n.d(l,"forEach",(function(){return Er}));var h={};n.r(h),n.d(h,"create",(function(){return Mr})),n.d(h,"identity",(function(){return Sr})),n.d(h,"setAxisAngle",(function(){return Lr})),n.d(h,"getAxisAngle",(function(){return Ar})),n.d(h,"getAngle",(function(){return Rr})),n.d(h,"multiply",(function(){return Pr})),n.d(h,"rotateX",(function(){return Cr})),n.d(h,"rotateY",(function(){return Ir})),n.d(h,"rotateZ",(function(){return Fr})),n.d(h,"calculateW",(function(){return kr})),n.d(h,"exp",(function(){return Dr})),n.d(h,"ln",(function(){return Or})),n.d(h,"pow",(function(){return Ur})),n.d(h,"slerp",(function(){return zr})),n.d(h,"random",(function(){return Br})),n.d(h,"invert",(function(){return Hr})),n.d(h,"conjugate",(function(){return Nr})),n.d(h,"fromMat3",(function(){return Gr})),n.d(h,"fromEuler",(function(){return jr})),n.d(h,"str",(function(){return Wr})),n.d(h,"clone",(function(){return Qr})),n.d(h,"fromValues",(function(){return Jr})),n.d(h,"copy",(function(){return $r})),n.d(h,"set",(function(){return ti})),n.d(h,"add",(function(){return ei})),n.d(h,"mul",(function(){return ni})),n.d(h,"scale",(function(){return ri})),n.d(h,"dot",(function(){return ii})),n.d(h,"lerp",(function(){return oi})),n.d(h,"length",(function(){return ai})),n.d(h,"len",(function(){return si})),n.d(h,"squaredLength",(function(){return ui})),n.d(h,"sqrLen",(function(){return li})),n.d(h,"normalize",(function(){return hi})),n.d(h,"exactEquals",(function(){return ci})),n.d(h,"equals",(function(){return fi})),n.d(h,"rotationTo",(function(){return di})),n.d(h,"sqlerp",(function(){return gi})),n.d(h,"setAxes",(function(){return pi}));var c={};n.r(c),n.d(c,"create",(function(){return vi})),n.d(c,"clone",(function(){return mi})),n.d(c,"fromValues",(function(){return _i})),n.d(c,"fromRotationTranslationValues",(function(){return yi})),n.d(c,"fromRotationTranslation",(function(){return bi})),n.d(c,"fromTranslation",(function(){return xi})),n.d(c,"fromRotation",(function(){return wi})),n.d(c,"fromMat4",(function(){return Ti})),n.d(c,"copy",(function(){return Ei})),n.d(c,"identity",(function(){return Mi})),n.d(c,"set",(function(){return Si})),n.d(c,"getReal",(function(){return Li})),n.d(c,"getDual",(function(){return Ai})),n.d(c,"setReal",(function(){return Ri})),n.d(c,"setDual",(function(){return Pi})),n.d(c,"getTranslation",(function(){return Ci})),n.d(c,"translate",(function(){return Ii})),n.d(c,"rotateX",(function(){return Fi})),n.d(c,"rotateY",(function(){return ki})),n.d(c,"rotateZ",(function(){return Di})),n.d(c,"rotateByQuatAppend",(function(){return Oi})),n.d(c,"rotateByQuatPrepend",(function(){return Ui})),n.d(c,"rotateAroundAxis",(function(){return zi})),n.d(c,"add",(function(){return Bi})),n.d(c,"multiply",(function(){return Hi})),n.d(c,"mul",(function(){return Ni})),n.d(c,"scale",(function(){return Gi})),n.d(c,"dot",(function(){return ji})),n.d(c,"lerp",(function(){return Wi})),n.d(c,"invert",(function(){return Xi})),n.d(c,"conjugate",(function(){return Yi})),n.d(c,"length",(function(){return qi})),n.d(c,"len",(function(){return Vi})),n.d(c,"squaredLength",(function(){return Zi})),n.d(c,"sqrLen",(function(){return Ki})),n.d(c,"normalize",(function(){return Qi})),n.d(c,"str",(function(){return Ji})),n.d(c,"exactEquals",(function(){return $i})),n.d(c,"equals",(function(){return to}));var f={};n.r(f),n.d(f,"create",(function(){return eo})),n.d(f,"clone",(function(){return no})),n.d(f,"fromValues",(function(){return ro})),n.d(f,"copy",(function(){return io})),n.d(f,"set",(function(){return oo})),n.d(f,"add",(function(){return ao})),n.d(f,"subtract",(function(){return so})),n.d(f,"multiply",(function(){return uo})),n.d(f,"divide",(function(){return lo})),n.d(f,"ceil",(function(){return ho})),n.d(f,"floor",(function(){return co})),n.d(f,"min",(function(){return fo})),n.d(f,"max",(function(){return go})),n.d(f,"round",(function(){return po})),n.d(f,"scale",(function(){return vo})),n.d(f,"scaleAndAdd",(function(){return mo})),n.d(f,"distance",(function(){return _o})),n.d(f,"squaredDistance",(function(){return yo})),n.d(f,"length",(function(){return bo})),n.d(f,"squaredLength",(function(){return xo})),n.d(f,"negate",(function(){return wo})),n.d(f,"inverse",(function(){return To})),n.d(f,"normalize",(function(){return Eo})),n.d(f,"dot",(function(){return Mo})),n.d(f,"cross",(function(){return So})),n.d(f,"lerp",(function(){return Lo})),n.d(f,"random",(function(){return Ao})),n.d(f,"transformMat2",(function(){return Ro})),n.d(f,"transformMat2d",(function(){return Po})),n.d(f,"transformMat3",(function(){return Co})),n.d(f,"transformMat4",(function(){return Io})),n.d(f,"rotate",(function(){return Fo})),n.d(f,"angle",(function(){return ko})),n.d(f,"zero",(function(){return Do})),n.d(f,"str",(function(){return Oo})),n.d(f,"exactEquals",(function(){return Uo})),n.d(f,"equals",(function(){return zo})),n.d(f,"len",(function(){return Bo})),n.d(f,"sub",(function(){return Ho})),n.d(f,"mul",(function(){return No})),n.d(f,"div",(function(){return Go})),n.d(f,"dist",(function(){return jo})),n.d(f,"sqrDist",(function(){return Wo})),n.d(f,"sqrLen",(function(){return Xo})),n.d(f,"forEach",(function(){return Yo}));var d=1e-6,g="undefined"!=typeof Float32Array?Float32Array:Array,p=Math.random;function v(t){g=t}var m=Math.PI/180;function _(t){return t*m}function y(t,e){return Math.abs(t-e)<=d*Math.max(1,Math.abs(t),Math.abs(e))}function b(){var t=new g(4);return g!=Float32Array&&(t[1]=0,t[2]=0),t[0]=1,t[3]=1,t}function x(t){var e=new g(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function w(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function T(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t}function E(t,e,n,r){var i=new g(4);return i[0]=t,i[1]=e,i[2]=n,i[3]=r,i}function M(t,e,n,r,i){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t}function S(t,e){if(t===e){var n=e[1];t[1]=e[2],t[2]=n}else t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3];return t}function L(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=n*o-i*r;return a?(a=1/a,t[0]=o*a,t[1]=-r*a,t[2]=-i*a,t[3]=n*a,t):null}function A(t,e){var n=e[0];return t[0]=e[3],t[1]=-e[1],t[2]=-e[2],t[3]=n,t}function R(t){return t[0]*t[3]-t[2]*t[1]}function P(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=n[0],u=n[1],l=n[2],h=n[3];return t[0]=r*s+o*u,t[1]=i*s+a*u,t[2]=r*l+o*h,t[3]=i*l+a*h,t}function C(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=Math.sin(n),u=Math.cos(n);return t[0]=r*u+o*s,t[1]=i*u+a*s,t[2]=r*-s+o*u,t[3]=i*-s+a*u,t}function I(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=n[0],u=n[1];return t[0]=r*s,t[1]=i*s,t[2]=o*u,t[3]=a*u,t}function F(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=-n,t[3]=r,t}function k(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t}function D(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function O(t){return Math.hypot(t[0],t[1],t[2],t[3])}function U(t,e,n,r){return t[2]=r[2]/r[0],n[0]=r[0],n[1]=r[1],n[3]=r[3]-t[2]*n[1],[t,e,n]}function z(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t}function B(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t}function H(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function N(t,e){var n=t[0],r=t[1],i=t[2],o=t[3],a=e[0],s=e[1],u=e[2],l=e[3];return Math.abs(n-a)<=d*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(r-s)<=d*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(i-u)<=d*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(o-l)<=d*Math.max(1,Math.abs(o),Math.abs(l))}function G(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function j(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var W=P,X=B;function Y(){var t=new g(6);return g!=Float32Array&&(t[1]=0,t[2]=0,t[4]=0,t[5]=0),t[0]=1,t[3]=1,t}function q(t){var e=new g(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e}function V(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function Z(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t}function K(t,e,n,r,i,o){var a=new g(6);return a[0]=t,a[1]=e,a[2]=n,a[3]=r,a[4]=i,a[5]=o,a}function Q(t,e,n,r,i,o,a){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=o,t[5]=a,t}function J(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=n*o-r*i;return u?(u=1/u,t[0]=o*u,t[1]=-r*u,t[2]=-i*u,t[3]=n*u,t[4]=(i*s-o*a)*u,t[5]=(r*a-n*s)*u,t):null}function $(t){return t[0]*t[3]-t[1]*t[2]}function tt(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],l=n[0],h=n[1],c=n[2],f=n[3],d=n[4],g=n[5];return t[0]=r*l+o*h,t[1]=i*l+a*h,t[2]=r*c+o*f,t[3]=i*c+a*f,t[4]=r*d+o*g+s,t[5]=i*d+a*g+u,t}function et(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],l=Math.sin(n),h=Math.cos(n);return t[0]=r*h+o*l,t[1]=i*h+a*l,t[2]=r*-l+o*h,t[3]=i*-l+a*h,t[4]=s,t[5]=u,t}function nt(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],l=n[0],h=n[1];return t[0]=r*l,t[1]=i*l,t[2]=o*h,t[3]=a*h,t[4]=s,t[5]=u,t}function rt(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],l=n[0],h=n[1];return t[0]=r,t[1]=i,t[2]=o,t[3]=a,t[4]=r*l+o*h+s,t[5]=i*l+a*h+u,t}function it(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=-n,t[3]=r,t[4]=0,t[5]=0,t}function ot(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t[4]=0,t[5]=0,t}function at(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t}function st(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"}function ut(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],1)}function lt(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t}function ht(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t}function ct(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t}function ft(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t}function dt(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]}function gt(t,e){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=e[0],l=e[1],h=e[2],c=e[3],f=e[4],g=e[5];return Math.abs(n-u)<=d*Math.max(1,Math.abs(n),Math.abs(u))&&Math.abs(r-l)<=d*Math.max(1,Math.abs(r),Math.abs(l))&&Math.abs(i-h)<=d*Math.max(1,Math.abs(i),Math.abs(h))&&Math.abs(o-c)<=d*Math.max(1,Math.abs(o),Math.abs(c))&&Math.abs(a-f)<=d*Math.max(1,Math.abs(a),Math.abs(f))&&Math.abs(s-g)<=d*Math.max(1,Math.abs(s),Math.abs(g))}var pt=tt,vt=ht;function mt(){var t=new g(9);return g!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function _t(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t}function yt(t){var e=new g(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function bt(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function xt(t,e,n,r,i,o,a,s,u){var l=new g(9);return l[0]=t,l[1]=e,l[2]=n,l[3]=r,l[4]=i,l[5]=o,l[6]=a,l[7]=s,l[8]=u,l}function wt(t,e,n,r,i,o,a,s,u,l){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=o,t[5]=a,t[6]=s,t[7]=u,t[8]=l,t}function Tt(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function Et(t,e){if(t===e){var n=e[1],r=e[2],i=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=r,t[7]=i}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}function Mt(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],l=e[7],h=e[8],c=h*a-s*l,f=-h*o+s*u,d=l*o-a*u,g=n*c+r*f+i*d;return g?(g=1/g,t[0]=c*g,t[1]=(-h*r+i*l)*g,t[2]=(s*r-i*a)*g,t[3]=f*g,t[4]=(h*n-i*u)*g,t[5]=(-s*n+i*o)*g,t[6]=d*g,t[7]=(-l*n+r*u)*g,t[8]=(a*n-r*o)*g,t):null}function St(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],l=e[7],h=e[8];return t[0]=a*h-s*l,t[1]=i*l-r*h,t[2]=r*s-i*a,t[3]=s*u-o*h,t[4]=n*h-i*u,t[5]=i*o-n*s,t[6]=o*l-a*u,t[7]=r*u-n*l,t[8]=n*a-r*o,t}function Lt(t){var e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],a=t[5],s=t[6],u=t[7],l=t[8];return e*(l*o-a*u)+n*(-l*i+a*s)+r*(u*i-o*s)}function At(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],l=e[6],h=e[7],c=e[8],f=n[0],d=n[1],g=n[2],p=n[3],v=n[4],m=n[5],_=n[6],y=n[7],b=n[8];return t[0]=f*r+d*a+g*l,t[1]=f*i+d*s+g*h,t[2]=f*o+d*u+g*c,t[3]=p*r+v*a+m*l,t[4]=p*i+v*s+m*h,t[5]=p*o+v*u+m*c,t[6]=_*r+y*a+b*l,t[7]=_*i+y*s+b*h,t[8]=_*o+y*u+b*c,t}function Rt(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],l=e[6],h=e[7],c=e[8],f=n[0],d=n[1];return t[0]=r,t[1]=i,t[2]=o,t[3]=a,t[4]=s,t[5]=u,t[6]=f*r+d*a+l,t[7]=f*i+d*s+h,t[8]=f*o+d*u+c,t}function Pt(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],l=e[6],h=e[7],c=e[8],f=Math.sin(n),d=Math.cos(n);return t[0]=d*r+f*a,t[1]=d*i+f*s,t[2]=d*o+f*u,t[3]=d*a-f*r,t[4]=d*s-f*i,t[5]=d*u-f*o,t[6]=l,t[7]=h,t[8]=c,t}function Ct(t,e,n){var r=n[0],i=n[1];return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=i*e[3],t[4]=i*e[4],t[5]=i*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function It(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t}function Ft(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=-n,t[4]=r,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function kt(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function Dt(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t}function Ot(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=n+n,s=r+r,u=i+i,l=n*a,h=r*a,c=r*s,f=i*a,d=i*s,g=i*u,p=o*a,v=o*s,m=o*u;return t[0]=1-c-g,t[3]=h-m,t[6]=f+v,t[1]=h+m,t[4]=1-l-g,t[7]=d-p,t[2]=f-v,t[5]=d+p,t[8]=1-l-c,t}function Ut(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],l=e[7],h=e[8],c=e[9],f=e[10],d=e[11],g=e[12],p=e[13],v=e[14],m=e[15],_=n*s-r*a,y=n*u-i*a,b=n*l-o*a,x=r*u-i*s,w=r*l-o*s,T=i*l-o*u,E=h*p-c*g,M=h*v-f*g,S=h*m-d*g,L=c*v-f*p,A=c*m-d*p,R=f*m-d*v,P=_*R-y*A+b*L+x*S-w*M+T*E;return P?(P=1/P,t[0]=(s*R-u*A+l*L)*P,t[1]=(u*S-a*R-l*M)*P,t[2]=(a*A-s*S+l*E)*P,t[3]=(i*A-r*R-o*L)*P,t[4]=(n*R-i*S+o*M)*P,t[5]=(r*S-n*A-o*E)*P,t[6]=(p*T-v*w+m*x)*P,t[7]=(v*b-g*T-m*y)*P,t[8]=(g*w-p*b+m*_)*P,t):null}function zt(t,e,n){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/n,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t}function Bt(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"}function Ht(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8])}function Nt(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t}function Gt(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t}function jt(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t}function Wt(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t[6]=e[6]+n[6]*r,t[7]=e[7]+n[7]*r,t[8]=e[8]+n[8]*r,t}function Xt(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]}function Yt(t,e){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],l=t[7],h=t[8],c=e[0],f=e[1],g=e[2],p=e[3],v=e[4],m=e[5],_=e[6],y=e[7],b=e[8];return Math.abs(n-c)<=d*Math.max(1,Math.abs(n),Math.abs(c))&&Math.abs(r-f)<=d*Math.max(1,Math.abs(r),Math.abs(f))&&Math.abs(i-g)<=d*Math.max(1,Math.abs(i),Math.abs(g))&&Math.abs(o-p)<=d*Math.max(1,Math.abs(o),Math.abs(p))&&Math.abs(a-v)<=d*Math.max(1,Math.abs(a),Math.abs(v))&&Math.abs(s-m)<=d*Math.max(1,Math.abs(s),Math.abs(m))&&Math.abs(u-_)<=d*Math.max(1,Math.abs(u),Math.abs(_))&&Math.abs(l-y)<=d*Math.max(1,Math.abs(l),Math.abs(y))&&Math.abs(h-b)<=d*Math.max(1,Math.abs(h),Math.abs(b))}var qt=At,Vt=Gt;function Zt(){var t=new g(16);return g!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function Kt(t){var e=new g(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function Qt(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Jt(t,e,n,r,i,o,a,s,u,l,h,c,f,d,p,v){var m=new g(16);return m[0]=t,m[1]=e,m[2]=n,m[3]=r,m[4]=i,m[5]=o,m[6]=a,m[7]=s,m[8]=u,m[9]=l,m[10]=h,m[11]=c,m[12]=f,m[13]=d,m[14]=p,m[15]=v,m}function $t(t,e,n,r,i,o,a,s,u,l,h,c,f,d,g,p,v){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=o,t[5]=a,t[6]=s,t[7]=u,t[8]=l,t[9]=h,t[10]=c,t[11]=f,t[12]=d,t[13]=g,t[14]=p,t[15]=v,t}function te(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function ee(t,e){if(t===e){var n=e[1],r=e[2],i=e[3],o=e[6],a=e[7],s=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=o,t[11]=e[14],t[12]=i,t[13]=a,t[14]=s}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function ne(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],l=e[7],h=e[8],c=e[9],f=e[10],d=e[11],g=e[12],p=e[13],v=e[14],m=e[15],_=n*s-r*a,y=n*u-i*a,b=n*l-o*a,x=r*u-i*s,w=r*l-o*s,T=i*l-o*u,E=h*p-c*g,M=h*v-f*g,S=h*m-d*g,L=c*v-f*p,A=c*m-d*p,R=f*m-d*v,P=_*R-y*A+b*L+x*S-w*M+T*E;return P?(P=1/P,t[0]=(s*R-u*A+l*L)*P,t[1]=(i*A-r*R-o*L)*P,t[2]=(p*T-v*w+m*x)*P,t[3]=(f*w-c*T-d*x)*P,t[4]=(u*S-a*R-l*M)*P,t[5]=(n*R-i*S+o*M)*P,t[6]=(v*b-g*T-m*y)*P,t[7]=(h*T-f*b+d*y)*P,t[8]=(a*A-s*S+l*E)*P,t[9]=(r*S-n*A-o*E)*P,t[10]=(g*w-p*b+m*_)*P,t[11]=(c*b-h*w-d*_)*P,t[12]=(s*M-a*L-u*E)*P,t[13]=(n*L-r*M+i*E)*P,t[14]=(p*y-g*x-v*_)*P,t[15]=(h*x-c*y+f*_)*P,t):null}function re(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],l=e[7],h=e[8],c=e[9],f=e[10],d=e[11],g=e[12],p=e[13],v=e[14],m=e[15];return t[0]=s*(f*m-d*v)-c*(u*m-l*v)+p*(u*d-l*f),t[1]=-(r*(f*m-d*v)-c*(i*m-o*v)+p*(i*d-o*f)),t[2]=r*(u*m-l*v)-s*(i*m-o*v)+p*(i*l-o*u),t[3]=-(r*(u*d-l*f)-s*(i*d-o*f)+c*(i*l-o*u)),t[4]=-(a*(f*m-d*v)-h*(u*m-l*v)+g*(u*d-l*f)),t[5]=n*(f*m-d*v)-h*(i*m-o*v)+g*(i*d-o*f),t[6]=-(n*(u*m-l*v)-a*(i*m-o*v)+g*(i*l-o*u)),t[7]=n*(u*d-l*f)-a*(i*d-o*f)+h*(i*l-o*u),t[8]=a*(c*m-d*p)-h*(s*m-l*p)+g*(s*d-l*c),t[9]=-(n*(c*m-d*p)-h*(r*m-o*p)+g*(r*d-o*c)),t[10]=n*(s*m-l*p)-a*(r*m-o*p)+g*(r*l-o*s),t[11]=-(n*(s*d-l*c)-a*(r*d-o*c)+h*(r*l-o*s)),t[12]=-(a*(c*v-f*p)-h*(s*v-u*p)+g*(s*f-u*c)),t[13]=n*(c*v-f*p)-h*(r*v-i*p)+g*(r*f-i*c),t[14]=-(n*(s*v-u*p)-a*(r*v-i*p)+g*(r*u-i*s)),t[15]=n*(s*f-u*c)-a*(r*f-i*c)+h*(r*u-i*s),t}function ie(t){var e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],a=t[5],s=t[6],u=t[7],l=t[8],h=t[9],c=t[10],f=t[11],d=t[12],g=t[13],p=t[14],v=t[15];return(e*a-n*o)*(c*v-f*p)-(e*s-r*o)*(h*v-f*g)+(e*u-i*o)*(h*p-c*g)+(n*s-r*a)*(l*v-f*d)-(n*u-i*a)*(l*p-c*d)+(r*u-i*s)*(l*g-h*d)}function oe(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],l=e[6],h=e[7],c=e[8],f=e[9],d=e[10],g=e[11],p=e[12],v=e[13],m=e[14],_=e[15],y=n[0],b=n[1],x=n[2],w=n[3];return t[0]=y*r+b*s+x*c+w*p,t[1]=y*i+b*u+x*f+w*v,t[2]=y*o+b*l+x*d+w*m,t[3]=y*a+b*h+x*g+w*_,y=n[4],b=n[5],x=n[6],w=n[7],t[4]=y*r+b*s+x*c+w*p,t[5]=y*i+b*u+x*f+w*v,t[6]=y*o+b*l+x*d+w*m,t[7]=y*a+b*h+x*g+w*_,y=n[8],b=n[9],x=n[10],w=n[11],t[8]=y*r+b*s+x*c+w*p,t[9]=y*i+b*u+x*f+w*v,t[10]=y*o+b*l+x*d+w*m,t[11]=y*a+b*h+x*g+w*_,y=n[12],b=n[13],x=n[14],w=n[15],t[12]=y*r+b*s+x*c+w*p,t[13]=y*i+b*u+x*f+w*v,t[14]=y*o+b*l+x*d+w*m,t[15]=y*a+b*h+x*g+w*_,t}function ae(t,e,n){var r,i,o,a,s,u,l,h,c,f,d,g,p=n[0],v=n[1],m=n[2];return e===t?(t[12]=e[0]*p+e[4]*v+e[8]*m+e[12],t[13]=e[1]*p+e[5]*v+e[9]*m+e[13],t[14]=e[2]*p+e[6]*v+e[10]*m+e[14],t[15]=e[3]*p+e[7]*v+e[11]*m+e[15]):(r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],l=e[6],h=e[7],c=e[8],f=e[9],d=e[10],g=e[11],t[0]=r,t[1]=i,t[2]=o,t[3]=a,t[4]=s,t[5]=u,t[6]=l,t[7]=h,t[8]=c,t[9]=f,t[10]=d,t[11]=g,t[12]=r*p+s*v+c*m+e[12],t[13]=i*p+u*v+f*m+e[13],t[14]=o*p+l*v+d*m+e[14],t[15]=a*p+h*v+g*m+e[15]),t}function se(t,e,n){var r=n[0],i=n[1],o=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function ue(t,e,n,r){var i,o,a,s,u,l,h,c,f,g,p,v,m,_,y,b,x,w,T,E,M,S,L,A,R=r[0],P=r[1],C=r[2],I=Math.hypot(R,P,C);return I<d?null:(R*=I=1/I,P*=I,C*=I,i=Math.sin(n),a=1-(o=Math.cos(n)),s=e[0],u=e[1],l=e[2],h=e[3],c=e[4],f=e[5],g=e[6],p=e[7],v=e[8],m=e[9],_=e[10],y=e[11],b=R*R*a+o,x=P*R*a+C*i,w=C*R*a-P*i,T=R*P*a-C*i,E=P*P*a+o,M=C*P*a+R*i,S=R*C*a+P*i,L=P*C*a-R*i,A=C*C*a+o,t[0]=s*b+c*x+v*w,t[1]=u*b+f*x+m*w,t[2]=l*b+g*x+_*w,t[3]=h*b+p*x+y*w,t[4]=s*T+c*E+v*M,t[5]=u*T+f*E+m*M,t[6]=l*T+g*E+_*M,t[7]=h*T+p*E+y*M,t[8]=s*S+c*L+v*A,t[9]=u*S+f*L+m*A,t[10]=l*S+g*L+_*A,t[11]=h*S+p*L+y*A,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function le(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[4],a=e[5],s=e[6],u=e[7],l=e[8],h=e[9],c=e[10],f=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*i+l*r,t[5]=a*i+h*r,t[6]=s*i+c*r,t[7]=u*i+f*r,t[8]=l*i-o*r,t[9]=h*i-a*r,t[10]=c*i-s*r,t[11]=f*i-u*r,t}function he(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[0],a=e[1],s=e[2],u=e[3],l=e[8],h=e[9],c=e[10],f=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i-l*r,t[1]=a*i-h*r,t[2]=s*i-c*r,t[3]=u*i-f*r,t[8]=o*r+l*i,t[9]=a*r+h*i,t[10]=s*r+c*i,t[11]=u*r+f*i,t}function ce(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[0],a=e[1],s=e[2],u=e[3],l=e[4],h=e[5],c=e[6],f=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i+l*r,t[1]=a*i+h*r,t[2]=s*i+c*r,t[3]=u*i+f*r,t[4]=l*i-o*r,t[5]=h*i-a*r,t[6]=c*i-s*r,t[7]=f*i-u*r,t}function fe(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function de(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function ge(t,e,n){var r,i,o,a=n[0],s=n[1],u=n[2],l=Math.hypot(a,s,u);return l<d?null:(a*=l=1/l,s*=l,u*=l,r=Math.sin(e),o=1-(i=Math.cos(e)),t[0]=a*a*o+i,t[1]=s*a*o+u*r,t[2]=u*a*o-s*r,t[3]=0,t[4]=a*s*o-u*r,t[5]=s*s*o+i,t[6]=u*s*o+a*r,t[7]=0,t[8]=a*u*o+s*r,t[9]=s*u*o-a*r,t[10]=u*u*o+i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function pe(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r,t[6]=n,t[7]=0,t[8]=0,t[9]=-n,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function ve(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=0,t[2]=-n,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=n,t[9]=0,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function me(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=0,t[4]=-n,t[5]=r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function _e(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=r+r,u=i+i,l=o+o,h=r*s,c=r*u,f=r*l,d=i*u,g=i*l,p=o*l,v=a*s,m=a*u,_=a*l;return t[0]=1-(d+p),t[1]=c+_,t[2]=f-m,t[3]=0,t[4]=c-_,t[5]=1-(h+p),t[6]=g+v,t[7]=0,t[8]=f+m,t[9]=g-v,t[10]=1-(h+d),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function ye(t,e){var n=new g(3),r=-e[0],i=-e[1],o=-e[2],a=e[3],s=e[4],u=e[5],l=e[6],h=e[7],c=r*r+i*i+o*o+a*a;return c>0?(n[0]=2*(s*a+h*r+u*o-l*i)/c,n[1]=2*(u*a+h*i+l*r-s*o)/c,n[2]=2*(l*a+h*o+s*i-u*r)/c):(n[0]=2*(s*a+h*r+u*o-l*i),n[1]=2*(u*a+h*i+l*r-s*o),n[2]=2*(l*a+h*o+s*i-u*r)),_e(t,e,n),t}function be(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function xe(t,e){var n=e[0],r=e[1],i=e[2],o=e[4],a=e[5],s=e[6],u=e[8],l=e[9],h=e[10];return t[0]=Math.hypot(n,r,i),t[1]=Math.hypot(o,a,s),t[2]=Math.hypot(u,l,h),t}function we(t,e){var n=new g(3);xe(n,e);var r=1/n[0],i=1/n[1],o=1/n[2],a=e[0]*r,s=e[1]*i,u=e[2]*o,l=e[4]*r,h=e[5]*i,c=e[6]*o,f=e[8]*r,d=e[9]*i,p=e[10]*o,v=a+h+p,m=0;return v>0?(m=2*Math.sqrt(v+1),t[3]=.25*m,t[0]=(c-d)/m,t[1]=(f-u)/m,t[2]=(s-l)/m):a>h&&a>p?(m=2*Math.sqrt(1+a-h-p),t[3]=(c-d)/m,t[0]=.25*m,t[1]=(s+l)/m,t[2]=(f+u)/m):h>p?(m=2*Math.sqrt(1+h-a-p),t[3]=(f-u)/m,t[0]=(s+l)/m,t[1]=.25*m,t[2]=(c+d)/m):(m=2*Math.sqrt(1+p-a-h),t[3]=(s-l)/m,t[0]=(f+u)/m,t[1]=(c+d)/m,t[2]=.25*m),t}function Te(t,e,n,r){var i=e[0],o=e[1],a=e[2],s=e[3],u=i+i,l=o+o,h=a+a,c=i*u,f=i*l,d=i*h,g=o*l,p=o*h,v=a*h,m=s*u,_=s*l,y=s*h,b=r[0],x=r[1],w=r[2];return t[0]=(1-(g+v))*b,t[1]=(f+y)*b,t[2]=(d-_)*b,t[3]=0,t[4]=(f-y)*x,t[5]=(1-(c+v))*x,t[6]=(p+m)*x,t[7]=0,t[8]=(d+_)*w,t[9]=(p-m)*w,t[10]=(1-(c+g))*w,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function Ee(t,e,n,r,i){var o=e[0],a=e[1],s=e[2],u=e[3],l=o+o,h=a+a,c=s+s,f=o*l,d=o*h,g=o*c,p=a*h,v=a*c,m=s*c,_=u*l,y=u*h,b=u*c,x=r[0],w=r[1],T=r[2],E=i[0],M=i[1],S=i[2],L=(1-(p+m))*x,A=(d+b)*x,R=(g-y)*x,P=(d-b)*w,C=(1-(f+m))*w,I=(v+_)*w,F=(g+y)*T,k=(v-_)*T,D=(1-(f+p))*T;return t[0]=L,t[1]=A,t[2]=R,t[3]=0,t[4]=P,t[5]=C,t[6]=I,t[7]=0,t[8]=F,t[9]=k,t[10]=D,t[11]=0,t[12]=n[0]+E-(L*E+P*M+F*S),t[13]=n[1]+M-(A*E+C*M+k*S),t[14]=n[2]+S-(R*E+I*M+D*S),t[15]=1,t}function Me(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=n+n,s=r+r,u=i+i,l=n*a,h=r*a,c=r*s,f=i*a,d=i*s,g=i*u,p=o*a,v=o*s,m=o*u;return t[0]=1-c-g,t[1]=h+m,t[2]=f-v,t[3]=0,t[4]=h-m,t[5]=1-l-g,t[6]=d+p,t[7]=0,t[8]=f+v,t[9]=d-p,t[10]=1-l-c,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Se(t,e,n,r,i,o,a){var s=1/(n-e),u=1/(i-r),l=1/(o-a);return t[0]=2*o*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*u,t[6]=0,t[7]=0,t[8]=(n+e)*s,t[9]=(i+r)*u,t[10]=(a+o)*l,t[11]=-1,t[12]=0,t[13]=0,t[14]=a*o*2*l,t[15]=0,t}function Le(t,e,n,r,i){var o,a=1/Math.tan(e/2);return t[0]=a/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=i&&i!==1/0?(o=1/(r-i),t[10]=(i+r)*o,t[14]=2*i*r*o):(t[10]=-1,t[14]=-2*r),t}function Ae(t,e,n,r){var i=Math.tan(e.upDegrees*Math.PI/180),o=Math.tan(e.downDegrees*Math.PI/180),a=Math.tan(e.leftDegrees*Math.PI/180),s=Math.tan(e.rightDegrees*Math.PI/180),u=2/(a+s),l=2/(i+o);return t[0]=u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=l,t[6]=0,t[7]=0,t[8]=-(a-s)*u*.5,t[9]=(i-o)*l*.5,t[10]=r/(n-r),t[11]=-1,t[12]=0,t[13]=0,t[14]=r*n/(n-r),t[15]=0,t}function Re(t,e,n,r,i,o,a){var s=1/(e-n),u=1/(r-i),l=1/(o-a);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*l,t[11]=0,t[12]=(e+n)*s,t[13]=(i+r)*u,t[14]=(a+o)*l,t[15]=1,t}function Pe(t,e,n,r){var i,o,a,s,u,l,h,c,f,g,p=e[0],v=e[1],m=e[2],_=r[0],y=r[1],b=r[2],x=n[0],w=n[1],T=n[2];return Math.abs(p-x)<d&&Math.abs(v-w)<d&&Math.abs(m-T)<d?te(t):(h=p-x,c=v-w,f=m-T,i=y*(f*=g=1/Math.hypot(h,c,f))-b*(c*=g),o=b*(h*=g)-_*f,a=_*c-y*h,(g=Math.hypot(i,o,a))?(i*=g=1/g,o*=g,a*=g):(i=0,o=0,a=0),s=c*a-f*o,u=f*i-h*a,l=h*o-c*i,(g=Math.hypot(s,u,l))?(s*=g=1/g,u*=g,l*=g):(s=0,u=0,l=0),t[0]=i,t[1]=s,t[2]=h,t[3]=0,t[4]=o,t[5]=u,t[6]=c,t[7]=0,t[8]=a,t[9]=l,t[10]=f,t[11]=0,t[12]=-(i*p+o*v+a*m),t[13]=-(s*p+u*v+l*m),t[14]=-(h*p+c*v+f*m),t[15]=1,t)}function Ce(t,e,n,r){var i=e[0],o=e[1],a=e[2],s=r[0],u=r[1],l=r[2],h=i-n[0],c=o-n[1],f=a-n[2],d=h*h+c*c+f*f;d>0&&(h*=d=1/Math.sqrt(d),c*=d,f*=d);var g=u*f-l*c,p=l*h-s*f,v=s*c-u*h;return(d=g*g+p*p+v*v)>0&&(g*=d=1/Math.sqrt(d),p*=d,v*=d),t[0]=g,t[1]=p,t[2]=v,t[3]=0,t[4]=c*v-f*p,t[5]=f*g-h*v,t[6]=h*p-c*g,t[7]=0,t[8]=h,t[9]=c,t[10]=f,t[11]=0,t[12]=i,t[13]=o,t[14]=a,t[15]=1,t}function Ie(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function Fe(t){return Math.hypot(t[0],t[1],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])}function ke(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t[9]=e[9]+n[9],t[10]=e[10]+n[10],t[11]=e[11]+n[11],t[12]=e[12]+n[12],t[13]=e[13]+n[13],t[14]=e[14]+n[14],t[15]=e[15]+n[15],t}function De(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t[9]=e[9]-n[9],t[10]=e[10]-n[10],t[11]=e[11]-n[11],t[12]=e[12]-n[12],t[13]=e[13]-n[13],t[14]=e[14]-n[14],t[15]=e[15]-n[15],t}function Oe(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12]*n,t[13]=e[13]*n,t[14]=e[14]*n,t[15]=e[15]*n,t}function Ue(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t[6]=e[6]+n[6]*r,t[7]=e[7]+n[7]*r,t[8]=e[8]+n[8]*r,t[9]=e[9]+n[9]*r,t[10]=e[10]+n[10]*r,t[11]=e[11]+n[11]*r,t[12]=e[12]+n[12]*r,t[13]=e[13]+n[13]*r,t[14]=e[14]+n[14]*r,t[15]=e[15]+n[15]*r,t}function ze(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}function Be(t,e){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],l=t[7],h=t[8],c=t[9],f=t[10],g=t[11],p=t[12],v=t[13],m=t[14],_=t[15],y=e[0],b=e[1],x=e[2],w=e[3],T=e[4],E=e[5],M=e[6],S=e[7],L=e[8],A=e[9],R=e[10],P=e[11],C=e[12],I=e[13],F=e[14],k=e[15];return Math.abs(n-y)<=d*Math.max(1,Math.abs(n),Math.abs(y))&&Math.abs(r-b)<=d*Math.max(1,Math.abs(r),Math.abs(b))&&Math.abs(i-x)<=d*Math.max(1,Math.abs(i),Math.abs(x))&&Math.abs(o-w)<=d*Math.max(1,Math.abs(o),Math.abs(w))&&Math.abs(a-T)<=d*Math.max(1,Math.abs(a),Math.abs(T))&&Math.abs(s-E)<=d*Math.max(1,Math.abs(s),Math.abs(E))&&Math.abs(u-M)<=d*Math.max(1,Math.abs(u),Math.abs(M))&&Math.abs(l-S)<=d*Math.max(1,Math.abs(l),Math.abs(S))&&Math.abs(h-L)<=d*Math.max(1,Math.abs(h),Math.abs(L))&&Math.abs(c-A)<=d*Math.max(1,Math.abs(c),Math.abs(A))&&Math.abs(f-R)<=d*Math.max(1,Math.abs(f),Math.abs(R))&&Math.abs(g-P)<=d*Math.max(1,Math.abs(g),Math.abs(P))&&Math.abs(p-C)<=d*Math.max(1,Math.abs(p),Math.abs(C))&&Math.abs(v-I)<=d*Math.max(1,Math.abs(v),Math.abs(I))&&Math.abs(m-F)<=d*Math.max(1,Math.abs(m),Math.abs(F))&&Math.abs(_-k)<=d*Math.max(1,Math.abs(_),Math.abs(k))}var He=oe,Ne=De;function Ge(){var t=new g(3);return g!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function je(t){var e=new g(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function We(t){var e=t[0],n=t[1],r=t[2];return Math.hypot(e,n,r)}function Xe(t,e,n){var r=new g(3);return r[0]=t,r[1]=e,r[2]=n,r}function Ye(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function qe(t,e,n,r){return t[0]=e,t[1]=n,t[2]=r,t}function Ve(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t}function Ze(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function Ke(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t}function Qe(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t}function Je(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t}function $e(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t}function tn(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t}function en(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t}function nn(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t}function rn(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t}function on(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t}function an(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return Math.hypot(n,r,i)}function sn(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return n*n+r*r+i*i}function un(t){var e=t[0],n=t[1],r=t[2];return e*e+n*n+r*r}function ln(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function hn(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}function cn(t,e){var n=e[0],r=e[1],i=e[2],o=n*n+r*r+i*i;return o>0&&(o=1/Math.sqrt(o)),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o,t}function fn(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function dn(t,e,n){var r=e[0],i=e[1],o=e[2],a=n[0],s=n[1],u=n[2];return t[0]=i*u-o*s,t[1]=o*a-r*u,t[2]=r*s-i*a,t}function gn(t,e,n,r){var i=e[0],o=e[1],a=e[2];return t[0]=i+r*(n[0]-i),t[1]=o+r*(n[1]-o),t[2]=a+r*(n[2]-a),t}function pn(t,e,n,r,i,o){var a=o*o,s=a*(2*o-3)+1,u=a*(o-2)+o,l=a*(o-1),h=a*(3-2*o);return t[0]=e[0]*s+n[0]*u+r[0]*l+i[0]*h,t[1]=e[1]*s+n[1]*u+r[1]*l+i[1]*h,t[2]=e[2]*s+n[2]*u+r[2]*l+i[2]*h,t}function vn(t,e,n,r,i,o){var a=1-o,s=a*a,u=o*o,l=s*a,h=3*o*s,c=3*u*a,f=u*o;return t[0]=e[0]*l+n[0]*h+r[0]*c+i[0]*f,t[1]=e[1]*l+n[1]*h+r[1]*c+i[1]*f,t[2]=e[2]*l+n[2]*h+r[2]*c+i[2]*f,t}function mn(t,e){e=e||1;var n=2*p()*Math.PI,r=2*p()-1,i=Math.sqrt(1-r*r)*e;return t[0]=Math.cos(n)*i,t[1]=Math.sin(n)*i,t[2]=r*e,t}function _n(t,e,n){var r=e[0],i=e[1],o=e[2],a=n[3]*r+n[7]*i+n[11]*o+n[15];return a=a||1,t[0]=(n[0]*r+n[4]*i+n[8]*o+n[12])/a,t[1]=(n[1]*r+n[5]*i+n[9]*o+n[13])/a,t[2]=(n[2]*r+n[6]*i+n[10]*o+n[14])/a,t}function yn(t,e,n){var r=e[0],i=e[1],o=e[2];return t[0]=r*n[0]+i*n[3]+o*n[6],t[1]=r*n[1]+i*n[4]+o*n[7],t[2]=r*n[2]+i*n[5]+o*n[8],t}function bn(t,e,n){var r=n[0],i=n[1],o=n[2],a=n[3],s=e[0],u=e[1],l=e[2],h=i*l-o*u,c=o*s-r*l,f=r*u-i*s,d=i*f-o*c,g=o*h-r*f,p=r*c-i*h,v=2*a;return h*=v,c*=v,f*=v,d*=2,g*=2,p*=2,t[0]=s+h+d,t[1]=u+c+g,t[2]=l+f+p,t}function xn(t,e,n,r){var i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[0],o[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),o[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function wn(t,e,n,r){var i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),o[1]=i[1],o[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function Tn(t,e,n,r){var i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),o[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),o[2]=i[2],t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function En(t,e){var n=Xe(t[0],t[1],t[2]),r=Xe(e[0],e[1],e[2]);cn(n,n),cn(r,r);var i=fn(n,r);return i>1?0:i<-1?Math.PI:Math.acos(i)}function Mn(t){return t[0]=0,t[1]=0,t[2]=0,t}function Sn(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"}function Ln(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function An(t,e){var n=t[0],r=t[1],i=t[2],o=e[0],a=e[1],s=e[2];return Math.abs(n-o)<=d*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(r-a)<=d*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(i-s)<=d*Math.max(1,Math.abs(i),Math.abs(s))}var Rn,Pn=Ze,Cn=Ke,In=Qe,Fn=an,kn=sn,Dn=We,On=un,Un=(Rn=Ge(),function(t,e,n,r,i,o){var a,s;for(e||(e=3),n||(n=0),s=r?Math.min(r*e+n,t.length):t.length,a=n;a<s;a+=e)Rn[0]=t[a],Rn[1]=t[a+1],Rn[2]=t[a+2],i(Rn,Rn,o),t[a]=Rn[0],t[a+1]=Rn[1],t[a+2]=Rn[2];return t});function zn(){var t=new g(4);return g!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function Bn(t){var e=new g(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function Hn(t,e,n,r){var i=new g(4);return i[0]=t,i[1]=e,i[2]=n,i[3]=r,i}function Nn(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function Gn(t,e,n,r,i){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t}function jn(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t}function Wn(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t}function Xn(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t[3]=e[3]*n[3],t}function Yn(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t[3]=e[3]/n[3],t}function qn(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t}function Vn(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t}function Zn(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t[3]=Math.min(e[3],n[3]),t}function Kn(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t[3]=Math.max(e[3],n[3]),t}function Qn(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t}function Jn(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function $n(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t}function tr(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2],o=e[3]-t[3];return Math.hypot(n,r,i,o)}function er(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2],o=e[3]-t[3];return n*n+r*r+i*i+o*o}function nr(t){var e=t[0],n=t[1],r=t[2],i=t[3];return Math.hypot(e,n,r,i)}function rr(t){var e=t[0],n=t[1],r=t[2],i=t[3];return e*e+n*n+r*r+i*i}function ir(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t}function or(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t}function ar(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=n*n+r*r+i*i+o*o;return a>0&&(a=1/Math.sqrt(a)),t[0]=n*a,t[1]=r*a,t[2]=i*a,t[3]=o*a,t}function sr(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function ur(t,e,n,r){var i=n[0]*r[1]-n[1]*r[0],o=n[0]*r[2]-n[2]*r[0],a=n[0]*r[3]-n[3]*r[0],s=n[1]*r[2]-n[2]*r[1],u=n[1]*r[3]-n[3]*r[1],l=n[2]*r[3]-n[3]*r[2],h=e[0],c=e[1],f=e[2],d=e[3];return t[0]=c*l-f*u+d*s,t[1]=-h*l+f*a-d*o,t[2]=h*u-c*a+d*i,t[3]=-h*s+c*o-f*i,t}function lr(t,e,n,r){var i=e[0],o=e[1],a=e[2],s=e[3];return t[0]=i+r*(n[0]-i),t[1]=o+r*(n[1]-o),t[2]=a+r*(n[2]-a),t[3]=s+r*(n[3]-s),t}function hr(t,e){var n,r,i,o,a,s;e=e||1;do{a=(n=2*p()-1)*n+(r=2*p()-1)*r}while(a>=1);do{s=(i=2*p()-1)*i+(o=2*p()-1)*o}while(s>=1);var u=Math.sqrt((1-a)/s);return t[0]=e*n,t[1]=e*r,t[2]=e*i*u,t[3]=e*o*u,t}function cr(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*o+n[12]*a,t[1]=n[1]*r+n[5]*i+n[9]*o+n[13]*a,t[2]=n[2]*r+n[6]*i+n[10]*o+n[14]*a,t[3]=n[3]*r+n[7]*i+n[11]*o+n[15]*a,t}function fr(t,e,n){var r=e[0],i=e[1],o=e[2],a=n[0],s=n[1],u=n[2],l=n[3],h=l*r+s*o-u*i,c=l*i+u*r-a*o,f=l*o+a*i-s*r,d=-a*r-s*i-u*o;return t[0]=h*l+d*-a+c*-u-f*-s,t[1]=c*l+d*-s+f*-a-h*-u,t[2]=f*l+d*-u+h*-s-c*-a,t[3]=e[3],t}function dr(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t}function gr(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function pr(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function vr(t,e){var n=t[0],r=t[1],i=t[2],o=t[3],a=e[0],s=e[1],u=e[2],l=e[3];return Math.abs(n-a)<=d*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(r-s)<=d*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(i-u)<=d*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(o-l)<=d*Math.max(1,Math.abs(o),Math.abs(l))}var mr=Wn,_r=Xn,yr=Yn,br=tr,xr=er,wr=nr,Tr=rr,Er=function(){var t=zn();return function(e,n,r,i,o,a){var s,u;for(n||(n=4),r||(r=0),u=i?Math.min(i*n+r,e.length):e.length,s=r;s<u;s+=n)t[0]=e[s],t[1]=e[s+1],t[2]=e[s+2],t[3]=e[s+3],o(t,t,a),e[s]=t[0],e[s+1]=t[1],e[s+2]=t[2],e[s+3]=t[3];return e}}();function Mr(){var t=new g(4);return g!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function Sr(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function Lr(t,e,n){n*=.5;var r=Math.sin(n);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(n),t}function Ar(t,e){var n=2*Math.acos(e[3]),r=Math.sin(n/2);return r>d?(t[0]=e[0]/r,t[1]=e[1]/r,t[2]=e[2]/r):(t[0]=1,t[1]=0,t[2]=0),n}function Rr(t,e){var n=ii(t,e);return Math.acos(2*n*n-1)}function Pr(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=n[0],u=n[1],l=n[2],h=n[3];return t[0]=r*h+a*s+i*l-o*u,t[1]=i*h+a*u+o*s-r*l,t[2]=o*h+a*l+r*u-i*s,t[3]=a*h-r*s-i*u-o*l,t}function Cr(t,e,n){n*=.5;var r=e[0],i=e[1],o=e[2],a=e[3],s=Math.sin(n),u=Math.cos(n);return t[0]=r*u+a*s,t[1]=i*u+o*s,t[2]=o*u-i*s,t[3]=a*u-r*s,t}function Ir(t,e,n){n*=.5;var r=e[0],i=e[1],o=e[2],a=e[3],s=Math.sin(n),u=Math.cos(n);return t[0]=r*u-o*s,t[1]=i*u+a*s,t[2]=o*u+r*s,t[3]=a*u-i*s,t}function Fr(t,e,n){n*=.5;var r=e[0],i=e[1],o=e[2],a=e[3],s=Math.sin(n),u=Math.cos(n);return t[0]=r*u+i*s,t[1]=i*u-r*s,t[2]=o*u+a*s,t[3]=a*u-o*s,t}function kr(t,e){var n=e[0],r=e[1],i=e[2];return t[0]=n,t[1]=r,t[2]=i,t[3]=Math.sqrt(Math.abs(1-n*n-r*r-i*i)),t}function Dr(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=Math.sqrt(n*n+r*r+i*i),s=Math.exp(o),u=a>0?s*Math.sin(a)/a:0;return t[0]=n*u,t[1]=r*u,t[2]=i*u,t[3]=s*Math.cos(a),t}function Or(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=Math.sqrt(n*n+r*r+i*i),s=a>0?Math.atan2(a,o)/a:0;return t[0]=n*s,t[1]=r*s,t[2]=i*s,t[3]=.5*Math.log(n*n+r*r+i*i+o*o),t}function Ur(t,e,n){return Or(t,e),ri(t,t,n),Dr(t,t),t}function zr(t,e,n,r){var i,o,a,s,u,l=e[0],h=e[1],c=e[2],f=e[3],g=n[0],p=n[1],v=n[2],m=n[3];return(o=l*g+h*p+c*v+f*m)<0&&(o=-o,g=-g,p=-p,v=-v,m=-m),1-o>d?(i=Math.acos(o),a=Math.sin(i),s=Math.sin((1-r)*i)/a,u=Math.sin(r*i)/a):(s=1-r,u=r),t[0]=s*l+u*g,t[1]=s*h+u*p,t[2]=s*c+u*v,t[3]=s*f+u*m,t}function Br(t){var e=p(),n=p(),r=p(),i=Math.sqrt(1-e),o=Math.sqrt(e);return t[0]=i*Math.sin(2*Math.PI*n),t[1]=i*Math.cos(2*Math.PI*n),t[2]=o*Math.sin(2*Math.PI*r),t[3]=o*Math.cos(2*Math.PI*r),t}function Hr(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=n*n+r*r+i*i+o*o,s=a?1/a:0;return t[0]=-n*s,t[1]=-r*s,t[2]=-i*s,t[3]=o*s,t}function Nr(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function Gr(t,e){var n,r=e[0]+e[4]+e[8];if(r>0)n=Math.sqrt(r+1),t[3]=.5*n,n=.5/n,t[0]=(e[5]-e[7])*n,t[1]=(e[6]-e[2])*n,t[2]=(e[1]-e[3])*n;else{var i=0;e[4]>e[0]&&(i=1),e[8]>e[3*i+i]&&(i=2);var o=(i+1)%3,a=(i+2)%3;n=Math.sqrt(e[3*i+i]-e[3*o+o]-e[3*a+a]+1),t[i]=.5*n,n=.5/n,t[3]=(e[3*o+a]-e[3*a+o])*n,t[o]=(e[3*o+i]+e[3*i+o])*n,t[a]=(e[3*a+i]+e[3*i+a])*n}return t}function jr(t,e,n,r){var i=.5*Math.PI/180;e*=i,n*=i,r*=i;var o=Math.sin(e),a=Math.cos(e),s=Math.sin(n),u=Math.cos(n),l=Math.sin(r),h=Math.cos(r);return t[0]=o*u*h-a*s*l,t[1]=a*s*h+o*u*l,t[2]=a*u*l-o*s*h,t[3]=a*u*h+o*s*l,t}function Wr(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}var Xr,Yr,qr,Vr,Zr,Kr,Qr=Bn,Jr=Hn,$r=Nn,ti=Gn,ei=jn,ni=Pr,ri=Jn,ii=sr,oi=lr,ai=nr,si=ai,ui=rr,li=ui,hi=ar,ci=pr,fi=vr,di=(Xr=Ge(),Yr=Xe(1,0,0),qr=Xe(0,1,0),function(t,e,n){var r=fn(e,n);return r<-.999999?(dn(Xr,Yr,e),Dn(Xr)<1e-6&&dn(Xr,qr,e),cn(Xr,Xr),Lr(t,Xr,Math.PI),t):r>.999999?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):(dn(Xr,e,n),t[0]=Xr[0],t[1]=Xr[1],t[2]=Xr[2],t[3]=1+r,hi(t,t))}),gi=(Vr=Mr(),Zr=Mr(),function(t,e,n,r,i,o){return zr(Vr,e,i,o),zr(Zr,n,r,o),zr(t,Vr,Zr,2*o*(1-o)),t}),pi=(Kr=mt(),function(t,e,n,r){return Kr[0]=n[0],Kr[3]=n[1],Kr[6]=n[2],Kr[1]=r[0],Kr[4]=r[1],Kr[7]=r[2],Kr[2]=-e[0],Kr[5]=-e[1],Kr[8]=-e[2],hi(t,Gr(t,Kr))});function vi(){var t=new g(8);return g!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[4]=0,t[5]=0,t[6]=0,t[7]=0),t[3]=1,t}function mi(t){var e=new g(8);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e}function _i(t,e,n,r,i,o,a,s){var u=new g(8);return u[0]=t,u[1]=e,u[2]=n,u[3]=r,u[4]=i,u[5]=o,u[6]=a,u[7]=s,u}function yi(t,e,n,r,i,o,a){var s=new g(8);s[0]=t,s[1]=e,s[2]=n,s[3]=r;var u=.5*i,l=.5*o,h=.5*a;return s[4]=u*r+l*n-h*e,s[5]=l*r+h*t-u*n,s[6]=h*r+u*e-l*t,s[7]=-u*t-l*e-h*n,s}function bi(t,e,n){var r=.5*n[0],i=.5*n[1],o=.5*n[2],a=e[0],s=e[1],u=e[2],l=e[3];return t[0]=a,t[1]=s,t[2]=u,t[3]=l,t[4]=r*l+i*u-o*s,t[5]=i*l+o*a-r*u,t[6]=o*l+r*s-i*a,t[7]=-r*a-i*s-o*u,t}function xi(t,e){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=.5*e[0],t[5]=.5*e[1],t[6]=.5*e[2],t[7]=0,t}function wi(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=0,t[5]=0,t[6]=0,t[7]=0,t}function Ti(t,e){var n=Mr();we(n,e);var r=new g(3);return be(r,e),bi(t,n,r),t}function Ei(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t}function Mi(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t[6]=0,t[7]=0,t}function Si(t,e,n,r,i,o,a,s,u){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=o,t[5]=a,t[6]=s,t[7]=u,t}var Li=$r;function Ai(t,e){return t[0]=e[4],t[1]=e[5],t[2]=e[6],t[3]=e[7],t}var Ri=$r;function Pi(t,e){return t[4]=e[0],t[5]=e[1],t[6]=e[2],t[7]=e[3],t}function Ci(t,e){var n=e[4],r=e[5],i=e[6],o=e[7],a=-e[0],s=-e[1],u=-e[2],l=e[3];return t[0]=2*(n*l+o*a+r*u-i*s),t[1]=2*(r*l+o*s+i*a-n*u),t[2]=2*(i*l+o*u+n*s-r*a),t}function Ii(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=.5*n[0],u=.5*n[1],l=.5*n[2],h=e[4],c=e[5],f=e[6],d=e[7];return t[0]=r,t[1]=i,t[2]=o,t[3]=a,t[4]=a*s+i*l-o*u+h,t[5]=a*u+o*s-r*l+c,t[6]=a*l+r*u-i*s+f,t[7]=-r*s-i*u-o*l+d,t}function Fi(t,e,n){var r=-e[0],i=-e[1],o=-e[2],a=e[3],s=e[4],u=e[5],l=e[6],h=e[7],c=s*a+h*r+u*o-l*i,f=u*a+h*i+l*r-s*o,d=l*a+h*o+s*i-u*r,g=h*a-s*r-u*i-l*o;return Cr(t,e,n),r=t[0],i=t[1],o=t[2],a=t[3],t[4]=c*a+g*r+f*o-d*i,t[5]=f*a+g*i+d*r-c*o,t[6]=d*a+g*o+c*i-f*r,t[7]=g*a-c*r-f*i-d*o,t}function ki(t,e,n){var r=-e[0],i=-e[1],o=-e[2],a=e[3],s=e[4],u=e[5],l=e[6],h=e[7],c=s*a+h*r+u*o-l*i,f=u*a+h*i+l*r-s*o,d=l*a+h*o+s*i-u*r,g=h*a-s*r-u*i-l*o;return Ir(t,e,n),r=t[0],i=t[1],o=t[2],a=t[3],t[4]=c*a+g*r+f*o-d*i,t[5]=f*a+g*i+d*r-c*o,t[6]=d*a+g*o+c*i-f*r,t[7]=g*a-c*r-f*i-d*o,t}function Di(t,e,n){var r=-e[0],i=-e[1],o=-e[2],a=e[3],s=e[4],u=e[5],l=e[6],h=e[7],c=s*a+h*r+u*o-l*i,f=u*a+h*i+l*r-s*o,d=l*a+h*o+s*i-u*r,g=h*a-s*r-u*i-l*o;return Fr(t,e,n),r=t[0],i=t[1],o=t[2],a=t[3],t[4]=c*a+g*r+f*o-d*i,t[5]=f*a+g*i+d*r-c*o,t[6]=d*a+g*o+c*i-f*r,t[7]=g*a-c*r-f*i-d*o,t}function Oi(t,e,n){var r=n[0],i=n[1],o=n[2],a=n[3],s=e[0],u=e[1],l=e[2],h=e[3];return t[0]=s*a+h*r+u*o-l*i,t[1]=u*a+h*i+l*r-s*o,t[2]=l*a+h*o+s*i-u*r,t[3]=h*a-s*r-u*i-l*o,s=e[4],u=e[5],l=e[6],h=e[7],t[4]=s*a+h*r+u*o-l*i,t[5]=u*a+h*i+l*r-s*o,t[6]=l*a+h*o+s*i-u*r,t[7]=h*a-s*r-u*i-l*o,t}function Ui(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=n[0],u=n[1],l=n[2],h=n[3];return t[0]=r*h+a*s+i*l-o*u,t[1]=i*h+a*u+o*s-r*l,t[2]=o*h+a*l+r*u-i*s,t[3]=a*h-r*s-i*u-o*l,s=n[4],u=n[5],l=n[6],h=n[7],t[4]=r*h+a*s+i*l-o*u,t[5]=i*h+a*u+o*s-r*l,t[6]=o*h+a*l+r*u-i*s,t[7]=a*h-r*s-i*u-o*l,t}function zi(t,e,n,r){if(Math.abs(r)<d)return Ei(t,e);var i=Math.hypot(n[0],n[1],n[2]);r*=.5;var o=Math.sin(r),a=o*n[0]/i,s=o*n[1]/i,u=o*n[2]/i,l=Math.cos(r),h=e[0],c=e[1],f=e[2],g=e[3];t[0]=h*l+g*a+c*u-f*s,t[1]=c*l+g*s+f*a-h*u,t[2]=f*l+g*u+h*s-c*a,t[3]=g*l-h*a-c*s-f*u;var p=e[4],v=e[5],m=e[6],_=e[7];return t[4]=p*l+_*a+v*u-m*s,t[5]=v*l+_*s+m*a-p*u,t[6]=m*l+_*u+p*s-v*a,t[7]=_*l-p*a-v*s-m*u,t}function Bi(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t}function Hi(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=n[4],u=n[5],l=n[6],h=n[7],c=e[4],f=e[5],d=e[6],g=e[7],p=n[0],v=n[1],m=n[2],_=n[3];return t[0]=r*_+a*p+i*m-o*v,t[1]=i*_+a*v+o*p-r*m,t[2]=o*_+a*m+r*v-i*p,t[3]=a*_-r*p-i*v-o*m,t[4]=r*h+a*s+i*l-o*u+c*_+g*p+f*m-d*v,t[5]=i*h+a*u+o*s-r*l+f*_+g*v+d*p-c*m,t[6]=o*h+a*l+r*u-i*s+d*_+g*m+c*v-f*p,t[7]=a*h-r*s-i*u-o*l+g*_-c*p-f*v-d*m,t}var Ni=Hi;function Gi(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t}var ji=ii;function Wi(t,e,n,r){var i=1-r;return ji(e,n)<0&&(r=-r),t[0]=e[0]*i+n[0]*r,t[1]=e[1]*i+n[1]*r,t[2]=e[2]*i+n[2]*r,t[3]=e[3]*i+n[3]*r,t[4]=e[4]*i+n[4]*r,t[5]=e[5]*i+n[5]*r,t[6]=e[6]*i+n[6]*r,t[7]=e[7]*i+n[7]*r,t}function Xi(t,e){var n=Zi(e);return t[0]=-e[0]/n,t[1]=-e[1]/n,t[2]=-e[2]/n,t[3]=e[3]/n,t[4]=-e[4]/n,t[5]=-e[5]/n,t[6]=-e[6]/n,t[7]=e[7]/n,t}function Yi(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t[4]=-e[4],t[5]=-e[5],t[6]=-e[6],t[7]=e[7],t}var qi=ai,Vi=qi,Zi=ui,Ki=Zi;function Qi(t,e){var n=Zi(e);if(n>0){n=Math.sqrt(n);var r=e[0]/n,i=e[1]/n,o=e[2]/n,a=e[3]/n,s=e[4],u=e[5],l=e[6],h=e[7],c=r*s+i*u+o*l+a*h;t[0]=r,t[1]=i,t[2]=o,t[3]=a,t[4]=(s-r*c)/n,t[5]=(u-i*c)/n,t[6]=(l-o*c)/n,t[7]=(h-a*c)/n}return t}function Ji(t){return"quat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+")"}function $i(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]}function to(t,e){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],l=t[7],h=e[0],c=e[1],f=e[2],g=e[3],p=e[4],v=e[5],m=e[6],_=e[7];return Math.abs(n-h)<=d*Math.max(1,Math.abs(n),Math.abs(h))&&Math.abs(r-c)<=d*Math.max(1,Math.abs(r),Math.abs(c))&&Math.abs(i-f)<=d*Math.max(1,Math.abs(i),Math.abs(f))&&Math.abs(o-g)<=d*Math.max(1,Math.abs(o),Math.abs(g))&&Math.abs(a-p)<=d*Math.max(1,Math.abs(a),Math.abs(p))&&Math.abs(s-v)<=d*Math.max(1,Math.abs(s),Math.abs(v))&&Math.abs(u-m)<=d*Math.max(1,Math.abs(u),Math.abs(m))&&Math.abs(l-_)<=d*Math.max(1,Math.abs(l),Math.abs(_))}function eo(){var t=new g(2);return g!=Float32Array&&(t[0]=0,t[1]=0),t}function no(t){var e=new g(2);return e[0]=t[0],e[1]=t[1],e}function ro(t,e){var n=new g(2);return n[0]=t,n[1]=e,n}function io(t,e){return t[0]=e[0],t[1]=e[1],t}function oo(t,e,n){return t[0]=e,t[1]=n,t}function ao(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function so(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t}function uo(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t}function lo(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t}function ho(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t}function co(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t}function fo(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t}function go(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t}function po(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t}function vo(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t}function mo(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t}function _o(t,e){var n=e[0]-t[0],r=e[1]-t[1];return Math.hypot(n,r)}function yo(t,e){var n=e[0]-t[0],r=e[1]-t[1];return n*n+r*r}function bo(t){var e=t[0],n=t[1];return Math.hypot(e,n)}function xo(t){var e=t[0],n=t[1];return e*e+n*n}function wo(t,e){return t[0]=-e[0],t[1]=-e[1],t}function To(t,e){return t[0]=1/e[0],t[1]=1/e[1],t}function Eo(t,e){var n=e[0],r=e[1],i=n*n+r*r;return i>0&&(i=1/Math.sqrt(i)),t[0]=e[0]*i,t[1]=e[1]*i,t}function Mo(t,e){return t[0]*e[0]+t[1]*e[1]}function So(t,e,n){var r=e[0]*n[1]-e[1]*n[0];return t[0]=t[1]=0,t[2]=r,t}function Lo(t,e,n,r){var i=e[0],o=e[1];return t[0]=i+r*(n[0]-i),t[1]=o+r*(n[1]-o),t}function Ao(t,e){e=e||1;var n=2*p()*Math.PI;return t[0]=Math.cos(n)*e,t[1]=Math.sin(n)*e,t}function Ro(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i,t}function Po(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i+n[4],t[1]=n[1]*r+n[3]*i+n[5],t}function Co(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[3]*i+n[6],t[1]=n[1]*r+n[4]*i+n[7],t}function Io(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[4]*i+n[12],t[1]=n[1]*r+n[5]*i+n[13],t}function Fo(t,e,n,r){var i=e[0]-n[0],o=e[1]-n[1],a=Math.sin(r),s=Math.cos(r);return t[0]=i*s-o*a+n[0],t[1]=i*a+o*s+n[1],t}function ko(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],a=n*n+r*r;a>0&&(a=1/Math.sqrt(a));var s=i*i+o*o;s>0&&(s=1/Math.sqrt(s));var u=(n*i+r*o)*a*s;return u>1?0:u<-1?Math.PI:Math.acos(u)}function Do(t){return t[0]=0,t[1]=0,t}function Oo(t){return"vec2("+t[0]+", "+t[1]+")"}function Uo(t,e){return t[0]===e[0]&&t[1]===e[1]}function zo(t,e){var n=t[0],r=t[1],i=e[0],o=e[1];return Math.abs(n-i)<=d*Math.max(1,Math.abs(n),Math.abs(i))&&Math.abs(r-o)<=d*Math.max(1,Math.abs(r),Math.abs(o))}var Bo=bo,Ho=so,No=uo,Go=lo,jo=_o,Wo=yo,Xo=xo,Yo=function(){var t=eo();return function(e,n,r,i,o,a){var s,u;for(n||(n=2),r||(r=0),u=i?Math.min(i*n+r,e.length):e.length,s=r;s<u;s+=n)t[0]=e[s],t[1]=e[s+1],o(t,t,a),e[s]=t[0],e[s+1]=t[1];return e}}();n.d(e,"glMatrix",(function(){return r})),n.d(e,"mat2",(function(){return i})),n.d(e,"mat2d",(function(){return o})),n.d(e,"mat3",(function(){return a})),n.d(e,"mat4",(function(){return s})),n.d(e,"quat",(function(){return h})),n.d(e,"quat2",(function(){return c})),n.d(e,"vec2",(function(){return f})),n.d(e,"vec3",(function(){return u})),n.d(e,"vec4",(function(){return l}))},function(t,e,n){"use strict";var r,i="object"==typeof Reflect?Reflect:null,o=i&&"function"==typeof i.apply?i.apply:function(t,e,n){return Function.prototype.apply.call(t,e,n)};r=i&&"function"==typeof i.ownKeys?i.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)};var a=Number.isNaN||function(t){return t!=t};function s(){s.init.call(this)}t.exports=s,s.EventEmitter=s,s.prototype._events=void 0,s.prototype._eventsCount=0,s.prototype._maxListeners=void 0;var u=10;function l(t){return void 0===t._maxListeners?s.defaultMaxListeners:t._maxListeners}function h(t,e,n,r){var i,o,a,s;if("function"!=typeof n)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof n);if(void 0===(o=t._events)?(o=t._events=Object.create(null),t._eventsCount=0):(void 0!==o.newListener&&(t.emit("newListener",e,n.listener?n.listener:n),o=t._events),a=o[e]),void 0===a)a=o[e]=n,++t._eventsCount;else if("function"==typeof a?a=o[e]=r?[n,a]:[a,n]:r?a.unshift(n):a.push(n),(i=l(t))>0&&a.length>i&&!a.warned){a.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=t,u.type=e,u.count=a.length,s=u,console&&console.warn&&console.warn(s)}return t}function c(){for(var t=[],e=0;e<arguments.length;e++)t.push(arguments[e]);this.fired||(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,o(this.listener,this.target,t))}function f(t,e,n){var r={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},i=c.bind(r);return i.listener=n,r.wrapFn=i,i}function d(t,e,n){var r=t._events;if(void 0===r)return[];var i=r[e];return void 0===i?[]:"function"==typeof i?n?[i.listener||i]:[i]:n?function(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}(i):p(i,i.length)}function g(t){var e=this._events;if(void 0!==e){var n=e[t];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function p(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t[r];return n}Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return u},set:function(t){if("number"!=typeof t||t<0||a(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");u=t}}),s.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||a(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this},s.prototype.getMaxListeners=function(){return l(this)},s.prototype.emit=function(t){for(var e=[],n=1;n<arguments.length;n++)e.push(arguments[n]);var r="error"===t,i=this._events;if(void 0!==i)r=r&&void 0===i.error;else if(!r)return!1;if(r){var a;if(e.length>0&&(a=e[0]),a instanceof Error)throw a;var s=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw s.context=a,s}var u=i[t];if(void 0===u)return!1;if("function"==typeof u)o(u,this,e);else{var l=u.length,h=p(u,l);for(n=0;n<l;++n)o(h[n],this,e)}return!0},s.prototype.addListener=function(t,e){return h(this,t,e,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(t,e){return h(this,t,e,!0)},s.prototype.once=function(t,e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e);return this.on(t,f(this,t,e)),this},s.prototype.prependOnceListener=function(t,e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e);return this.prependListener(t,f(this,t,e)),this},s.prototype.removeListener=function(t,e){var n,r,i,o,a;if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e);if(void 0===(r=this._events))return this;if(void 0===(n=r[t]))return this;if(n===e||n.listener===e)0==--this._eventsCount?this._events=Object.create(null):(delete r[t],r.removeListener&&this.emit("removeListener",t,n.listener||e));else if("function"!=typeof n){for(i=-1,o=n.length-1;o>=0;o--)if(n[o]===e||n[o].listener===e){a=n[o].listener,i=o;break}if(i<0)return this;0===i?n.shift():function(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}(n,i),1===n.length&&(r[t]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",t,a||e)}return this},s.prototype.off=s.prototype.removeListener,s.prototype.removeAllListeners=function(t){var e,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[t]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[t]),this;if(0===arguments.length){var i,o=Object.keys(n);for(r=0;r<o.length;++r)"removeListener"!==(i=o[r])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(e=n[t]))this.removeListener(t,e);else if(void 0!==e)for(r=e.length-1;r>=0;r--)this.removeListener(t,e[r]);return this},s.prototype.listeners=function(t){return d(this,t,!0)},s.prototype.rawListeners=function(t){return d(this,t,!1)},s.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):g.call(t,e)},s.prototype.listenerCount=g,s.prototype.eventNames=function(){return this._eventsCount>0?r(this._events):[]}},function(t,e,n){"use strict";e.__esModule=!0;var r=n(0),i=function(){function t(e,n){"string"==typeof e&&(e=t.compile(e,r.gl.VERTEX_SHADER)),"string"==typeof n&&(n=t.compile(n,r.gl.FRAGMENT_SHADER));var i=r.gl.createProgram();if(!i)throw new Error("Couldn't create program.");if(this.programId=i,r.gl.attachShader(this.programId,e),r.gl.attachShader(this.programId,n),r.gl.linkProgram(this.programId),!r.gl.getProgramParameter(this.programId,r.gl.LINK_STATUS)){var o=r.gl.getProgramInfoLog(this.programId);throw new Error("Linking of shaderprogram failed: "+o)}}return t.prototype.getId=function(){return this.programId},t.prototype.getAttributeLocation=function(t){return r.gl.getAttribLocation(this.programId,t)},t.prototype.getUniformLocation=function(t){var e=r.gl.getUniformLocation(this.programId,t);if(!e)throw new Error("Couldn't retrieve uniform location: "+t);return e},t.prototype.setUniformF=function(t,e){r.gl.uniform1f(t,e)},t.prototype.setUniformFv=function(t,e){r.gl.uniform1fv(t,e)},t.prototype.setUniformI=function(t,e){r.gl.uniform1i(t,e)},t.prototype.setUniformUi=function(t,e){r.gl.uniform1ui(t,e)},t.prototype.setUniformVec2=function(t,e){r.gl.uniform2fv(t,e)},t.prototype.setUniformVec3=function(t,e){r.gl.uniform3fv(t,e)},t.prototype.setUniformVec4=function(t,e){r.gl.uniform4fv(t,e)},t.prototype.setUniformUvec4=function(t,e){r.gl.uniform4uiv(t,e)},t.prototype.setUniformMat2=function(t,e){r.gl.uniformMatrix2fv(t,!1,e)},t.prototype.setUniformMat3=function(t,e){r.gl.uniformMatrix3fv(t,!1,e)},t.prototype.setUniformMat4=function(t,e){r.gl.uniformMatrix4fv(t,!1,e)},t.prototype.use=function(){r.gl.useProgram(this.programId)},t.compile=function(t,e){var n=r.gl.createShader(e);if(!n)throw new Error("Couldn't create shader");if(r.gl.shaderSource(n,t),r.gl.compileShader(n),!r.gl.getShaderParameter(n,r.gl.COMPILE_STATUS)){var i=r.gl.getShaderInfoLog(n);throw r.gl.deleteShader(n),new Error("Couldn't compile shader: "+i)}return n},t}();e.default=i},function(t,e){"function"==typeof Object.create?t.exports=function(t,e){e&&(t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:t.exports=function(t,e){if(e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}}},function(t,e,n){(function(t){function n(t){return Object.prototype.toString.call(t)}e.isArray=function(t){return Array.isArray?Array.isArray(t):"[object Array]"===n(t)},e.isBoolean=function(t){return"boolean"==typeof t},e.isNull=function(t){return null===t},e.isNullOrUndefined=function(t){return null==t},e.isNumber=function(t){return"number"==typeof t},e.isString=function(t){return"string"==typeof t},e.isSymbol=function(t){return"symbol"==typeof t},e.isUndefined=function(t){return void 0===t},e.isRegExp=function(t){return"[object RegExp]"===n(t)},e.isObject=function(t){return"object"==typeof t&&null!==t},e.isDate=function(t){return"[object Date]"===n(t)},e.isError=function(t){return"[object Error]"===n(t)||t instanceof Error},e.isFunction=function(t){return"function"==typeof t},e.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},e.isBuffer=t.isBuffer}).call(this,n(1).Buffer)},function(t,e,n){"use strict";(function(t){var r=n(1).Buffer,i=n(16).Transform,o=n(73),a=n(5),s=n(23).ok,u=n(1).kMaxLength,l="Cannot create final Buffer. It would be larger than 0x"+u.toString(16)+" bytes";o.Z_MIN_WINDOWBITS=8,o.Z_MAX_WINDOWBITS=15,o.Z_DEFAULT_WINDOWBITS=15,o.Z_MIN_CHUNK=64,o.Z_MAX_CHUNK=1/0,o.Z_DEFAULT_CHUNK=16384,o.Z_MIN_MEMLEVEL=1,o.Z_MAX_MEMLEVEL=9,o.Z_DEFAULT_MEMLEVEL=8,o.Z_MIN_LEVEL=-1,o.Z_MAX_LEVEL=9,o.Z_DEFAULT_LEVEL=o.Z_DEFAULT_COMPRESSION;for(var h=Object.keys(o),c=0;c<h.length;c++){var f=h[c];f.match(/^Z/)&&Object.defineProperty(e,f,{enumerable:!0,value:o[f],writable:!1})}for(var d={Z_OK:o.Z_OK,Z_STREAM_END:o.Z_STREAM_END,Z_NEED_DICT:o.Z_NEED_DICT,Z_ERRNO:o.Z_ERRNO,Z_STREAM_ERROR:o.Z_STREAM_ERROR,Z_DATA_ERROR:o.Z_DATA_ERROR,Z_MEM_ERROR:o.Z_MEM_ERROR,Z_BUF_ERROR:o.Z_BUF_ERROR,Z_VERSION_ERROR:o.Z_VERSION_ERROR},g=Object.keys(d),p=0;p<g.length;p++){var v=g[p];d[d[v]]=v}function m(t,e,n){var i=[],o=0;function a(){for(var e;null!==(e=t.read());)i.push(e),o+=e.length;t.once("readable",a)}function s(){var e,a=null;o>=u?a=new RangeError(l):e=r.concat(i,o),i=[],t.close(),n(a,e)}t.on("error",(function(e){t.removeListener("end",s),t.removeListener("readable",a),n(e)})),t.on("end",s),t.end(e),a()}function _(t,e){if("string"==typeof e&&(e=r.from(e)),!r.isBuffer(e))throw new TypeError("Not a string or buffer");var n=t._finishFlushFlag;return t._processChunk(e,n)}function y(t){if(!(this instanceof y))return new y(t);L.call(this,t,o.DEFLATE)}function b(t){if(!(this instanceof b))return new b(t);L.call(this,t,o.INFLATE)}function x(t){if(!(this instanceof x))return new x(t);L.call(this,t,o.GZIP)}function w(t){if(!(this instanceof w))return new w(t);L.call(this,t,o.GUNZIP)}function T(t){if(!(this instanceof T))return new T(t);L.call(this,t,o.DEFLATERAW)}function E(t){if(!(this instanceof E))return new E(t);L.call(this,t,o.INFLATERAW)}function M(t){if(!(this instanceof M))return new M(t);L.call(this,t,o.UNZIP)}function S(t){return t===o.Z_NO_FLUSH||t===o.Z_PARTIAL_FLUSH||t===o.Z_SYNC_FLUSH||t===o.Z_FULL_FLUSH||t===o.Z_FINISH||t===o.Z_BLOCK}function L(t,n){var a=this;if(this._opts=t=t||{},this._chunkSize=t.chunkSize||e.Z_DEFAULT_CHUNK,i.call(this,t),t.flush&&!S(t.flush))throw new Error("Invalid flush flag: "+t.flush);if(t.finishFlush&&!S(t.finishFlush))throw new Error("Invalid flush flag: "+t.finishFlush);if(this._flushFlag=t.flush||o.Z_NO_FLUSH,this._finishFlushFlag=void 0!==t.finishFlush?t.finishFlush:o.Z_FINISH,t.chunkSize&&(t.chunkSize<e.Z_MIN_CHUNK||t.chunkSize>e.Z_MAX_CHUNK))throw new Error("Invalid chunk size: "+t.chunkSize);if(t.windowBits&&(t.windowBits<e.Z_MIN_WINDOWBITS||t.windowBits>e.Z_MAX_WINDOWBITS))throw new Error("Invalid windowBits: "+t.windowBits);if(t.level&&(t.level<e.Z_MIN_LEVEL||t.level>e.Z_MAX_LEVEL))throw new Error("Invalid compression level: "+t.level);if(t.memLevel&&(t.memLevel<e.Z_MIN_MEMLEVEL||t.memLevel>e.Z_MAX_MEMLEVEL))throw new Error("Invalid memLevel: "+t.memLevel);if(t.strategy&&t.strategy!=e.Z_FILTERED&&t.strategy!=e.Z_HUFFMAN_ONLY&&t.strategy!=e.Z_RLE&&t.strategy!=e.Z_FIXED&&t.strategy!=e.Z_DEFAULT_STRATEGY)throw new Error("Invalid strategy: "+t.strategy);if(t.dictionary&&!r.isBuffer(t.dictionary))throw new Error("Invalid dictionary: it should be a Buffer instance");this._handle=new o.Zlib(n);var s=this;this._hadError=!1,this._handle.onerror=function(t,n){A(s),s._hadError=!0;var r=new Error(t);r.errno=n,r.code=e.codes[n],s.emit("error",r)};var u=e.Z_DEFAULT_COMPRESSION;"number"==typeof t.level&&(u=t.level);var l=e.Z_DEFAULT_STRATEGY;"number"==typeof t.strategy&&(l=t.strategy),this._handle.init(t.windowBits||e.Z_DEFAULT_WINDOWBITS,u,t.memLevel||e.Z_DEFAULT_MEMLEVEL,l,t.dictionary),this._buffer=r.allocUnsafe(this._chunkSize),this._offset=0,this._level=u,this._strategy=l,this.once("end",this.close),Object.defineProperty(this,"_closed",{get:function(){return!a._handle},configurable:!0,enumerable:!0})}function A(e,n){n&&t.nextTick(n),e._handle&&(e._handle.close(),e._handle=null)}function R(t){t.emit("close")}Object.defineProperty(e,"codes",{enumerable:!0,value:Object.freeze(d),writable:!1}),e.Deflate=y,e.Inflate=b,e.Gzip=x,e.Gunzip=w,e.DeflateRaw=T,e.InflateRaw=E,e.Unzip=M,e.createDeflate=function(t){return new y(t)},e.createInflate=function(t){return new b(t)},e.createDeflateRaw=function(t){return new T(t)},e.createInflateRaw=function(t){return new E(t)},e.createGzip=function(t){return new x(t)},e.createGunzip=function(t){return new w(t)},e.createUnzip=function(t){return new M(t)},e.deflate=function(t,e,n){return"function"==typeof e&&(n=e,e={}),m(new y(e),t,n)},e.deflateSync=function(t,e){return _(new y(e),t)},e.gzip=function(t,e,n){return"function"==typeof e&&(n=e,e={}),m(new x(e),t,n)},e.gzipSync=function(t,e){return _(new x(e),t)},e.deflateRaw=function(t,e,n){return"function"==typeof e&&(n=e,e={}),m(new T(e),t,n)},e.deflateRawSync=function(t,e){return _(new T(e),t)},e.unzip=function(t,e,n){return"function"==typeof e&&(n=e,e={}),m(new M(e),t,n)},e.unzipSync=function(t,e){return _(new M(e),t)},e.inflate=function(t,e,n){return"function"==typeof e&&(n=e,e={}),m(new b(e),t,n)},e.inflateSync=function(t,e){return _(new b(e),t)},e.gunzip=function(t,e,n){return"function"==typeof e&&(n=e,e={}),m(new w(e),t,n)},e.gunzipSync=function(t,e){return _(new w(e),t)},e.inflateRaw=function(t,e,n){return"function"==typeof e&&(n=e,e={}),m(new E(e),t,n)},e.inflateRawSync=function(t,e){return _(new E(e),t)},a.inherits(L,i),L.prototype.params=function(n,r,i){if(n<e.Z_MIN_LEVEL||n>e.Z_MAX_LEVEL)throw new RangeError("Invalid compression level: "+n);if(r!=e.Z_FILTERED&&r!=e.Z_HUFFMAN_ONLY&&r!=e.Z_RLE&&r!=e.Z_FIXED&&r!=e.Z_DEFAULT_STRATEGY)throw new TypeError("Invalid strategy: "+r);if(this._level!==n||this._strategy!==r){var a=this;this.flush(o.Z_SYNC_FLUSH,(function(){s(a._handle,"zlib binding closed"),a._handle.params(n,r),a._hadError||(a._level=n,a._strategy=r,i&&i())}))}else t.nextTick(i)},L.prototype.reset=function(){return s(this._handle,"zlib binding closed"),this._handle.reset()},L.prototype._flush=function(t){this._transform(r.alloc(0),"",t)},L.prototype.flush=function(e,n){var i=this,a=this._writableState;("function"==typeof e||void 0===e&&!n)&&(n=e,e=o.Z_FULL_FLUSH),a.ended?n&&t.nextTick(n):a.ending?n&&this.once("end",n):a.needDrain?n&&this.once("drain",(function(){return i.flush(e,n)})):(this._flushFlag=e,this.write(r.alloc(0),"",n))},L.prototype.close=function(e){A(this,e),t.nextTick(R,this)},L.prototype._transform=function(t,e,n){var i,a=this._writableState,s=(a.ending||a.ended)&&(!t||a.length===t.length);return null===t||r.isBuffer(t)?this._handle?(s?i=this._finishFlushFlag:(i=this._flushFlag,t.length>=a.length&&(this._flushFlag=this._opts.flush||o.Z_NO_FLUSH)),void this._processChunk(t,i,n)):n(new Error("zlib binding closed")):n(new Error("invalid input"))},L.prototype._processChunk=function(t,e,n){var i=t&&t.length,o=this._chunkSize-this._offset,a=0,h=this,c="function"==typeof n;if(!c){var f,d=[],g=0;this.on("error",(function(t){f=t})),s(this._handle,"zlib binding closed");do{var p=this._handle.writeSync(e,t,a,i,this._buffer,this._offset,o)}while(!this._hadError&&_(p[0],p[1]));if(this._hadError)throw f;if(g>=u)throw A(this),new RangeError(l);var v=r.concat(d,g);return A(this),v}s(this._handle,"zlib binding closed");var m=this._handle.write(e,t,a,i,this._buffer,this._offset,o);function _(u,l){if(this&&(this.buffer=null,this.callback=null),!h._hadError){var f=o-l;if(s(f>=0,"have should not go down"),f>0){var p=h._buffer.slice(h._offset,h._offset+f);h._offset+=f,c?h.push(p):(d.push(p),g+=p.length)}if((0===l||h._offset>=h._chunkSize)&&(o=h._chunkSize,h._offset=0,h._buffer=r.allocUnsafe(h._chunkSize)),0===l){if(a+=i-u,i=u,!c)return!0;var v=h._handle.write(e,t,a,i,h._buffer,h._offset,h._chunkSize);return v.callback=_,void(v.buffer=t)}if(!c)return!1;n()}}m.buffer=t,m.callback=_},a.inherits(y,L),a.inherits(b,L),a.inherits(x,L),a.inherits(w,L),a.inherits(T,L),a.inherits(E,L),a.inherits(M,L)}).call(this,n(3))},function(t,e,n){"use strict";t.exports={PNG_SIGNATURE:[137,80,78,71,13,10,26,10],TYPE_IHDR:1229472850,TYPE_IEND:1229278788,TYPE_IDAT:1229209940,TYPE_PLTE:1347179589,TYPE_tRNS:1951551059,TYPE_gAMA:1732332865,COLORTYPE_GRAYSCALE:0,COLORTYPE_PALETTE:1,COLORTYPE_COLOR:2,COLORTYPE_ALPHA:4,COLORTYPE_PALETTE_COLOR:3,COLORTYPE_COLOR_ALPHA:6,COLORTYPE_TO_BPP_MAP:{0:1,2:3,3:1,4:2,6:4},GAMMA_DIVISION:1e5}},function(t,e,n){"use strict";function r(t,e){void 0===e&&(e=!0),e?t.setAttribute("hidden","1"):t.removeAttribute("hidden")}function i(t){for(var e=window.atob(t.split(",")[1]),n=t.split(",")[0].split(":")[1].split(";")[0],r=new ArrayBuffer(e.length),i=new Uint8Array(r),o=0;o<e.length;o++)i[o]=e.charCodeAt(o);return new Blob([r],{type:n})}e.__esModule=!0,e.hide=r,e.show=function(t,e){void 0===e&&(e=!0),r(t,!e)},e.hex2color=function(t){var e=t.match(/[A-Za-z0-9]{2}/g);return e?e.map((function(t){return parseInt(t,16)/255})):[0,0,0]},e.color2hex=function(t){return"#"+t.map((function(t){return Math.round(255*t).toString(16).padStart(2,"0")})).join("")},e.rgbaDataToPNGDataURL=function(t,e){var n=document.createElement("canvas"),r=n.getContext("2d");n.width=e[0],n.height=e[1];var i=r.createImageData(e[0],e[1]);i.data.set(t),r.putImageData(i,0,0);var o=n.toDataURL();return n.width=n.height=1,o},e.openInNewTab=function(t){var e=document.createElement("a");e.style.display="none",e.target="_blank",e.href=t,document.body.appendChild(e),e.click(),document.body.removeChild(e)},e.downloadBlob=function(t,e){if(navigator.msSaveOrOpenBlob)navigator.msSaveOrOpenBlob(e,t);else{var n=document.createElement("a");n.download=t,n.style.display="none",document.body.appendChild(n);var r=URL.createObjectURL(e);n.href=r,n.onclick=function(){return requestAnimationFrame((function(){return URL.revokeObjectURL(r)}))},n.click(),document.body.removeChild(n)}},e.uriToBlob=i,e.downloadURI=function(t,e){if(navigator.msSaveOrOpenBlob)navigator.msSaveOrOpenBlob(i(e),t);else{var n=document.createElement("a");n.download=t,n.style.display="none",document.body.appendChild(n);try{var r=i(e),o=URL.createObjectURL(r);n.href=o,n.onclick=function(){return requestAnimationFrame((function(){return URL.revokeObjectURL(o)}))}}catch(t){n.href=e}n.click(),document.body.removeChild(n)}},e.arrayMinMax=function(t){for(var e=t[0],n=t[0],r=1;r<t.length;++r){var i=t[r];i<e&&(e=i),i>n&&(n=i)}return{min:e,max:n}}},function(t,e,n){t.exports=i;var r=n(9).EventEmitter;function i(){r.call(this)}n(11)(i,r),i.Readable=n(21),i.Writable=n(68),i.Duplex=n(69),i.Transform=n(70),i.PassThrough=n(71),i.Stream=i,i.prototype.pipe=function(t,e){var n=this;function i(e){t.writable&&!1===t.write(e)&&n.pause&&n.pause()}function o(){n.readable&&n.resume&&n.resume()}n.on("data",i),t.on("drain",o),t._isStdio||e&&!1===e.end||(n.on("end",s),n.on("close",u));var a=!1;function s(){a||(a=!0,t.end())}function u(){a||(a=!0,"function"==typeof t.destroy&&t.destroy())}function l(t){if(h(),0===r.listenerCount(this,"error"))throw t}function h(){n.removeListener("data",i),t.removeListener("drain",o),n.removeListener("end",s),n.removeListener("close",u),n.removeListener("error",l),t.removeListener("error",l),n.removeListener("end",h),n.removeListener("close",h),t.removeListener("close",h)}return n.on("error",l),t.on("error",l),n.on("end",h),n.on("close",h),t.on("close",h),t.emit("pipe",n),t}},function(t,e,n){"use strict";(function(e){void 0===e||!e.version||0===e.version.indexOf("v0.")||0===e.version.indexOf("v1.")&&0!==e.version.indexOf("v1.8.")?t.exports={nextTick:function(t,n,r,i){if("function"!=typeof t)throw new TypeError('"callback" argument must be a function');var o,a,s=arguments.length;switch(s){case 0:case 1:return e.nextTick(t);case 2:return e.nextTick((function(){t.call(null,n)}));case 3:return e.nextTick((function(){t.call(null,n,r)}));case 4:return e.nextTick((function(){t.call(null,n,r,i)}));default:for(o=new Array(s-1),a=0;a<o.length;)o[a++]=arguments[a];return e.nextTick((function(){t.apply(null,o)}))}}}:t.exports=e}).call(this,n(3))},function(t,e,n){var r=n(1),i=r.Buffer;function o(t,e){for(var n in t)e[n]=t[n]}function a(t,e,n){return i(t,e,n)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?t.exports=r:(o(r,e),e.Buffer=a),o(i,a),a.from=function(t,e,n){if("number"==typeof t)throw new TypeError("Argument must not be a number");return i(t,e,n)},a.alloc=function(t,e,n){if("number"!=typeof t)throw new TypeError("Argument must be a number");var r=i(t);return void 0!==e?"string"==typeof n?r.fill(e,n):r.fill(e):r.fill(0),r},a.allocUnsafe=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return i(t)},a.allocUnsafeSlow=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return r.SlowBuffer(t)}},function(t,e,n){"use strict";var r="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;function i(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.assign=function(t){for(var e=Array.prototype.slice.call(arguments,1);e.length;){var n=e.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(var r in n)i(n,r)&&(t[r]=n[r])}}return t},e.shrinkBuf=function(t,e){return t.length===e?t:t.subarray?t.subarray(0,e):(t.length=e,t)};var o={arraySet:function(t,e,n,r,i){if(e.subarray&&t.subarray)t.set(e.subarray(n,n+r),i);else for(var o=0;o<r;o++)t[i+o]=e[n+o]},flattenChunks:function(t){var e,n,r,i,o,a;for(r=0,e=0,n=t.length;e<n;e++)r+=t[e].length;for(a=new Uint8Array(r),i=0,e=0,n=t.length;e<n;e++)o=t[e],a.set(o,i),i+=o.length;return a}},a={arraySet:function(t,e,n,r,i){for(var o=0;o<r;o++)t[i+o]=e[n+o]},flattenChunks:function(t){return[].concat.apply([],t)}};e.setTyped=function(t){t?(e.Buf8=Uint8Array,e.Buf16=Uint16Array,e.Buf32=Int32Array,e.assign(e,o)):(e.Buf8=Array,e.Buf16=Array,e.Buf32=Array,e.assign(e,a))},e.setTyped(r)},function(t,e,n){"use strict";e.__esModule=!0;var r=n(8),i=[1024,1024],o=new(function(){function t(){this.trees=[],this.changed=!1}return t.prototype.addTrees=function(t,e,n,i){for(var o=0;o<16*t;++o){var a=[0,n*Math.random()],s=[0,0];if(r.vec2.rotate(s,a,[0,0],Math.random()*Math.PI*2),s[0]+=e[0],s[1]+=e[1],this.checkPosition(s,i)&&(this.trees.push(s),this.changed=!0,--t<=0))return}},t.prototype.checkPosition=function(t,e){if(t[0]<0||t[0]>i[0]||t[1]<0||t[1]>i[1])return!1;for(var n=0,o=this.trees;n<o.length;n++){var a=o[n];if(r.vec2.dist(t,a)<e)return!1}return!0},t.prototype.removeTrees=function(t,e,n){for(var i=this.trees.length-1;i>=0;--i){if(r.vec2.dist(e,this.trees[i])<=n&&(this.trees.splice(i,1),this.changed=!0,--t<=0))return}},t.prototype.hasChange=function(){return this.changed},t.prototype.clearChange=function(){this.changed=!1},t.prototype.getTrees=function(){return this.trees},t.prototype.setTrees=function(t){this.trees=t,this.changed=!0},t.prototype.serializeTrees=function(){for(var t=new Float32Array(this.trees.length),e=0;e<this.trees.length;++e){var n=this.trees[e];t[2*e]=n[0],t[2*e+1]=n[1]}return t},t.prototype.deserializeTrees=function(t){this.trees=[];for(var e=0;e<t.length;e+=2)this.trees.push([t[e],t[e+1]])},t}());e.default=o},function(t,e,n){(e=t.exports=n(29)).Stream=e,e.Readable=e,e.Writable=n(22),e.Duplex=n(7),e.Transform=n(33),e.PassThrough=n(67)},function(t,e,n){"use strict";(function(e,r,i){var o=n(17);function a(t){var e=this;this.next=null,this.entry=null,this.finish=function(){!function(t,e,n){var r=t.entry;t.entry=null;for(;r;){var i=r.callback;e.pendingcb--,i(n),r=r.next}e.corkedRequestsFree?e.corkedRequestsFree.next=t:e.corkedRequestsFree=t}(e,t)}}t.exports=_;var s,u=!e.browser&&["v0.10","v0.9."].indexOf(e.version.slice(0,5))>-1?r:o.nextTick;_.WritableState=m;var l=n(12);l.inherits=n(11);var h={deprecate:n(66)},c=n(30),f=n(18).Buffer,d=i.Uint8Array||function(){};var g,p=n(31);function v(){}function m(t,e){s=s||n(7),t=t||{};var r=e instanceof s;this.objectMode=!!t.objectMode,r&&(this.objectMode=this.objectMode||!!t.writableObjectMode);var i=t.highWaterMark,l=t.writableHighWaterMark,h=this.objectMode?16:16384;this.highWaterMark=i||0===i?i:r&&(l||0===l)?l:h,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var c=!1===t.decodeStrings;this.decodeStrings=!c,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(t){!function(t,e){var n=t._writableState,r=n.sync,i=n.writecb;if(function(t){t.writing=!1,t.writecb=null,t.length-=t.writelen,t.writelen=0}(n),e)!function(t,e,n,r,i){--e.pendingcb,n?(o.nextTick(i,r),o.nextTick(E,t,e),t._writableState.errorEmitted=!0,t.emit("error",r)):(i(r),t._writableState.errorEmitted=!0,t.emit("error",r),E(t,e))}(t,n,r,e,i);else{var a=w(n);a||n.corked||n.bufferProcessing||!n.bufferedRequest||x(t,n),r?u(b,t,n,a,i):b(t,n,a,i)}}(e,t)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new a(this)}function _(t){if(s=s||n(7),!(g.call(_,this)||this instanceof s))return new _(t);this._writableState=new m(t,this),this.writable=!0,t&&("function"==typeof t.write&&(this._write=t.write),"function"==typeof t.writev&&(this._writev=t.writev),"function"==typeof t.destroy&&(this._destroy=t.destroy),"function"==typeof t.final&&(this._final=t.final)),c.call(this)}function y(t,e,n,r,i,o,a){e.writelen=r,e.writecb=a,e.writing=!0,e.sync=!0,n?t._writev(i,e.onwrite):t._write(i,o,e.onwrite),e.sync=!1}function b(t,e,n,r){n||function(t,e){0===e.length&&e.needDrain&&(e.needDrain=!1,t.emit("drain"))}(t,e),e.pendingcb--,r(),E(t,e)}function x(t,e){e.bufferProcessing=!0;var n=e.bufferedRequest;if(t._writev&&n&&n.next){var r=e.bufferedRequestCount,i=new Array(r),o=e.corkedRequestsFree;o.entry=n;for(var s=0,u=!0;n;)i[s]=n,n.isBuf||(u=!1),n=n.next,s+=1;i.allBuffers=u,y(t,e,!0,e.length,i,"",o.finish),e.pendingcb++,e.lastBufferedRequest=null,o.next?(e.corkedRequestsFree=o.next,o.next=null):e.corkedRequestsFree=new a(e),e.bufferedRequestCount=0}else{for(;n;){var l=n.chunk,h=n.encoding,c=n.callback;if(y(t,e,!1,e.objectMode?1:l.length,l,h,c),n=n.next,e.bufferedRequestCount--,e.writing)break}null===n&&(e.lastBufferedRequest=null)}e.bufferedRequest=n,e.bufferProcessing=!1}function w(t){return t.ending&&0===t.length&&null===t.bufferedRequest&&!t.finished&&!t.writing}function T(t,e){t._final((function(n){e.pendingcb--,n&&t.emit("error",n),e.prefinished=!0,t.emit("prefinish"),E(t,e)}))}function E(t,e){var n=w(e);return n&&(!function(t,e){e.prefinished||e.finalCalled||("function"==typeof t._final?(e.pendingcb++,e.finalCalled=!0,o.nextTick(T,t,e)):(e.prefinished=!0,t.emit("prefinish")))}(t,e),0===e.pendingcb&&(e.finished=!0,t.emit("finish"))),n}l.inherits(_,c),m.prototype.getBuffer=function(){for(var t=this.bufferedRequest,e=[];t;)e.push(t),t=t.next;return e},function(){try{Object.defineProperty(m.prototype,"buffer",{get:h.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(t){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(g=Function.prototype[Symbol.hasInstance],Object.defineProperty(_,Symbol.hasInstance,{value:function(t){return!!g.call(this,t)||this===_&&(t&&t._writableState instanceof m)}})):g=function(t){return t instanceof this},_.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},_.prototype.write=function(t,e,n){var r,i=this._writableState,a=!1,s=!i.objectMode&&(r=t,f.isBuffer(r)||r instanceof d);return s&&!f.isBuffer(t)&&(t=function(t){return f.from(t)}(t)),"function"==typeof e&&(n=e,e=null),s?e="buffer":e||(e=i.defaultEncoding),"function"!=typeof n&&(n=v),i.ended?function(t,e){var n=new Error("write after end");t.emit("error",n),o.nextTick(e,n)}(this,n):(s||function(t,e,n,r){var i=!0,a=!1;return null===n?a=new TypeError("May not write null values to stream"):"string"==typeof n||void 0===n||e.objectMode||(a=new TypeError("Invalid non-string/buffer chunk")),a&&(t.emit("error",a),o.nextTick(r,a),i=!1),i}(this,i,t,n))&&(i.pendingcb++,a=function(t,e,n,r,i,o){if(!n){var a=function(t,e,n){t.objectMode||!1===t.decodeStrings||"string"!=typeof e||(e=f.from(e,n));return e}(e,r,i);r!==a&&(n=!0,i="buffer",r=a)}var s=e.objectMode?1:r.length;e.length+=s;var u=e.length<e.highWaterMark;u||(e.needDrain=!0);if(e.writing||e.corked){var l=e.lastBufferedRequest;e.lastBufferedRequest={chunk:r,encoding:i,isBuf:n,callback:o,next:null},l?l.next=e.lastBufferedRequest:e.bufferedRequest=e.lastBufferedRequest,e.bufferedRequestCount+=1}else y(t,e,!1,s,r,i,o);return u}(this,i,s,t,e,n)),a},_.prototype.cork=function(){this._writableState.corked++},_.prototype.uncork=function(){var t=this._writableState;t.corked&&(t.corked--,t.writing||t.corked||t.finished||t.bufferProcessing||!t.bufferedRequest||x(this,t))},_.prototype.setDefaultEncoding=function(t){if("string"==typeof t&&(t=t.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((t+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+t);return this._writableState.defaultEncoding=t,this},Object.defineProperty(_.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),_.prototype._write=function(t,e,n){n(new Error("_write() is not implemented"))},_.prototype._writev=null,_.prototype.end=function(t,e,n){var r=this._writableState;"function"==typeof t?(n=t,t=null,e=null):"function"==typeof e&&(n=e,e=null),null!=t&&this.write(t,e),r.corked&&(r.corked=1,this.uncork()),r.ending||r.finished||function(t,e,n){e.ending=!0,E(t,e),n&&(e.finished?o.nextTick(n):t.once("finish",n));e.ended=!0,t.writable=!1}(this,r,n)},Object.defineProperty(_.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(t){this._writableState&&(this._writableState.destroyed=t)}}),_.prototype.destroy=p.destroy,_.prototype._undestroy=p.undestroy,_.prototype._destroy=function(t,e){this.end(),e(t)}}).call(this,n(3),n(64).setImmediate,n(6))},function(t,e,n){"use strict";(function(e){var r=n(74);
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */function i(t,e){if(t===e)return 0;for(var n=t.length,r=e.length,i=0,o=Math.min(n,r);i<o;++i)if(t[i]!==e[i]){n=t[i],r=e[i];break}return n<r?-1:r<n?1:0}function o(t){return e.Buffer&&"function"==typeof e.Buffer.isBuffer?e.Buffer.isBuffer(t):!(null==t||!t._isBuffer)}var a=n(5),s=Object.prototype.hasOwnProperty,u=Array.prototype.slice,l="foo"===function(){}.name;function h(t){return Object.prototype.toString.call(t)}function c(t){return!o(t)&&("function"==typeof e.ArrayBuffer&&("function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(t):!!t&&(t instanceof DataView||!!(t.buffer&&t.buffer instanceof ArrayBuffer))))}var f=t.exports=_,d=/\s*function\s+([^\(\s]*)\s*/;function g(t){if(a.isFunction(t)){if(l)return t.name;var e=t.toString().match(d);return e&&e[1]}}function p(t,e){return"string"==typeof t?t.length<e?t:t.slice(0,e):t}function v(t){if(l||!a.isFunction(t))return a.inspect(t);var e=g(t);return"[Function"+(e?": "+e:"")+"]"}function m(t,e,n,r,i){throw new f.AssertionError({message:n,actual:t,expected:e,operator:r,stackStartFunction:i})}function _(t,e){t||m(t,!0,e,"==",f.ok)}function y(t,e,n,r){if(t===e)return!0;if(o(t)&&o(e))return 0===i(t,e);if(a.isDate(t)&&a.isDate(e))return t.getTime()===e.getTime();if(a.isRegExp(t)&&a.isRegExp(e))return t.source===e.source&&t.global===e.global&&t.multiline===e.multiline&&t.lastIndex===e.lastIndex&&t.ignoreCase===e.ignoreCase;if(null!==t&&"object"==typeof t||null!==e&&"object"==typeof e){if(c(t)&&c(e)&&h(t)===h(e)&&!(t instanceof Float32Array||t instanceof Float64Array))return 0===i(new Uint8Array(t.buffer),new Uint8Array(e.buffer));if(o(t)!==o(e))return!1;var s=(r=r||{actual:[],expected:[]}).actual.indexOf(t);return-1!==s&&s===r.expected.indexOf(e)||(r.actual.push(t),r.expected.push(e),function(t,e,n,r){if(null==t||null==e)return!1;if(a.isPrimitive(t)||a.isPrimitive(e))return t===e;if(n&&Object.getPrototypeOf(t)!==Object.getPrototypeOf(e))return!1;var i=b(t),o=b(e);if(i&&!o||!i&&o)return!1;if(i)return t=u.call(t),e=u.call(e),y(t,e,n);var s,l,h=T(t),c=T(e);if(h.length!==c.length)return!1;for(h.sort(),c.sort(),l=h.length-1;l>=0;l--)if(h[l]!==c[l])return!1;for(l=h.length-1;l>=0;l--)if(s=h[l],!y(t[s],e[s],n,r))return!1;return!0}(t,e,n,r))}return n?t===e:t==e}function b(t){return"[object Arguments]"==Object.prototype.toString.call(t)}function x(t,e){if(!t||!e)return!1;if("[object RegExp]"==Object.prototype.toString.call(e))return e.test(t);try{if(t instanceof e)return!0}catch(t){}return!Error.isPrototypeOf(e)&&!0===e.call({},t)}function w(t,e,n,r){var i;if("function"!=typeof e)throw new TypeError('"block" argument must be a function');"string"==typeof n&&(r=n,n=null),i=function(t){var e;try{t()}catch(t){e=t}return e}(e),r=(n&&n.name?" ("+n.name+").":".")+(r?" "+r:"."),t&&!i&&m(i,n,"Missing expected exception"+r);var o="string"==typeof r,s=!t&&i&&!n;if((!t&&a.isError(i)&&o&&x(i,n)||s)&&m(i,n,"Got unwanted exception"+r),t&&i&&n&&!x(i,n)||!t&&i)throw i}f.AssertionError=function(t){this.name="AssertionError",this.actual=t.actual,this.expected=t.expected,this.operator=t.operator,t.message?(this.message=t.message,this.generatedMessage=!1):(this.message=function(t){return p(v(t.actual),128)+" "+t.operator+" "+p(v(t.expected),128)}(this),this.generatedMessage=!0);var e=t.stackStartFunction||m;if(Error.captureStackTrace)Error.captureStackTrace(this,e);else{var n=new Error;if(n.stack){var r=n.stack,i=g(e),o=r.indexOf("\n"+i);if(o>=0){var a=r.indexOf("\n",o+1);r=r.substring(a+1)}this.stack=r}}},a.inherits(f.AssertionError,Error),f.fail=m,f.ok=_,f.equal=function(t,e,n){t!=e&&m(t,e,n,"==",f.equal)},f.notEqual=function(t,e,n){t==e&&m(t,e,n,"!=",f.notEqual)},f.deepEqual=function(t,e,n){y(t,e,!1)||m(t,e,n,"deepEqual",f.deepEqual)},f.deepStrictEqual=function(t,e,n){y(t,e,!0)||m(t,e,n,"deepStrictEqual",f.deepStrictEqual)},f.notDeepEqual=function(t,e,n){y(t,e,!1)&&m(t,e,n,"notDeepEqual",f.notDeepEqual)},f.notDeepStrictEqual=function t(e,n,r){y(e,n,!0)&&m(e,n,r,"notDeepStrictEqual",t)},f.strictEqual=function(t,e,n){t!==e&&m(t,e,n,"===",f.strictEqual)},f.notStrictEqual=function(t,e,n){t===e&&m(t,e,n,"!==",f.notStrictEqual)},f.throws=function(t,e,n){w(!0,t,e,n)},f.doesNotThrow=function(t,e,n){w(!1,t,e,n)},f.ifError=function(t){if(t)throw t},f.strict=r((function t(e,n){e||m(e,!0,n,"==",t)}),f,{equal:f.strictEqual,deepEqual:f.deepStrictEqual,notEqual:f.notStrictEqual,notDeepEqual:f.notDeepStrictEqual}),f.strict.strict=f.strict;var T=Object.keys||function(t){var e=[];for(var n in t)s.call(t,n)&&e.push(n);return e}}).call(this,n(6))},function(t,e,n){"use strict";e.__esModule=!0;var r=n(0),i=function(){function t(){this.id=-1,this.size=[0,0];var t=r.gl.createTexture();if(!t)throw new Error("Couldn't create texture.");this.id=t,this.bind(0),r.gl.texParameteri(r.gl.TEXTURE_2D,r.gl.TEXTURE_MAG_FILTER,r.gl.LINEAR),r.gl.texParameteri(r.gl.TEXTURE_2D,r.gl.TEXTURE_MIN_FILTER,r.gl.LINEAR),r.gl.texParameteri(r.gl.TEXTURE_2D,r.gl.TEXTURE_WRAP_S,r.gl.CLAMP_TO_EDGE),r.gl.texParameteri(r.gl.TEXTURE_2D,r.gl.TEXTURE_WRAP_T,r.gl.CLAMP_TO_EDGE)}return t.prototype.bind=function(t){r.gl.activeTexture(r.gl.TEXTURE0+t),r.gl.bindTexture(r.gl.TEXTURE_2D,this.id)},t.prototype.updateRGBDataWithImage=function(t){this.bind(0),r.gl.texImage2D(r.gl.TEXTURE_2D,0,r.gl.RGB,r.gl.RGB,r.gl.UNSIGNED_BYTE,t)},t.prototype.updateRGBADataWithImage=function(t){this.bind(0),r.gl.texImage2D(r.gl.TEXTURE_2D,0,r.gl.RGBA,r.gl.RGBA,r.gl.UNSIGNED_BYTE,t)},t.prototype.updateRGBData=function(t,e){this.bind(0),this.size=t,r.gl.texImage2D(r.gl.TEXTURE_2D,0,r.gl.RGB,t[0],t[1],0,r.gl.RGB,r.gl.UNSIGNED_BYTE,e)},t.prototype.updateRGBAData=function(t,e){this.bind(0),this.size=t,r.gl.texImage2D(r.gl.TEXTURE_2D,0,r.gl.RGBA8,t[0],t[1],0,r.gl.RGBA,r.gl.UNSIGNED_BYTE,e)},t.prototype.updateFloatRedData=function(t,e){this.bind(0),this.size=t,r.gl.texImage2D(r.gl.TEXTURE_2D,0,r.gl.R32F,t[0],t[1],0,r.gl.RED,r.gl.FLOAT,e)},t.prototype.updateFloatRGData=function(t,e){this.bind(0),this.size=t,r.gl.texImage2D(r.gl.TEXTURE_2D,0,r.gl.RG32F,t[0],t[1],0,r.gl.RG,r.gl.FLOAT,e)},t.prototype.updateFloatRGBData=function(t,e){this.bind(0),this.size=t,r.gl.texImage2D(r.gl.TEXTURE_2D,0,r.gl.RGB32F,t[0],t[1],0,r.gl.RGB,r.gl.FLOAT,e)},t.prototype.updateFloatRGBAData=function(t,e){this.bind(0),this.size=t,r.gl.texImage2D(r.gl.TEXTURE_2D,0,r.gl.RGBA32F,t[0],t[1],0,r.gl.RGBA,r.gl.FLOAT,e)},t.fromRGBImage=function(e){var n=new Image;n.src=e;var r=new t;return r.updateRGBData([1,1],null),n.onload=function(){r.updateRGBDataWithImage(n)},r},t.fromRGBAImage=function(e){var n=new Image;n.src=e;var r=new t;return r.updateRGBAData([1,1],null),n.onload=function(){r.updateRGBADataWithImage(n)},r},t}();e.default=i;var o=function(){function t(){this.currentTexture=new i,this.nextTexture=new i}return t.prototype.current=function(){return this.currentTexture},t.prototype.next=function(){var t=this.currentTexture;return this.currentTexture=this.nextTexture,this.nextTexture=t,this.currentTexture},t.prototype.initialize=function(t){t(this.currentTexture),t(this.nextTexture)},t}();e.PingPongTexture=o},function(t,e,n){"use strict";e.__esModule=!0;var r=n(0);e.MAX_LAYERS=8;var i=1024,o=function(){function t(){this.albedoRoughness=127}return t.prototype.setColor=function(t){t[0]=Math.min(Math.max(0,t[0]),t[0],1),t[1]=Math.min(Math.max(0,t[1]),t[1],1),t[2]=Math.min(Math.max(0,t[2]),t[2],1),this.albedoRoughness&=255,this.albedoRoughness|=255*t[0]<<24&4294967295,this.albedoRoughness|=255*t[1]<<16&4294967295,this.albedoRoughness|=255*t[2]<<8&4294967295},t.prototype.setRoughness=function(t){t=Math.min(Math.max(0,t),t,1),this.albedoRoughness&=-256,this.albedoRoughness|=255*t&255},t.prototype.getColor=function(){return[(this.albedoRoughness>>24&255)/255,(this.albedoRoughness>>16&255)/255,(this.albedoRoughness>>8&255)/255]},t.prototype.getRoughness=function(){return(255&this.albedoRoughness)/255},t.prototype.serialize=function(){return this.albedoRoughness},t.prototype.deserialize=function(t){this.albedoRoughness=t},t}();e.Material=o;var a=function(){function t(){this.layerOrder=[],this.activeLayers=[],this.layerMaterials=[];for(var t=0;t<e.MAX_LAYERS;++t)this.layerMaterials.push(new o),this.layerOrder.push(t),this.activeLayers.push(!1);var n=r.gl.createTexture();if(!n)throw new Error("Couldn't create texture.");this.weightMapCurrent=n;var a=r.gl.createTexture();if(!a)throw new Error("Couldn't create texture.");this.weightMapNext=a,r.gl.activeTexture(r.gl.TEXTURE0),r.gl.bindTexture(r.gl.TEXTURE_2D_ARRAY,this.weightMapCurrent),r.gl.texParameteri(r.gl.TEXTURE_2D_ARRAY,r.gl.TEXTURE_MAG_FILTER,r.gl.LINEAR),r.gl.texParameteri(r.gl.TEXTURE_2D_ARRAY,r.gl.TEXTURE_MIN_FILTER,r.gl.LINEAR),r.gl.texParameteri(r.gl.TEXTURE_2D_ARRAY,r.gl.TEXTURE_WRAP_S,r.gl.CLAMP_TO_EDGE),r.gl.texParameteri(r.gl.TEXTURE_2D_ARRAY,r.gl.TEXTURE_WRAP_T,r.gl.CLAMP_TO_EDGE),r.gl.texStorage3D(r.gl.TEXTURE_2D_ARRAY,1,r.gl.RGBA16F,i,i,e.MAX_LAYERS/4),r.gl.bindTexture(r.gl.TEXTURE_2D_ARRAY,this.weightMapNext),r.gl.texParameteri(r.gl.TEXTURE_2D_ARRAY,r.gl.TEXTURE_MAG_FILTER,r.gl.LINEAR),r.gl.texParameteri(r.gl.TEXTURE_2D_ARRAY,r.gl.TEXTURE_MIN_FILTER,r.gl.LINEAR),r.gl.texParameteri(r.gl.TEXTURE_2D_ARRAY,r.gl.TEXTURE_WRAP_S,r.gl.CLAMP_TO_EDGE),r.gl.texParameteri(r.gl.TEXTURE_2D_ARRAY,r.gl.TEXTURE_WRAP_T,r.gl.CLAMP_TO_EDGE),r.gl.texStorage3D(r.gl.TEXTURE_2D_ARRAY,1,r.gl.RGBA16F,i,i,e.MAX_LAYERS/4)}return t.prototype.swapWeightMaps=function(){var t=this.weightMapCurrent;this.weightMapCurrent=this.weightMapNext,this.weightMapNext=t},t.prototype.getLayerMaterial=function(t){return this.layerMaterials[t]},t.prototype.setLayerActive=function(t,e){this.activeLayers[t]=e},t.prototype.getLayerActive=function(t){return this.activeLayers[t]},t.prototype.serialize=function(){return{layerOrder:this.layerOrder,activeLayers:this.activeLayers,layerMaterials:this.layerMaterials.map((function(t){return t.serialize()}))}},t.prototype.deserialize=function(t){this.layerOrder=t.layerOrder,this.activeLayers=t.activeLayers;for(var n=0;n<e.MAX_LAYERS;n++)this.layerMaterials[n].deserialize(t.layerMaterials[n])},t}();e.default=a},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});e.__esModule=!0;var o=n(0),a=n(2),s=n(54).default,u=function(t){function e(){var e=t.call(this,s)||this;return e.dataQueue=[],e.uTexture=e.shader.getUniformLocation("uTexture"),e.uBrushesTexture=e.shader.getUniformLocation("uBrushesTexture"),e.uType=e.shader.getUniformLocation("uType"),e.uRadius=e.shader.getUniformLocation("uRadius"),e.uStrength=e.shader.getUniformLocation("uStrength"),e.uPoints=e.shader.getUniformLocation("uPoints"),e.uPointCount=e.shader.getUniformLocation("uPointCount"),e}return i(e,t),e.prototype.initalizePass=function(t,e){this.shader.setUniformI(this.uTexture,0),t.brushes.bind(1),this.shader.setUniformI(this.uBrushesTexture,1);var n=this.dataQueue.shift();n?(n.points.length>=100&&console.error("Too much points for HeightBrushPass"),n.water?(t.waterHeightMap.current().bind(0),e.setColorAttachment(t.waterHeightMap.next())):(t.heightMap.current().bind(0),e.setColorAttachment(t.heightMap.next())),this.shader.setUniformVec2(this.uPoints,n.points),this.shader.setUniformI(this.uPointCount,n.points.length/2),this.shader.setUniformI(this.uType,n.type),this.shader.setUniformF(this.uRadius,n.radius),this.shader.setUniformF(this.uStrength,n.strength)):this.shader.setUniformF(this.shader.getUniformLocation("uPointCount"),0),o.gl.drawBuffers([o.gl.COLOR_ATTACHMENT0])},e.prototype.finalizePass=function(t){t.unsetColorAttachment(0)},e.prototype.queueData=function(t){this.dataQueue.push(t)},e.NORMAL=.1,e.FLATTEN=16.1,e}(a.Pass);e.HeightBrushPass=u},function(t,e,n){"use strict";n.r(e),e.default="#version 300 es\nprecision highp float;\n\nout vec2 vCoords;\n\nvoid main(void) {\n\tfloat x = -1.0 + float((gl_VertexID & 1) << 2);\n\tfloat y = -1.0 + float((gl_VertexID & 2) << 1);\n\tvCoords.x = (x+1.0)*0.5;\n\tvCoords.y = (y+1.0)*0.5;\n\tgl_Position = vec4(x, y, 0, 1);\n}"},function(t,e){var n={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==n.call(t)}},function(t,e,n){"use strict";(function(e,r){var i=n(17);t.exports=y;var o,a=n(28);y.ReadableState=_;n(9).EventEmitter;var s=function(t,e){return t.listeners(e).length},u=n(30),l=n(18).Buffer,h=e.Uint8Array||function(){};var c=n(12);c.inherits=n(11);var f=n(61),d=void 0;d=f&&f.debuglog?f.debuglog("stream"):function(){};var g,p=n(62),v=n(31);c.inherits(y,u);var m=["error","close","destroy","pause","resume"];function _(t,e){t=t||{};var r=e instanceof(o=o||n(7));this.objectMode=!!t.objectMode,r&&(this.objectMode=this.objectMode||!!t.readableObjectMode);var i=t.highWaterMark,a=t.readableHighWaterMark,s=this.objectMode?16:16384;this.highWaterMark=i||0===i?i:r&&(a||0===a)?a:s,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new p,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(g||(g=n(32).StringDecoder),this.decoder=new g(t.encoding),this.encoding=t.encoding)}function y(t){if(o=o||n(7),!(this instanceof y))return new y(t);this._readableState=new _(t,this),this.readable=!0,t&&("function"==typeof t.read&&(this._read=t.read),"function"==typeof t.destroy&&(this._destroy=t.destroy)),u.call(this)}function b(t,e,n,r,i){var o,a=t._readableState;null===e?(a.reading=!1,function(t,e){if(e.ended)return;if(e.decoder){var n=e.decoder.end();n&&n.length&&(e.buffer.push(n),e.length+=e.objectMode?1:n.length)}e.ended=!0,E(t)}(t,a)):(i||(o=function(t,e){var n;r=e,l.isBuffer(r)||r instanceof h||"string"==typeof e||void 0===e||t.objectMode||(n=new TypeError("Invalid non-string/buffer chunk"));var r;return n}(a,e)),o?t.emit("error",o):a.objectMode||e&&e.length>0?("string"==typeof e||a.objectMode||Object.getPrototypeOf(e)===l.prototype||(e=function(t){return l.from(t)}(e)),r?a.endEmitted?t.emit("error",new Error("stream.unshift() after end event")):x(t,a,e,!0):a.ended?t.emit("error",new Error("stream.push() after EOF")):(a.reading=!1,a.decoder&&!n?(e=a.decoder.write(e),a.objectMode||0!==e.length?x(t,a,e,!1):S(t,a)):x(t,a,e,!1))):r||(a.reading=!1));return function(t){return!t.ended&&(t.needReadable||t.length<t.highWaterMark||0===t.length)}(a)}function x(t,e,n,r){e.flowing&&0===e.length&&!e.sync?(t.emit("data",n),t.read(0)):(e.length+=e.objectMode?1:n.length,r?e.buffer.unshift(n):e.buffer.push(n),e.needReadable&&E(t)),S(t,e)}Object.defineProperty(y.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(t){this._readableState&&(this._readableState.destroyed=t)}}),y.prototype.destroy=v.destroy,y.prototype._undestroy=v.undestroy,y.prototype._destroy=function(t,e){this.push(null),e(t)},y.prototype.push=function(t,e){var n,r=this._readableState;return r.objectMode?n=!0:"string"==typeof t&&((e=e||r.defaultEncoding)!==r.encoding&&(t=l.from(t,e),e=""),n=!0),b(this,t,e,!1,n)},y.prototype.unshift=function(t){return b(this,t,null,!0,!1)},y.prototype.isPaused=function(){return!1===this._readableState.flowing},y.prototype.setEncoding=function(t){return g||(g=n(32).StringDecoder),this._readableState.decoder=new g(t),this._readableState.encoding=t,this};var w=8388608;function T(t,e){return t<=0||0===e.length&&e.ended?0:e.objectMode?1:t!=t?e.flowing&&e.length?e.buffer.head.data.length:e.length:(t>e.highWaterMark&&(e.highWaterMark=function(t){return t>=w?t=w:(t--,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t++),t}(t)),t<=e.length?t:e.ended?e.length:(e.needReadable=!0,0))}function E(t){var e=t._readableState;e.needReadable=!1,e.emittedReadable||(d("emitReadable",e.flowing),e.emittedReadable=!0,e.sync?i.nextTick(M,t):M(t))}function M(t){d("emit readable"),t.emit("readable"),P(t)}function S(t,e){e.readingMore||(e.readingMore=!0,i.nextTick(L,t,e))}function L(t,e){for(var n=e.length;!e.reading&&!e.flowing&&!e.ended&&e.length<e.highWaterMark&&(d("maybeReadMore read 0"),t.read(0),n!==e.length);)n=e.length;e.readingMore=!1}function A(t){d("readable nexttick read 0"),t.read(0)}function R(t,e){e.reading||(d("resume read 0"),t.read(0)),e.resumeScheduled=!1,e.awaitDrain=0,t.emit("resume"),P(t),e.flowing&&!e.reading&&t.read(0)}function P(t){var e=t._readableState;for(d("flow",e.flowing);e.flowing&&null!==t.read(););}function C(t,e){return 0===e.length?null:(e.objectMode?n=e.buffer.shift():!t||t>=e.length?(n=e.decoder?e.buffer.join(""):1===e.buffer.length?e.buffer.head.data:e.buffer.concat(e.length),e.buffer.clear()):n=function(t,e,n){var r;t<e.head.data.length?(r=e.head.data.slice(0,t),e.head.data=e.head.data.slice(t)):r=t===e.head.data.length?e.shift():n?function(t,e){var n=e.head,r=1,i=n.data;t-=i.length;for(;n=n.next;){var o=n.data,a=t>o.length?o.length:t;if(a===o.length?i+=o:i+=o.slice(0,t),0===(t-=a)){a===o.length?(++r,n.next?e.head=n.next:e.head=e.tail=null):(e.head=n,n.data=o.slice(a));break}++r}return e.length-=r,i}(t,e):function(t,e){var n=l.allocUnsafe(t),r=e.head,i=1;r.data.copy(n),t-=r.data.length;for(;r=r.next;){var o=r.data,a=t>o.length?o.length:t;if(o.copy(n,n.length-t,0,a),0===(t-=a)){a===o.length?(++i,r.next?e.head=r.next:e.head=e.tail=null):(e.head=r,r.data=o.slice(a));break}++i}return e.length-=i,n}(t,e);return r}(t,e.buffer,e.decoder),n);var n}function I(t){var e=t._readableState;if(e.length>0)throw new Error('"endReadable()" called on non-empty stream');e.endEmitted||(e.ended=!0,i.nextTick(F,e,t))}function F(t,e){t.endEmitted||0!==t.length||(t.endEmitted=!0,e.readable=!1,e.emit("end"))}function k(t,e){for(var n=0,r=t.length;n<r;n++)if(t[n]===e)return n;return-1}y.prototype.read=function(t){d("read",t),t=parseInt(t,10);var e=this._readableState,n=t;if(0!==t&&(e.emittedReadable=!1),0===t&&e.needReadable&&(e.length>=e.highWaterMark||e.ended))return d("read: emitReadable",e.length,e.ended),0===e.length&&e.ended?I(this):E(this),null;if(0===(t=T(t,e))&&e.ended)return 0===e.length&&I(this),null;var r,i=e.needReadable;return d("need readable",i),(0===e.length||e.length-t<e.highWaterMark)&&d("length less than watermark",i=!0),e.ended||e.reading?d("reading or ended",i=!1):i&&(d("do read"),e.reading=!0,e.sync=!0,0===e.length&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1,e.reading||(t=T(n,e))),null===(r=t>0?C(t,e):null)?(e.needReadable=!0,t=0):e.length-=t,0===e.length&&(e.ended||(e.needReadable=!0),n!==t&&e.ended&&I(this)),null!==r&&this.emit("data",r),r},y.prototype._read=function(t){this.emit("error",new Error("_read() is not implemented"))},y.prototype.pipe=function(t,e){var n=this,o=this._readableState;switch(o.pipesCount){case 0:o.pipes=t;break;case 1:o.pipes=[o.pipes,t];break;default:o.pipes.push(t)}o.pipesCount+=1,d("pipe count=%d opts=%j",o.pipesCount,e);var u=(!e||!1!==e.end)&&t!==r.stdout&&t!==r.stderr?h:y;function l(e,r){d("onunpipe"),e===n&&r&&!1===r.hasUnpiped&&(r.hasUnpiped=!0,d("cleanup"),t.removeListener("close",m),t.removeListener("finish",_),t.removeListener("drain",c),t.removeListener("error",v),t.removeListener("unpipe",l),n.removeListener("end",h),n.removeListener("end",y),n.removeListener("data",p),f=!0,!o.awaitDrain||t._writableState&&!t._writableState.needDrain||c())}function h(){d("onend"),t.end()}o.endEmitted?i.nextTick(u):n.once("end",u),t.on("unpipe",l);var c=function(t){return function(){var e=t._readableState;d("pipeOnDrain",e.awaitDrain),e.awaitDrain&&e.awaitDrain--,0===e.awaitDrain&&s(t,"data")&&(e.flowing=!0,P(t))}}(n);t.on("drain",c);var f=!1;var g=!1;function p(e){d("ondata"),g=!1,!1!==t.write(e)||g||((1===o.pipesCount&&o.pipes===t||o.pipesCount>1&&-1!==k(o.pipes,t))&&!f&&(d("false write response, pause",n._readableState.awaitDrain),n._readableState.awaitDrain++,g=!0),n.pause())}function v(e){d("onerror",e),y(),t.removeListener("error",v),0===s(t,"error")&&t.emit("error",e)}function m(){t.removeListener("finish",_),y()}function _(){d("onfinish"),t.removeListener("close",m),y()}function y(){d("unpipe"),n.unpipe(t)}return n.on("data",p),function(t,e,n){if("function"==typeof t.prependListener)return t.prependListener(e,n);t._events&&t._events[e]?a(t._events[e])?t._events[e].unshift(n):t._events[e]=[n,t._events[e]]:t.on(e,n)}(t,"error",v),t.once("close",m),t.once("finish",_),t.emit("pipe",n),o.flowing||(d("pipe resume"),n.resume()),t},y.prototype.unpipe=function(t){var e=this._readableState,n={hasUnpiped:!1};if(0===e.pipesCount)return this;if(1===e.pipesCount)return t&&t!==e.pipes?this:(t||(t=e.pipes),e.pipes=null,e.pipesCount=0,e.flowing=!1,t&&t.emit("unpipe",this,n),this);if(!t){var r=e.pipes,i=e.pipesCount;e.pipes=null,e.pipesCount=0,e.flowing=!1;for(var o=0;o<i;o++)r[o].emit("unpipe",this,n);return this}var a=k(e.pipes,t);return-1===a?this:(e.pipes.splice(a,1),e.pipesCount-=1,1===e.pipesCount&&(e.pipes=e.pipes[0]),t.emit("unpipe",this,n),this)},y.prototype.on=function(t,e){var n=u.prototype.on.call(this,t,e);if("data"===t)!1!==this._readableState.flowing&&this.resume();else if("readable"===t){var r=this._readableState;r.endEmitted||r.readableListening||(r.readableListening=r.needReadable=!0,r.emittedReadable=!1,r.reading?r.length&&E(this):i.nextTick(A,this))}return n},y.prototype.addListener=y.prototype.on,y.prototype.resume=function(){var t=this._readableState;return t.flowing||(d("resume"),t.flowing=!0,function(t,e){e.resumeScheduled||(e.resumeScheduled=!0,i.nextTick(R,t,e))}(this,t)),this},y.prototype.pause=function(){return d("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(d("pause"),this._readableState.flowing=!1,this.emit("pause")),this},y.prototype.wrap=function(t){var e=this,n=this._readableState,r=!1;for(var i in t.on("end",(function(){if(d("wrapped end"),n.decoder&&!n.ended){var t=n.decoder.end();t&&t.length&&e.push(t)}e.push(null)})),t.on("data",(function(i){(d("wrapped data"),n.decoder&&(i=n.decoder.write(i)),n.objectMode&&null==i)||(n.objectMode||i&&i.length)&&(e.push(i)||(r=!0,t.pause()))})),t)void 0===this[i]&&"function"==typeof t[i]&&(this[i]=function(e){return function(){return t[e].apply(t,arguments)}}(i));for(var o=0;o<m.length;o++)t.on(m[o],this.emit.bind(this,m[o]));return this._read=function(e){d("wrapped _read",e),r&&(r=!1,t.resume())},this},Object.defineProperty(y.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),y._fromList=C}).call(this,n(6),n(3))},function(t,e,n){t.exports=n(9).EventEmitter},function(t,e,n){"use strict";var r=n(17);function i(t,e){t.emit("error",e)}t.exports={destroy:function(t,e){var n=this,o=this._readableState&&this._readableState.destroyed,a=this._writableState&&this._writableState.destroyed;return o||a?(e?e(t):!t||this._writableState&&this._writableState.errorEmitted||r.nextTick(i,this,t),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,(function(t){!e&&t?(r.nextTick(i,n,t),n._writableState&&(n._writableState.errorEmitted=!0)):e&&e(t)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}}},function(t,e,n){"use strict";var r=n(18).Buffer,i=r.isEncoding||function(t){switch((t=""+t)&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function o(t){var e;switch(this.encoding=function(t){var e=function(t){if(!t)return"utf8";for(var e;;)switch(t){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return t;default:if(e)return;t=(""+t).toLowerCase(),e=!0}}(t);if("string"!=typeof e&&(r.isEncoding===i||!i(t)))throw new Error("Unknown encoding: "+t);return e||t}(t),this.encoding){case"utf16le":this.text=u,this.end=l,e=4;break;case"utf8":this.fillLast=s,e=4;break;case"base64":this.text=h,this.end=c,e=3;break;default:return this.write=f,void(this.end=d)}this.lastNeed=0,this.lastTotal=0,this.lastChar=r.allocUnsafe(e)}function a(t){return t<=127?0:t>>5==6?2:t>>4==14?3:t>>3==30?4:t>>6==2?-1:-2}function s(t){var e=this.lastTotal-this.lastNeed,n=function(t,e,n){if(128!=(192&e[0]))return t.lastNeed=0,"�";if(t.lastNeed>1&&e.length>1){if(128!=(192&e[1]))return t.lastNeed=1,"�";if(t.lastNeed>2&&e.length>2&&128!=(192&e[2]))return t.lastNeed=2,"�"}}(this,t);return void 0!==n?n:this.lastNeed<=t.length?(t.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(t.copy(this.lastChar,e,0,t.length),void(this.lastNeed-=t.length))}function u(t,e){if((t.length-e)%2==0){var n=t.toString("utf16le",e);if(n){var r=n.charCodeAt(n.length-1);if(r>=55296&&r<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1],n.slice(0,-1)}return n}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=t[t.length-1],t.toString("utf16le",e,t.length-1)}function l(t){var e=t&&t.length?this.write(t):"";if(this.lastNeed){var n=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,n)}return e}function h(t,e){var n=(t.length-e)%3;return 0===n?t.toString("base64",e):(this.lastNeed=3-n,this.lastTotal=3,1===n?this.lastChar[0]=t[t.length-1]:(this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1]),t.toString("base64",e,t.length-n))}function c(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function f(t){return t.toString(this.encoding)}function d(t){return t&&t.length?this.write(t):""}e.StringDecoder=o,o.prototype.write=function(t){if(0===t.length)return"";var e,n;if(this.lastNeed){if(void 0===(e=this.fillLast(t)))return"";n=this.lastNeed,this.lastNeed=0}else n=0;return n<t.length?e?e+this.text(t,n):this.text(t,n):e||""},o.prototype.end=function(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+"�":e},o.prototype.text=function(t,e){var n=function(t,e,n){var r=e.length-1;if(r<n)return 0;var i=a(e[r]);if(i>=0)return i>0&&(t.lastNeed=i-1),i;if(--r<n||-2===i)return 0;if((i=a(e[r]))>=0)return i>0&&(t.lastNeed=i-2),i;if(--r<n||-2===i)return 0;if((i=a(e[r]))>=0)return i>0&&(2===i?i=0:t.lastNeed=i-3),i;return 0}(this,t,e);if(!this.lastNeed)return t.toString("utf8",e);this.lastTotal=n;var r=t.length-(n-this.lastNeed);return t.copy(this.lastChar,0,r),t.toString("utf8",e,r)},o.prototype.fillLast=function(t){if(this.lastNeed<=t.length)return t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,t.length),this.lastNeed-=t.length}},function(t,e,n){"use strict";t.exports=a;var r=n(7),i=n(12);function o(t,e){var n=this._transformState;n.transforming=!1;var r=n.writecb;if(!r)return this.emit("error",new Error("write callback called multiple times"));n.writechunk=null,n.writecb=null,null!=e&&this.push(e),r(t);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function a(t){if(!(this instanceof a))return new a(t);r.call(this,t),this._transformState={afterTransform:o.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,t&&("function"==typeof t.transform&&(this._transform=t.transform),"function"==typeof t.flush&&(this._flush=t.flush)),this.on("prefinish",s)}function s(){var t=this;"function"==typeof this._flush?this._flush((function(e,n){u(t,e,n)})):u(this,null,null)}function u(t,e,n){if(e)return t.emit("error",e);if(null!=n&&t.push(n),t._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(t._transformState.transforming)throw new Error("Calling transform done when still transforming");return t.push(null)}i.inherits=n(11),i.inherits(a,r),a.prototype.push=function(t,e){return this._transformState.needTransform=!1,r.prototype.push.call(this,t,e)},a.prototype._transform=function(t,e,n){throw new Error("_transform() is not implemented")},a.prototype._write=function(t,e,n){var r=this._transformState;if(r.writecb=n,r.writechunk=t,r.writeencoding=e,!r.transforming){var i=this._readableState;(r.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},a.prototype._read=function(t){var e=this._transformState;null!==e.writechunk&&e.writecb&&!e.transforming?(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform)):e.needTransform=!0},a.prototype._destroy=function(t,e){var n=this;r.prototype._destroy.call(this,t,(function(t){e(t),n.emit("close")}))}},function(t,e,n){"use strict";t.exports=function(t,e,n,r){for(var i=65535&t|0,o=t>>>16&65535|0,a=0;0!==n;){n-=a=n>2e3?2e3:n;do{o=o+(i=i+e[r++]|0)|0}while(--a);i%=65521,o%=65521}return i|o<<16|0}},function(t,e,n){"use strict";var r=function(){for(var t,e=[],n=0;n<256;n++){t=n;for(var r=0;r<8;r++)t=1&t?3988292384^t>>>1:t>>>1;e[n]=t}return e}();t.exports=function(t,e,n,i){var o=r,a=i+n;t^=-1;for(var s=i;s<a;s++)t=t>>>8^o[255&(t^e[s])];return-1^t}},function(t,e,n){"use strict";(function(e,r){var i=n(5),o=n(16),a=t.exports=function(){o.call(this),this._buffers=[],this._buffered=0,this._reads=[],this._paused=!1,this._encoding="utf8",this.writable=!0};i.inherits(a,o),a.prototype.read=function(t,n){this._reads.push({length:Math.abs(t),allowLess:t<0,func:n}),e.nextTick(function(){this._process(),this._paused&&this._reads.length>0&&(this._paused=!1,this.emit("drain"))}.bind(this))},a.prototype.write=function(t,e){return this.writable?(n=r.isBuffer(t)?t:new r(t,e||this._encoding),this._buffers.push(n),this._buffered+=n.length,this._process(),this._reads&&0===this._reads.length&&(this._paused=!0),this.writable&&!this._paused):(this.emit("error",new Error("Stream not writable")),!1);var n},a.prototype.end=function(t,e){t&&this.write(t,e),this.writable=!1,this._buffers&&(0===this._buffers.length?this._end():(this._buffers.push(null),this._process()))},a.prototype.destroySoon=a.prototype.end,a.prototype._end=function(){this._reads.length>0&&this.emit("error",new Error("Unexpected end of input")),this.destroy()},a.prototype.destroy=function(){this._buffers&&(this.writable=!1,this._reads=null,this._buffers=null,this.emit("close"))},a.prototype._processReadAllowingLess=function(t){this._reads.shift();var e=this._buffers[0];e.length>t.length?(this._buffered-=t.length,this._buffers[0]=e.slice(t.length),t.func.call(this,e.slice(0,t.length))):(this._buffered-=e.length,this._buffers.shift(),t.func.call(this,e))},a.prototype._processRead=function(t){this._reads.shift();for(var e=0,n=0,i=new r(t.length);e<t.length;){var o=this._buffers[n++],a=Math.min(o.length,t.length-e);o.copy(i,e,0,a),e+=a,a!==o.length&&(this._buffers[--n]=o.slice(a))}n>0&&this._buffers.splice(0,n),this._buffered-=t.length,t.func.call(this,i)},a.prototype._process=function(){try{for(;this._buffered>0&&this._reads&&this._reads.length>0;){var t=this._reads[0];if(t.allowLess)this._processReadAllowingLess(t);else{if(!(this._buffered>=t.length))break;this._processRead(t)}}this._buffers&&!this.writable&&this._end()}catch(t){this.emit("error",t)}}}).call(this,n(3),n(1).Buffer)},function(t,e,n){"use strict";(function(e){var r=n(38),i=n(39);function o(t,e,n){var r=t*e;return 8!==n&&(r=Math.ceil(r/(8/n))),r}var a=t.exports=function(t,e){var n=t.width,i=t.height,a=t.interlace,s=t.bpp,u=t.depth;if(this.read=e.read,this.write=e.write,this.complete=e.complete,this._imageIndex=0,this._images=[],a)for(var l=r.getImagePasses(n,i),h=0;h<l.length;h++)this._images.push({byteWidth:o(l[h].width,s,u),height:l[h].height,lineIndex:0});else this._images.push({byteWidth:o(n,s,u),height:i,lineIndex:0});this._xComparison=8===u?s:16===u?2*s:1};a.prototype.start=function(){this.read(this._images[this._imageIndex].byteWidth+1,this._reverseFilterLine.bind(this))},a.prototype._unFilterType1=function(t,e,n){for(var r=this._xComparison,i=r-1,o=0;o<n;o++){var a=t[1+o],s=o>i?e[o-r]:0;e[o]=a+s}},a.prototype._unFilterType2=function(t,e,n){for(var r=this._lastLine,i=0;i<n;i++){var o=t[1+i],a=r?r[i]:0;e[i]=o+a}},a.prototype._unFilterType3=function(t,e,n){for(var r=this._xComparison,i=r-1,o=this._lastLine,a=0;a<n;a++){var s=t[1+a],u=o?o[a]:0,l=a>i?e[a-r]:0,h=Math.floor((l+u)/2);e[a]=s+h}},a.prototype._unFilterType4=function(t,e,n){for(var r=this._xComparison,o=r-1,a=this._lastLine,s=0;s<n;s++){var u=t[1+s],l=a?a[s]:0,h=s>o?e[s-r]:0,c=s>o&&a?a[s-r]:0,f=i(h,l,c);e[s]=u+f}},a.prototype._reverseFilterLine=function(t){var n,r=t[0],i=this._images[this._imageIndex],o=i.byteWidth;if(0===r)n=t.slice(1,o+1);else switch(n=new e(o),r){case 1:this._unFilterType1(t,n,o);break;case 2:this._unFilterType2(t,n,o);break;case 3:this._unFilterType3(t,n,o);break;case 4:this._unFilterType4(t,n,o);break;default:throw new Error("Unrecognised filter type - "+r)}this.write(n),i.lineIndex++,i.lineIndex>=i.height?(this._lastLine=null,this._imageIndex++,i=this._images[this._imageIndex]):this._lastLine=n,i?this.read(i.byteWidth+1,this._reverseFilterLine.bind(this)):(this._lastLine=null,this.complete())}}).call(this,n(1).Buffer)},function(t,e,n){"use strict";var r=[{x:[0],y:[0]},{x:[4],y:[0]},{x:[0,4],y:[4]},{x:[2,6],y:[0,4]},{x:[0,2,4,6],y:[2,6]},{x:[1,3,5,7],y:[0,2,4,6]},{x:[0,1,2,3,4,5,6,7],y:[1,3,5,7]}];e.getImagePasses=function(t,e){for(var n=[],i=t%8,o=e%8,a=(t-i)/8,s=(e-o)/8,u=0;u<r.length;u++){for(var l=r[u],h=a*l.x.length,c=s*l.y.length,f=0;f<l.x.length&&l.x[f]<i;f++)h++;for(f=0;f<l.y.length&&l.y[f]<o;f++)c++;h>0&&c>0&&n.push({width:h,height:c,index:u})}return n},e.getInterlaceIterator=function(t){return function(e,n,i){var o=e%r[i].x.length,a=(e-o)/r[i].x.length*8+r[i].x[o],s=n%r[i].y.length;return 4*a+((n-s)/r[i].y.length*8+r[i].y[s])*t*4}}},function(t,e,n){"use strict";t.exports=function(t,e,n){var r=t+e-n,i=Math.abs(r-t),o=Math.abs(r-e),a=Math.abs(r-n);return i<=o&&i<=a?t:o<=a?e:n}},function(t,e,n){"use strict";(function(e){var r=n(14),i=n(41),o=t.exports=function(t,e){this._options=t,t.checkCRC=!1!==t.checkCRC,this._hasIHDR=!1,this._hasIEND=!1,this._emittedHeadersFinished=!1,this._palette=[],this._colorType=0,this._chunks={},this._chunks[r.TYPE_IHDR]=this._handleIHDR.bind(this),this._chunks[r.TYPE_IEND]=this._handleIEND.bind(this),this._chunks[r.TYPE_IDAT]=this._handleIDAT.bind(this),this._chunks[r.TYPE_PLTE]=this._handlePLTE.bind(this),this._chunks[r.TYPE_tRNS]=this._handleTRNS.bind(this),this._chunks[r.TYPE_gAMA]=this._handleGAMA.bind(this),this.read=e.read,this.error=e.error,this.metadata=e.metadata,this.gamma=e.gamma,this.transColor=e.transColor,this.palette=e.palette,this.parsed=e.parsed,this.inflateData=e.inflateData,this.finished=e.finished,this.simpleTransparency=e.simpleTransparency,this.headersFinished=e.headersFinished||function(){}};o.prototype.start=function(){this.read(r.PNG_SIGNATURE.length,this._parseSignature.bind(this))},o.prototype._parseSignature=function(t){for(var e=r.PNG_SIGNATURE,n=0;n<e.length;n++)if(t[n]!==e[n])return void this.error(new Error("Invalid file signature"));this.read(8,this._parseChunkBegin.bind(this))},o.prototype._parseChunkBegin=function(t){for(var n=t.readUInt32BE(0),o=t.readUInt32BE(4),a="",s=4;s<8;s++)a+=String.fromCharCode(t[s]);var u=Boolean(32&t[4]);if(this._hasIHDR||o===r.TYPE_IHDR){if(this._crc=new i,this._crc.write(new e(a)),this._chunks[o])return this._chunks[o](n);u?this.read(n+4,this._skipChunk.bind(this)):this.error(new Error("Unsupported critical chunk type "+a))}else this.error(new Error("Expected IHDR on beggining"))},o.prototype._skipChunk=function(){this.read(8,this._parseChunkBegin.bind(this))},o.prototype._handleChunkEnd=function(){this.read(4,this._parseChunkEnd.bind(this))},o.prototype._parseChunkEnd=function(t){var e=t.readInt32BE(0),n=this._crc.crc32();this._options.checkCRC&&n!==e?this.error(new Error("Crc error - "+e+" - "+n)):this._hasIEND||this.read(8,this._parseChunkBegin.bind(this))},o.prototype._handleIHDR=function(t){this.read(t,this._parseIHDR.bind(this))},o.prototype._parseIHDR=function(t){this._crc.write(t);var e=t.readUInt32BE(0),n=t.readUInt32BE(4),i=t[8],o=t[9],a=t[10],s=t[11],u=t[12];if(8===i||4===i||2===i||1===i||16===i)if(o in r.COLORTYPE_TO_BPP_MAP)if(0===a)if(0===s)if(0===u||1===u){this._colorType=o;var l=r.COLORTYPE_TO_BPP_MAP[this._colorType];this._hasIHDR=!0,this.metadata({width:e,height:n,depth:i,interlace:Boolean(u),palette:Boolean(o&r.COLORTYPE_PALETTE),color:Boolean(o&r.COLORTYPE_COLOR),alpha:Boolean(o&r.COLORTYPE_ALPHA),bpp:l,colorType:o}),this._handleChunkEnd()}else this.error(new Error("Unsupported interlace method"));else this.error(new Error("Unsupported filter method"));else this.error(new Error("Unsupported compression method"));else this.error(new Error("Unsupported color type"));else this.error(new Error("Unsupported bit depth "+i))},o.prototype._handlePLTE=function(t){this.read(t,this._parsePLTE.bind(this))},o.prototype._parsePLTE=function(t){this._crc.write(t);for(var e=Math.floor(t.length/3),n=0;n<e;n++)this._palette.push([t[3*n],t[3*n+1],t[3*n+2],255]);this.palette(this._palette),this._handleChunkEnd()},o.prototype._handleTRNS=function(t){this.simpleTransparency(),this.read(t,this._parseTRNS.bind(this))},o.prototype._parseTRNS=function(t){if(this._crc.write(t),this._colorType===r.COLORTYPE_PALETTE_COLOR){if(0===this._palette.length)return void this.error(new Error("Transparency chunk must be after palette"));if(t.length>this._palette.length)return void this.error(new Error("More transparent colors than palette size"));for(var e=0;e<t.length;e++)this._palette[e][3]=t[e];this.palette(this._palette)}this._colorType===r.COLORTYPE_GRAYSCALE&&this.transColor([t.readUInt16BE(0)]),this._colorType===r.COLORTYPE_COLOR&&this.transColor([t.readUInt16BE(0),t.readUInt16BE(2),t.readUInt16BE(4)]),this._handleChunkEnd()},o.prototype._handleGAMA=function(t){this.read(t,this._parseGAMA.bind(this))},o.prototype._parseGAMA=function(t){this._crc.write(t),this.gamma(t.readUInt32BE(0)/r.GAMMA_DIVISION),this._handleChunkEnd()},o.prototype._handleIDAT=function(t){this._emittedHeadersFinished||(this._emittedHeadersFinished=!0,this.headersFinished()),this.read(-t,this._parseIDAT.bind(this,t))},o.prototype._parseIDAT=function(t,e){if(this._crc.write(e),this._colorType===r.COLORTYPE_PALETTE_COLOR&&0===this._palette.length)throw new Error("Expected palette not found");this.inflateData(e);var n=t-e.length;n>0?this._handleIDAT(n):this._handleChunkEnd()},o.prototype._handleIEND=function(t){this.read(t,this._parseIEND.bind(this))},o.prototype._parseIEND=function(t){this._crc.write(t),this._hasIEND=!0,this._handleChunkEnd(),this.finished&&this.finished()}}).call(this,n(1).Buffer)},function(t,e,n){"use strict";var r=[];!function(){for(var t=0;t<256;t++){for(var e=t,n=0;n<8;n++)1&e?e=3988292384^e>>>1:e>>>=1;r[t]=e}}();var i=t.exports=function(){this._crc=-1};i.prototype.write=function(t){for(var e=0;e<t.length;e++)this._crc=r[255&(this._crc^t[e])]^this._crc>>>8;return!0},i.prototype.crc32=function(){return-1^this._crc},i.crc32=function(t){for(var e=-1,n=0;n<t.length;n++)e=r[255&(e^t[n])]^e>>>8;return-1^e}},function(t,e,n){"use strict";(function(t){var r=n(38),i=[function(){},function(t,e,n,r){if(r===e.length)throw new Error("Ran out of data");var i=e[r];t[n]=i,t[n+1]=i,t[n+2]=i,t[n+3]=255},function(t,e,n,r){if(r+1>=e.length)throw new Error("Ran out of data");var i=e[r];t[n]=i,t[n+1]=i,t[n+2]=i,t[n+3]=e[r+1]},function(t,e,n,r){if(r+2>=e.length)throw new Error("Ran out of data");t[n]=e[r],t[n+1]=e[r+1],t[n+2]=e[r+2],t[n+3]=255},function(t,e,n,r){if(r+3>=e.length)throw new Error("Ran out of data");t[n]=e[r],t[n+1]=e[r+1],t[n+2]=e[r+2],t[n+3]=e[r+3]}],o=[function(){},function(t,e,n,r){var i=e[0];t[n]=i,t[n+1]=i,t[n+2]=i,t[n+3]=r},function(t,e,n){var r=e[0];t[n]=r,t[n+1]=r,t[n+2]=r,t[n+3]=e[1]},function(t,e,n,r){t[n]=e[0],t[n+1]=e[1],t[n+2]=e[2],t[n+3]=r},function(t,e,n){t[n]=e[0],t[n+1]=e[1],t[n+2]=e[2],t[n+3]=e[3]}];function a(t,e,n,r,o,a){for(var s=t.width,u=t.height,l=t.index,h=0;h<u;h++)for(var c=0;c<s;c++){var f=n(c,h,l);i[r](e,o,f,a),a+=r}return a}function s(t,e,n,r,i,a){for(var s=t.width,u=t.height,l=t.index,h=0;h<u;h++){for(var c=0;c<s;c++){var f=i.get(r),d=n(c,h,l);o[r](e,f,d,a)}i.resetAfterLine()}}e.dataToBitMap=function(e,n){var i,o=n.width,u=n.height,l=n.depth,h=n.bpp,c=n.interlace;if(8!==l)var f=function(t,e){var n=[],r=0;function i(){if(r===t.length)throw new Error("Ran out of data");var i,o,a,s,u,l,h,c,f=t[r];switch(r++,e){default:throw new Error("unrecognised depth");case 16:h=t[r],r++,n.push((f<<8)+h);break;case 4:h=15&f,c=f>>4,n.push(c,h);break;case 2:u=3&f,l=f>>2&3,h=f>>4&3,c=f>>6&3,n.push(c,h,l,u);break;case 1:i=1&f,o=f>>1&1,a=f>>2&1,s=f>>3&1,u=f>>4&1,l=f>>5&1,h=f>>6&1,c=f>>7&1,n.push(c,h,l,u,s,a,o,i)}}return{get:function(t){for(;n.length<t;)i();var e=n.slice(0,t);return n=n.slice(t),e},resetAfterLine:function(){n.length=0},end:function(){if(r!==t.length)throw new Error("extra data found")}}}(e,l);i=l<=8?new t(o*u*4):new Uint16Array(o*u*4);var d,g,p=Math.pow(2,l)-1,v=0;if(c)d=r.getImagePasses(o,u),g=r.getInterlaceIterator(o,u);else{var m=0;g=function(){var t=m;return m+=4,t},d=[{width:o,height:u}]}for(var _=0;_<d.length;_++)8===l?v=a(d[_],i,g,h,e,v):s(d[_],i,g,h,f,p);if(8===l){if(v!==e.length)throw new Error("extra data found")}else f.end();return i}}).call(this,n(1).Buffer)},function(t,e,n){"use strict";(function(e){t.exports=function(t,n){var r=n.depth,i=n.width,o=n.height,a=n.colorType,s=n.transColor,u=n.palette,l=t;return 3===a?function(t,e,n,r,i){for(var o=0,a=0;a<r;a++)for(var s=0;s<n;s++){var u=i[t[o]];if(!u)throw new Error("index "+t[o]+" not in palette");for(var l=0;l<4;l++)e[o+l]=u[l];o+=4}}(t,l,i,o,u):(s&&function(t,e,n,r,i){for(var o=0,a=0;a<r;a++)for(var s=0;s<n;s++){var u=!1;if(1===i.length?i[0]===t[o]&&(u=!0):i[0]===t[o]&&i[1]===t[o+1]&&i[2]===t[o+2]&&(u=!0),u)for(var l=0;l<4;l++)e[o+l]=0;o+=4}}(t,l,i,o,s),8!==r&&(16===r&&(l=new e(i*o*4)),function(t,e,n,r,i){for(var o=Math.pow(2,i)-1,a=0,s=0;s<r;s++)for(var u=0;u<n;u++){for(var l=0;l<4;l++)e[a+l]=Math.floor(255*t[a+l]/o+.5);a+=4}}(t,l,i,o,r))),l}}).call(this,n(1).Buffer)},function(t,e,n){"use strict";(function(e){var r=n(14),i=n(41),o=n(85),a=n(86),s=n(13),u=t.exports=function(t){if(this._options=t,t.deflateChunkSize=t.deflateChunkSize||32768,t.deflateLevel=null!=t.deflateLevel?t.deflateLevel:9,t.deflateStrategy=null!=t.deflateStrategy?t.deflateStrategy:3,t.inputHasAlpha=null==t.inputHasAlpha||t.inputHasAlpha,t.deflateFactory=t.deflateFactory||s.createDeflate,t.bitDepth=t.bitDepth||8,t.colorType="number"==typeof t.colorType?t.colorType:r.COLORTYPE_COLOR_ALPHA,t.inputColorType="number"==typeof t.inputColorType?t.inputColorType:r.COLORTYPE_COLOR_ALPHA,-1===[r.COLORTYPE_GRAYSCALE,r.COLORTYPE_COLOR,r.COLORTYPE_COLOR_ALPHA,r.COLORTYPE_ALPHA].indexOf(t.colorType))throw new Error("option color type:"+t.colorType+" is not supported at present");if(-1===[r.COLORTYPE_GRAYSCALE,r.COLORTYPE_COLOR,r.COLORTYPE_COLOR_ALPHA,r.COLORTYPE_ALPHA].indexOf(t.inputColorType))throw new Error("option input color type:"+t.inputColorType+" is not supported at present");if(8!==t.bitDepth&&16!==t.bitDepth)throw new Error("option bit depth:"+t.bitDepth+" is not supported at present")};u.prototype.getDeflateOptions=function(){return{chunkSize:this._options.deflateChunkSize,level:this._options.deflateLevel,strategy:this._options.deflateStrategy}},u.prototype.createDeflate=function(){return this._options.deflateFactory(this.getDeflateOptions())},u.prototype.filterData=function(t,e,n){var i=o(t,e,n,this._options),s=r.COLORTYPE_TO_BPP_MAP[this._options.colorType];return a(i,e,n,this._options,s)},u.prototype._packChunk=function(t,n){var r=n?n.length:0,o=new e(r+12);return o.writeUInt32BE(r,0),o.writeUInt32BE(t,4),n&&n.copy(o,8),o.writeInt32BE(i.crc32(o.slice(4,o.length-4)),o.length-4),o},u.prototype.packGAMA=function(t){var n=new e(4);return n.writeUInt32BE(Math.floor(t*r.GAMMA_DIVISION),0),this._packChunk(r.TYPE_gAMA,n)},u.prototype.packIHDR=function(t,n){var i=new e(13);return i.writeUInt32BE(t,0),i.writeUInt32BE(n,4),i[8]=this._options.bitDepth,i[9]=this._options.colorType,i[10]=0,i[11]=0,i[12]=0,this._packChunk(r.TYPE_IHDR,i)},u.prototype.packIDAT=function(t){return this._packChunk(r.TYPE_IDAT,t)},u.prototype.packIEND=function(){return this._packChunk(r.TYPE_IEND,null)}}).call(this,n(1).Buffer)},function(t,e,n){"use strict";var r=t.exports=function(t){this._buffer=t,this._reads=[]};r.prototype.read=function(t,e){this._reads.push({length:Math.abs(t),allowLess:t<0,func:e})},r.prototype.process=function(){for(;this._reads.length>0&&this._buffer.length;){var t=this._reads[0];if(!this._buffer.length||!(this._buffer.length>=t.length||t.allowLess))break;this._reads.shift();var e=this._buffer;this._buffer=e.slice(t.length),t.func.call(this,e.slice(0,t.length))}return this._reads.length>0?new Error("There are some read requests waitng on finished stream"):this._buffer.length>0?new Error("unrecognised content at end of stream"):void 0}},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});e.__esModule=!0;var o=n(9),a=n(92),s=n(15),u=n(47),l=n(93),h=n(94),c=new(function(t){function e(){var e=t.call(this)||this;e.canvas=document.getElementById("canvas"),e.menu=document.getElementById("menu"),e.menuItems=document.querySelectorAll("#menu .menu-item"),e.layerList=document.querySelector("#layers-window .sortable"),e.layerListTemplate=document.querySelector("#layers-window template"),e.radiusInput=document.getElementById("radius-input"),e.strengthInput=document.getElementById("strength-input"),e.radiusOutput=document.getElementById("radius-output"),e.strengthOutput=document.getElementById("strength-output"),e.minSlopeInput=document.getElementById("min-slope-input"),e.maxSlopeInput=document.getElementById("max-slope-input"),e.smartLayerBrushInput=document.getElementById("smart-layer-brush-input"),e.windows=document.querySelectorAll(".window"),e.brushWindow=document.getElementById("brush-window"),e.brushWindowTitle=document.querySelector("#brush-window .title"),e.layersWindow=document.getElementById("layers-window"),e.layerEditWindow=document.getElementById("layer-edit-window"),e.settingsWindow=document.getElementById("settings-window"),e.sunPitch=document.getElementById("sun-pitch"),e.sunYaw=document.getElementById("sun-yaw"),e.generationWindow=document.getElementById("generation-window"),e.layerBrushTypeSelector=new h.default("#layer-type-selector","div"),e.layerBrushOptions=document.getElementById("layer-brush-options"),e.brushTypeSelector=document.getElementById("brush-type-selector"),e.brushTypeSelectorButtons=document.querySelectorAll("#brush-type-selector img"),e.debugMenu=document.getElementById("debug-menu"),e.debugCheckbox=document.getElementById("debug-mode-input"),e.cameraModeCheckbox=document.getElementById("camera-mode-input"),e.flattenBrushSelector=new h.default("#flatten-brush-selector"),e.decorationBrushSelector=new h.default("#decoration-brush-selector"),e.filePicker=document.getElementById("file-picker"),e.initInputs=document.querySelectorAll("#init-window input"),e.initSelects=document.querySelectorAll("#init-window select"),e.wheelEnabled=!0,e.generationToolsWarningDisplayed=!1,document.querySelector("#debugButton0").onclick=e.emit.bind(e,"debug0"),document.querySelector("#debugButton1").onclick=e.emit.bind(e,"debug1"),document.querySelector("#debugButton2").onclick=e.emit.bind(e,"debug2"),document.querySelector("#debugButton3").onclick=e.emit.bind(e,"debug3"),document.querySelector("#debugButton4").onclick=e.emit.bind(e,"debug4"),document.querySelector("#debugButton5").onclick=e.emit.bind(e,"debug5");var n=u.default.getInitData();e.initSelects[0].value=n.size.toString(),e.initInputs[0].value=n.scale.toString(),e.initInputs[1].value=n.maxHeight.toString(),e.initInputs[2].value=n.minHeight.toString(),document.querySelector("#init-button").onclick=function(){var t={size:parseFloat(e.initSelects[0].value),scale:parseFloat(e.initInputs[0].value),maxHeight:parseFloat(e.initInputs[1].value),minHeight:parseFloat(e.initInputs[2].value)};u.default.setInitData(t),e.emit("init",t)},e.radiusInput.oninput=function(){e.radiusOutput.value=e.radiusInput.value,e.emit("radius-changed",parseFloat(e.radiusInput.value))},e.strengthInput.oninput=function(){e.strengthOutput.value=e.strengthInput.value,e.emit("strength-changed",parseFloat(e.strengthInput.value))},e.minSlopeInput.oninput=function(){e.emit("min-slope-changed",parseFloat(e.minSlopeInput.value))},e.maxSlopeInput.oninput=function(){e.emit("max-slope-changed",parseFloat(e.maxSlopeInput.value))},e.smartLayerBrushInput.checked=!1,e.smartLayerBrushInput.onchange=function(t){var n=t.target.checked;e.emit("smart-layer-state-changed",n),e.minSlopeInput.disabled=n,e.maxSlopeInput.disabled=n,e.layerBrushTypeSelector.hide(n)},e.sunYaw.oninput=e.sunPitch.oninput=function(){e.emit("sun-changed",parseFloat(e.sunPitch.value),parseFloat(e.sunYaw.value))};var r=0;return e.menuItems.forEach((function(t){var n=r++;t.onclick=function(){e.selectMenuIndex(n)}})),r=0,e.brushTypeSelectorButtons.forEach((function(t){var n=r++;t.onclick=function(){e.selectBrushType(n)}})),a.default(e.layerList,{handle:".anchor"}),a.default(e.layerList)[0].addEventListener("sortupdate",(function(t){for(var n=[],r=0;r<e.layerList.children.length;++r){var i=e.layerList.children[r],o=parseInt(i.getAttribute("layerId")||"0");n.push(o)}e.emit("layer-order-changed",n)})),e.debugCheckbox.checked=u.default.getDebugMode(),s.hide(e.debugMenu,!u.default.getDebugMode()),e.debugCheckbox.onchange=function(){u.default.setDebugMode(e.debugCheckbox.checked),s.hide(e.debugMenu,!e.debugCheckbox.checked)},e.cameraModeCheckbox.checked=u.default.getCameraMode(),e.cameraModeCheckbox.onchange=function(){u.default.setCameraMode(e.cameraModeCheckbox.checked),e.emit("camera-mode-changed",e.cameraModeCheckbox.checked)},e.flattenBrushSelector.on("change",(function(t){e.emit("flatten-brush-type-changed",t)})),e.decorationBrushSelector.on("change",(function(t){e.emit("decoration-brush-type-changed",t)})),e.layerBrushTypeSelector.on("change",(function(t){e.emit("layer-type-selected",t)})),e.canvas.addEventListener("wheel",(function(t){if(e.wheelEnabled){var n=parseFloat(e.radiusInput.value)-10*Math.sign(t.deltaY);e.radiusInput.value=""+n,e.radiusInput.oninput()}})),document.querySelectorAll("#export-box button").forEach((function(t,n){t.onclick=e.emit.bind(e,"export",n)})),document.getElementById("save-button").onclick=e.emit.bind(e,"save"),document.getElementById("load-button").onclick=function(){e.filePicker.click()},e.filePicker.oninput=function(){e.filePicker.files&&e.filePicker.files.length>=1&&e.emit("file-opened",e.filePicker.files[0])},document.getElementById("layer-generation-button").onclick=function(){e.emit("layer-generation")},document.getElementById("seed-generation-button").onclick=function(){var t=document.getElementById("seed-input").value;e.emit("seed-generation",t)},e}return i(e,t),e.prototype.selectMenuIndex=function(t){var e=this;t>=0&&(this.menuItems.forEach((function(t){return t.removeAttribute("selected")})),this.menuItems[t].setAttribute("selected","true")),s.hide(this.menu,t<0);var n=t<0?"none":this.menuItems[t].getAttribute("route");switch(s.hide(this.brushWindow,!0),s.hide(this.layersWindow,!0),s.hide(this.settingsWindow,!0),s.hide(this.generationWindow,!0),n){case"increase-brush":case"decrease-brush":case"flatten-brush":case"layer-brush":case"decoration-brush":case"erosion-brush":this.brushWindow.classList.add("slide-out"),setTimeout((function(){s.hide(e.brushWindow,!1),s.hide(e.brushTypeSelector,"increase-brush"!==n&&"decrease-brush"!==n),e.layerBrushTypeSelector.hide("layer-brush"!==n||e.smartLayerBrushInput.checked),s.hide(e.layerBrushOptions,"layer-brush"!==n),e.flattenBrushSelector.hide("flatten-brush"!==n),e.decorationBrushSelector.hide("decoration-brush"!==n),e.brushWindowTitle.innerText=e.menuItems[t].getAttribute("title")||"";var r=e.menuItems[t].offsetTop;e.updateBrushWindowSizeAndPos(r),e.brushWindow.classList.remove("slide-out")}),100);break;case"layers":s.hide(this.layersWindow,!1);break;case"settings":s.hide(this.settingsWindow,!1);break;case"generation-tools":this.generationToolsWarningDisplayed||(l.showAlert("Be cautious. These Tools will override the complete heightmap.",0),this.generationToolsWarningDisplayed=!0),s.hide(this.generationWindow,!1)}this.emit("menu-selected",n)},e.prototype.updateBrushWindowSizeAndPos=function(t){if(void 0===t&&(t=this.brushWindow.offsetTop),this.brushWindow.offsetParent){var e=this.brushWindow.offsetParent.clientHeight;this.brushWindow.style.maxHeight=Math.floor(.9*e)+"px",t=Math.min(t,e-this.brushWindow.clientHeight-6),this.brushWindow.style.top=t+"px"}},e.prototype.setupLayerList=function(t){for(var e=this,n=function(n){var i=r.layerListTemplate.content.querySelector("div").cloneNode(!0),o=t.getLayerMaterial(n);i.querySelector(".title").innerText="Layer "+n;var a=i.querySelector(".color-input"),u=i.querySelector(".roughness-input"),l=i.querySelector(".enable-button"),h=i.querySelector(".disable-button"),c=function(){var t=s.hex2color(a.value),r=parseFloat(u.value)||0,o=!i.hasAttribute("disabled");e.emit("layer-changed",n,t,r,o)},f=function(t){t?i.removeAttribute("disabled"):i.setAttribute("disabled","1"),a.disabled=!t,u.disabled=!t};a.value=s.color2hex(o.getColor()),u.value=o.getRoughness().toString(),a.oninput=c,u.oninput=c,f(t.getLayerActive(n)),l.onclick=function(){f(!0),c()},h.onclick=function(){f(!1),c()},i.setAttribute("layerId",n.toString()),r.layerList.appendChild(i)},r=this,i=0;i<8;++i)n(i);a.default(this.layerList,"reload")},e.prototype.updateLayerBrushTypeSelector=function(t){for(var e=this.layerBrushTypeSelector.getChildren(),n=0;n<e.length;++n){var r=t.layerOrder[n],i=e[n].getElementsByTagName("span");i[0].style.backgroundColor=s.color2hex(t.getLayerMaterial(r).getColor()),i[1].innerText="Layer "+r,s.hide(e[n],!t.getLayerActive(r))}this.layerBrushTypeSelector.select(0)},e.prototype.selectBrushType=function(t){this.brushTypeSelectorButtons.forEach((function(t){return t.removeAttribute("selected")})),this.brushTypeSelectorButtons[t].setAttribute("selected","true"),this.emit("brush-type-selected",t)},e.prototype.setExportFileInfo=function(t,e){document.getElementById("export-info").innerText=t&&e?"Minimum Height: "+t+"\nMaximum Height: "+e:""},e.prototype.setTerrainInfo=function(t){document.getElementById("terrain-info").innerText=t},e.prototype.hideInitWindow=function(){s.hide(document.getElementById("init-window"),!0)},e}(o.EventEmitter));e.default=c},function(t,e,n){"use strict";e.__esModule=!0;var r="debugMode",i="cameraMode",o=new(function(){function t(){null===window.localStorage.getItem(r)&&this.setDebugMode(!1),null===window.localStorage.getItem(i)&&this.setCameraMode(!0)}return t.prototype.setDebugMode=function(t){window.localStorage.setItem(r,t?"1":"0")},t.prototype.getDebugMode=function(){return"1"===window.localStorage.getItem(r)},t.prototype.setCameraMode=function(t){window.localStorage.setItem(i,t?"1":"0")},t.prototype.getCameraMode=function(){return"1"===window.localStorage.getItem(i)},t.prototype.setInitData=function(t){window.localStorage.setItem("initData",JSON.stringify(t))},t.prototype.getInitData=function(){var t;try{t=JSON.parse(window.localStorage.getItem("initData")||"{}")}catch(e){t={}}var e={};return e.size=t.size||1024,e.scale=t.scale||1,e.maxHeight=t.maxHeight||3e3,e.minHeight=t.minHeight||-3e3,e},t}());e.default=o},function(t,e,n){"use strict";e.__esModule=!0;var r=n(8),i=function(){function t(t,e,n,i,o,a){this.position=r.vec3.clone(t),this.orientation=r.quat.fromEuler(r.quat.create(),e[0],e[1],e[2]),this.aspectRatio=n,this.fovy=i,this.zNear=o,this.zFar=a,this.viewMatrix=r.mat4.identity(r.mat4.create()),this.projectionMatrix=r.mat4.create(),r.mat4.lookAt(this.viewMatrix,this.position,[0,0,0],[0,1,0]),this.updateProjectionMatrix()}return t.prototype.getForwardDirection=function(){return r.vec3.clone([this.viewMatrix[2],this.viewMatrix[6],this.viewMatrix[10]])},t.prototype.getPosition=function(){return this.position},t.prototype.updateProjectionMatrix=function(){this.projectionMatrix=r.mat4.perspective(r.mat4.create(),this.fovy,this.aspectRatio,this.zNear,this.zFar)},t}();e.Camera=i;var o=function(){function t(t,e,n,i,o){void 0===e&&(e=[0,0,0]),void 0===n&&(n=10),void 0===i&&(i=0),void 0===o&&(o=.5*Math.PI),this.camera=t,this.center=r.vec3.clone(e),this.distance=n,this.theta=i,this.phi=o,this.updateFPS([0,0,0],0,0)}return t.prototype.updateArcBall=function(t,e,n){this.distance+=n*this.distance,this.distance=Math.min(Math.max(0,this.distance),4e3),this.theta=Math.min(Math.max(this.theta+e[1],1e-4),Math.PI-1e-4),this.phi+=e[0],r.vec3.rotateY(t,t,[0,0,0],this.phi),r.vec3.add(this.center,this.center,t),this.camera.position[0]=this.center[0]+this.distance*Math.sin(this.theta)*Math.sin(this.phi),this.camera.position[1]=this.center[1]+this.distance*Math.cos(this.theta),this.camera.position[2]=this.center[2]+this.distance*Math.sin(this.theta)*Math.cos(this.phi),r.mat4.lookAt(this.camera.viewMatrix,this.camera.position,this.center,[0,1,0])},t.prototype.updateFPS=function(t,e,n){var i=r.quat.fromEuler(r.quat.create(),e/Math.PI*180,0,0),o=r.quat.setAxisAngle(r.quat.create(),[0,1,0],n);r.quat.multiply(i,i,this.camera.orientation),r.quat.multiply(this.camera.orientation,i,o),r.quat.normalize(this.camera.orientation,this.camera.orientation);var a=r.mat4.fromQuat(r.mat4.create(),this.camera.orientation),s=r.vec3.clone([a[2],a[6],a[10]]),u=r.vec3.clone([a[1],a[5],a[9]]),l=r.vec3.clone([a[0],a[4],a[8]]);r.vec3.add(this.camera.position,this.camera.position,[s[0]*t[2],s[1]*t[2],s[2]*t[2]]),r.vec3.add(this.camera.position,this.camera.position,[u[0]*t[1],u[1]*t[1],u[2]*t[1]]),r.vec3.add(this.camera.position,this.camera.position,[l[0]*t[0],l[1]*t[0],l[2]*t[0]]),r.mat4.multiply(this.camera.viewMatrix,a,r.mat4.translate(r.mat4.create(),r.mat4.create(),[-this.camera.position[0],-this.camera.position[1],-this.camera.position[2]]))},t}();e.CameraController=o},function(t,e,n){"use strict";n.r(e),e.default="#version 300 es\n\nprecision mediump float;\n\nuniform mat4 uTransform;\nuniform int uGridResolution;\nuniform float uTexelSizeInMeters;\nuniform float uHeightScaleInMeters;\nuniform sampler2D uHeightmapTexture;\n\nout vec3 vWorldSpacePos;\nout float vIsSkirt;\n\n// A very simple, regular procedural terrain for debugging cracks etc.\nfloat debugSineHills(vec2 uv)\n{\n\tconst float HORIZ_SCALE = 4.0 * 3.14159;\n\tconst float VERT_SCALE = 10.0;\n\tuv *= HORIZ_SCALE;\n\treturn VERT_SCALE * (sin(uv.x) + 1.0) * (sin(uv.y) + 1.0) - 0.5 ;\n}\n\nvoid main(void) {\n\tint baseQuad = gl_VertexID / 6;\n\tvec2 quadOffset = vec2(baseQuad % (uGridResolution + 2), baseQuad / (uGridResolution + 2));\n\tint index = gl_VertexID % 6;\n\n\tvec2 positions[6] = vec2[](\n\t\tvec2(0.0, 0.0),\n\t\tvec2(1.0, 0.0),\n\t\tvec2(0.0, 1.0),\n\t\tvec2(0.0, 1.0),\n\t\tvec2(1.0, 0.0),\n\t\tvec2(1.0, 1.0)\n\t);\n\n\tvec3 position = vec3(quadOffset + positions[index], 0.0).xzy;\n\tposition.xz -= 1.0;\n\tposition.xz = position.xz;\n\t// position.y = debugSineHills(position.xz * 0.005);\n\n\tbool isSkirt = false;\n\tif (position.x < 0.0 || position.z < 0.0) {\n\t\tisSkirt = true;\n\t\tposition.xz += 1.0;\n\t}\n\tif (position.x >= float(uGridResolution) || position.z >= float(uGridResolution)) {\n\t\tisSkirt = true;\n\t\tposition.xz -= 1.0;\n\t}\n\n\tposition.y = isSkirt ? -500.0 : texture(uHeightmapTexture, position.xz * uTexelSizeInMeters * (1.0 / vec2(textureSize(uHeightmapTexture, 0).xy))).r * uHeightScaleInMeters;\n\tvWorldSpacePos = position;\n\tvIsSkirt = isSkirt ? 1.0 : 0.0;\n\tgl_Position = uTransform * vec4(position, 1.0);\n}"},function(t,e,n){"use strict";e.__esModule=!0;var r,i,o,a,s,u,l,h=n(20),c=n(51),f=n(55),d=n(95),g=n(48),p=n(96),v=n(4),m=n(137),_=n(47),y=n(46),b=0,x=null;var w=null;function T(t){var e=w&&t?t-w:1e3/60;w=t,function(t,e){if(o.update(t,e),r.setCanvasMouseState(o.mouse.canvas.over,o.mouse.canvas.current[0],o.mouse.canvas.current[1],o.mouse.terrain.current[0],o.mouse.terrain.current[1],s.selectedBrush&&s.selectedBrush.radius||0),o.setTerrainMousePos(l.getMouseWorldSpacePos()),o.mouse.buttonDown&&0===o.mouse.button&&o.mouse.terrain.over&&s.mouseDownAtPoint(o.mouse.terrain.current[0],o.mouse.terrain.current[1],o.mouse.terrain.last[0],o.mouse.terrain.last[1],e),h.default.hasChange()&&++b>=5){b=0;for(var n=h.default.getTrees(),i=new Float32Array(2*n.length),a=0,u=0;a<n.length;++a,u+=2)i[u]=n[a][0],i[u+1]=n[a][1];l.decorationObjects.updateTreePositions(i),h.default.clearChange()}}(t,e),r.render(t,e),requestAnimationFrame(T),v.default.checkGLError()}function E(t){x||(x=t,y.default.selectMenuIndex(0),y.default.setTerrainInfo(t.size+"x"+t.size+", "+t.scale+", "+t.minHeight+", "+t.maxHeight),y.default.hideInitWindow(),console.log(t))}function M(){l.shadowsNeedUpdate=!0,a.generateHardnessPass.updateValues=!0,a.queuePass(a.generateHardnessPass)}!function(){i=new g.Camera([512,768,-768],[-30,180,0],16/9,.25*Math.PI,.1,1e4);var t=_.default.getCameraMode(),e=document.getElementById("canvas");(o=new p.default(i,e)).setFpsMode(t),y.default.wheelEnabled=t,r=new v.default(e,i),l=r.getTerrain(),a=r.getHeightmapRenderer(),u=a.textures.layers,s=new c.default(a),window.onresize=function(){r.resized(),y.default.updateBrushWindowSizeAndPos()},r.resized(),a.queuePass(a.perlinPass),a.queuePass(a.generateSurfacePass),a.queuePass(a.generateHardnessPass),requestAnimationFrame(T)}(),y.default.on("debug0",(function(){var t=!o.isFpsMode();o.setFpsMode(t),y.default.wheelEnabled=t})),y.default.on("debug3",(function(){a.queuePass(a.generateSurfacePass)})),y.default.on("debug5",(function(){return a.textures.heightMap.current().updateFloatRedData([1024,1024],new Float32Array(1048576))})),y.default.on("init",E),y.default.on("radius-changed",(function(t){return s.setRadius(t)})),y.default.on("strength-changed",(function(t){return s.setStrength(t)})),y.default.on("min-slope-changed",(function(t){return s.setValueForAllBrushes("minSlope",t)})),y.default.on("max-slope-changed",(function(t){return s.setValueForAllBrushes("maxSlope",t)})),y.default.on("smart-layer-state-changed",(function(t){s.brush.layer.smart=t})),y.default.on("menu-selected",(function(t){switch(t){case"increase-brush":s.selectedBrush=s.brush.height,s.brush.height.direction=1;break;case"decrease-brush":s.selectedBrush=s.brush.height,s.brush.height.direction=-1;break;case"flatten-brush":s.selectedBrush=s.brush.flatten;break;case"layer-brush":s.selectedBrush=s.brush.layer;break;case"decoration-brush":s.selectedBrush=s.brush.decoration;break;case"erosion-brush":s.selectedBrush=s.brush.erosion;break;case"layers":case"settings":s.selectedBrush=null}s.selectedBrush&&("radius"in s.selectedBrush&&(y.default.radiusInput.value=s.selectedBrush.radius.toString(),y.default.radiusOutput.value=s.selectedBrush.radius.toString()),"strength"in s.selectedBrush&&(y.default.strengthInput.value=s.selectedBrush.strength.toString(),y.default.strengthOutput.value=s.selectedBrush.strength.toString()),"minSlope"in s.selectedBrush&&(y.default.minSlopeInput.value=s.selectedBrush.minSlope.toString()),"maxSlope"in s.selectedBrush&&(y.default.maxSlopeInput.value=s.selectedBrush.maxSlope.toString()))})),y.default.on("layer-type-selected",(function(t){s.brush.layer.type=u.layerOrder[t]})),y.default.on("brush-type-selected",(function(t){s.brush.height.type=t})),y.default.on("flatten-brush-type-changed",(function(t){s.brush.flatten.type=t})),y.default.on("decoration-brush-type-changed",(function(t){s.brush.decoration.remove=0!==t})),y.default.on("layer-order-changed",(function(t){u.layerOrder=t,y.default.updateLayerBrushTypeSelector(u)})),y.default.on("layer-changed",(function(t,e,n,r){var i=u.getLayerMaterial(t);i.setColor(e),i.setRoughness(n),u.setLayerActive(t,r),y.default.updateLayerBrushTypeSelector(u)})),y.default.on("sun-changed",(function(t,e){t*=.5*Math.PI,t+=.5*Math.PI,t=Math.PI-t,e*=2*Math.PI,e=2*Math.PI-e;var n=[Math.sin(t)*Math.sin(e),Math.cos(t),Math.sin(t)*Math.cos(e)];r.sunDir=n,l.shadowsNeedUpdate=!0})),y.default.on("camera-mode-changed",(function(t){o.setFpsMode(t),y.default.wheelEnabled=t})),y.default.on("export",(function(t){switch(t){case 0:f.downloadPNGHeightmap8Bit(a);break;case 1:f.downloadPNGHeightmap16Bit(a);break;case 2:f.downloadFloatHeightMap(a);break;case 3:f.downloadOBJ(a);break;case 4:f.downloadPNGLayers8Bit(a);break;case 5:f.downloadPNGLayers16Bit(a)}})),y.default.on("save",(function(){x&&m.save(a,u,x)})),y.default.on("file-opened",(function(t){m.load(t,a,u,(function(t){E(t.initData)}))})),y.default.setupLayerList(u),y.default.updateLayerBrushTypeSelector(u),y.default.selectMenuIndex(-1),y.default.on("layer-generation",(function(){a.queuePass(a.generateSurfacePass)})),y.default.on("seed-generation",(function(t){for(var e=d.createRandom(t),n=[],r=[],i=[],o=0;o<6;++o)n[o]=1e5*e(),r[2*o]=1e5*e(),r[2*o+1]=1e5*e(),i[o]=1-Math.round(Math.pow(e(),8-o));a.perlinPass.seeds=n,a.perlinPass.amplitudes=[512,128,64,32,16,8,1,.5],a.perlinPass.scales=[512,256,128,64,32,16,8,2],a.perlinPass.offsets=r,a.perlinPass.ridgeFactor=i,a.queuePass(a.perlinPass),a.queuePass(a.generateSurfacePass),M()})),s.on("height-changed",M),_.default.getDebugMode()&&E(_.default.getInitData())},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});e.__esModule=!0;var o=n(9),a=n(20),s=n(26),u=function(t){function e(e){var n=t.call(this)||this;return n.brush={height:{radius:100,strength:50,direction:1,type:0},flatten:{radius:100,strength:50,type:0},layer:{radius:15,strength:50,type:0,minSlope:0,maxSlope:1,smart:!1},decoration:{radius:100,strength:50,remove:!1,accumulator:0},erosion:{radius:100,strength:50}},n.selectedBrush=n.brush.height,n.heightmapController=e,n}return i(e,t),e.prototype.mouseDownAtPoint=function(t,e,n,r,i){switch(this.selectedBrush){case this.brush.height:this.heightmapController.heightBrushPass.queueData({points:[t,e,n,r],type:s.HeightBrushPass.NORMAL+this.brush.height.type,radius:this.brush.height.radius,strength:this.brush.height.strength*this.brush.height.direction*i*.001,water:!1}),this.heightmapController.queuePass(this.heightmapController.heightBrushPass),this.emit("height-changed");break;case this.brush.flatten:this.heightmapController.heightBrushPass.queueData({points:[t,e,n,r],type:s.HeightBrushPass.FLATTEN+this.brush.flatten.type,radius:this.brush.flatten.radius,strength:this.brush.flatten.strength*i*.001,water:!1}),this.heightmapController.queuePass(this.heightmapController.heightBrushPass),this.emit("height-changed");break;case this.brush.layer:if(this.brush.layer.smart)this.heightmapController.generateSurfacePass.queueData({points:[t,e,n,r],radius:this.brush.layer.radius,strength:.03*i}),this.heightmapController.queuePass(this.heightmapController.generateSurfacePass);else{var o=(this.selectedBrush.strength-1)/99,u=Math.min(this.brush.layer.minSlope,this.brush.layer.maxSlope),l=Math.max(this.brush.layer.minSlope,this.brush.layer.maxSlope);this.heightmapController.layerBrushPass.queueData({points:[t,e,n,r],type:this.brush.layer.type,radius:this.brush.layer.radius,value:o,strength:.01*i,minSlope:u,maxSlope:l}),this.heightmapController.queuePass(this.heightmapController.layerBrushPass)}break;case this.brush.decoration:var h=Math.max(1500,this.brush.decoration.radius*this.brush.decoration.radius*Math.PI);this.brush.decoration.accumulator+=48e-9*i*this.brush.decoration.strength*h;var c=Math.floor(this.brush.decoration.accumulator);c>=1&&(this.brush.decoration.accumulator-=c,this.brush.decoration.remove?a.default.removeTrees(c,[t,e],this.brush.decoration.radius):a.default.addTrees(c,[t,e],this.brush.decoration.radius,4));break;case this.brush.erosion:this.heightmapController.heightBrushPass.queueData({points:[t,e,n,r],type:s.HeightBrushPass.NORMAL+1,radius:this.brush.erosion.radius,strength:this.brush.erosion.strength*i*.002,water:!0}),this.heightmapController.queuePass(this.heightmapController.heightBrushPass)}},e.prototype.setRadius=function(t){this.setValueForAllBrushes("radius",t)},e.prototype.setStrength=function(t){this.setValueForAllBrushes("strength",t)},e.prototype.setValueForAllBrushes=function(t,e){this.selectedBrush&&t in this.selectedBrush&&(this.selectedBrush[t]=e)},e}(o.EventEmitter);e.default=u},function(t,e,n){"use strict";e.__esModule=!0;var r=function(){this.deltaTime=.02,this.rainRate=.012,this.evaporationRate=.015,this.pipeCrossSectionArea=20,this.pipeLength=1,this.sedimentCapacity=1,this.thermalErosionRate=.15,this.suspensionRate=.5,this.depositionRate=1,this.sedimentSofteningRate=5,this.maxErosionDepth=10,this.talusAngleTangentCoeff=.8,this.talusAngleTangentBias=.1};e.default=r},function(t,e,n){"use strict";n.r(e),e.default="#version 300 es\nprecision highp float;\n\nin vec2 vCoords;\n\nuniform sampler2D uTexture;\n\nout vec4 oHeight;\n\nvoid main(void) {\t\n\tfloat h = texture(uTexture, vCoords).r;\n\t\n\toHeight = vec4(-h, 0.0, 0.0, 1.0);\n}"},function(t,e,n){"use strict";n.r(e),e.default="#version 300 es\nprecision highp float;\n\nin vec2 vCoords;\n\nuniform sampler2D uTexture;\nuniform sampler2D uBrushesTexture;\n\nuniform vec2 uPoints[200];\nuniform int uPointCount;\nuniform int uType;\nuniform float uRadius;\nuniform float uStrength;\n\nout vec4 oHeight;\n\nvec2 projectPointOntoLine(vec2 lineA, vec2 lineB, vec2 point) {\n\tvec2 lineNormal = lineB - lineA;\n\tfloat t = dot(point - lineA, lineNormal) / dot(lineNormal, lineNormal);\n\tt = min(max(t, 0.0), 1.0);\n\n\treturn lineA + t * lineNormal;\n}\n\nvoid main(void) {\n\tfloat height = texture(uTexture, vCoords).r;\n\tvec2 terrainSize = vec2(textureSize(uTexture, 0));\n\tvec2 fragmentPosition = vCoords * terrainSize;\n\n\tfloat minDist = 10000000.0;\n\tvec2 closestPoint = fragmentPosition;\n\n\t// find minimum distance to path\n\tfor (int i = 0; i < uPointCount - 1; ++i) {\n\t\tvec2 fromPoint = uPoints[i];\n\t\tvec2 toPoint = uPoints[i + 1];\n\t\t\n\t\tvec2 pointOnLine = projectPointOntoLine(fromPoint, toPoint, fragmentPosition);\n\t\tfloat dist = distance(pointOnLine, fragmentPosition);\n\n\t\tfloat isCloser = step(dist, minDist);\n\t\tminDist  = mix(minDist, dist, isCloser);\n\t\tclosestPoint = mix(closestPoint, pointOnLine, isCloser);\n\t}\n\n\t// apply brush\n\tif (uType < 16) { // normal\tmode\t\t\n\t\tvec2 brushCoords = fragmentPosition - closestPoint;\n\t\tbrushCoords /= uRadius * 2.0;\n\t\tbrushCoords += vec2(0.5);\n\t\tbrushCoords = max(vec2(0.0), min(vec2(1.0), brushCoords));\n\t\t\n\t\tint brushTextureLayer = uType / 4;\n\t\tint brushTextureIndex = uType % 4;\n\t\tbrushCoords += vec2(brushTextureIndex % 2, brushTextureIndex / 2);\n\t\tbrushCoords *= 0.5;\n\t\tfloat brushWeight = texture(uBrushesTexture, brushCoords)[brushTextureLayer];\n\n\t\tfloat weight = step(minDist, uRadius); // enforce radius boundary\n\t\theight += weight * uStrength * brushWeight;\n\t}\n\telse if (uType == 16) { // flatten mode\n\t\tfloat weight = smoothstep(uRadius, 0.0, minDist); \n\t\tfloat centerHeight = texture(uTexture, uPoints[0] / terrainSize).r;\n\n\t\tfloat delta = centerHeight - height;\n\t\tfloat flattenStrength = 0.03; // this number just feels right in comparison to normal mode\n\t\theight += delta * min(1.0, weight * uStrength * flattenStrength);\n\n\t}\n\telse if (uType == 17) // smooth\n\t{\n\t\tfloat weight = smoothstep(uRadius, 0.0, minDist); \n\t\tfloat averageHeight = (\n\t\t\ttexture(uTexture, ((vCoords * terrainSize) + vec2(-1, -1)) / terrainSize).r +\n\t\t\ttexture(uTexture, ((vCoords * terrainSize) + vec2( 0, -1)) / terrainSize).r +\n\t\t\ttexture(uTexture, ((vCoords * terrainSize) + vec2( 1, -1)) / terrainSize).r +\n\t\t\ttexture(uTexture, ((vCoords * terrainSize) + vec2(-1,  0)) / terrainSize).r +\n\t\t\ttexture(uTexture, ((vCoords * terrainSize) + vec2( 1,  0)) / terrainSize).r +\n\t\t\ttexture(uTexture, ((vCoords * terrainSize) + vec2(-1,  1)) / terrainSize).r +\n\t\t\ttexture(uTexture, ((vCoords * terrainSize) + vec2( 0,  1)) / terrainSize).r +\n\t\t\ttexture(uTexture, ((vCoords * terrainSize) + vec2( 1,  1)) / terrainSize).r\n\t\t) / 8.0;\n\n\t\tfloat delta = averageHeight - height;\n\t\theight += delta * min(1.0, weight * uStrength);\n\t}\n\t// height = texture(uBrushesTexture, vCoords*2.0).r * 300.0;\n\toHeight = vec4(height, 0.0, 0.0, 1.0);\n}"},function(t,e,n){"use strict";(function(t){e.__esModule=!0;var r=n(58),i=n(15),o=n(46),a=[1024,1024];function s(t){for(var e=function(t,e){for(var n=new Float32Array(t*e*3),r=new Uint32Array((t-1)*(e-1)*6),i=0;i<t;++i)for(var o=0;o<e;++o){var a=3*(o*t+i);n[a]=i/(t-1),n[a+1]=0,n[a+2]=o/(e-1)}for(i=0;i<t-1;++i)for(o=0;o<e-1;++o){var s=o*t+i,u=s+t,l=s+t+1,h=s+1,c=6*(o*(t-1)+i);r[c+0]=s,r[c+1]=u,r[c+2]=l,r[c+3]=s,r[c+4]=l,r[c+5]=h}return{vertices:n,indices:r}}(a[0],a[1]),n=e.indices,r=e.vertices,i=[],o=0,s=0;o<r.length;o+=3,s+=1)i.push("\nv",r[o]*a[0],t[s],r[o+2]*a[1]);i.push("\n");for(o=0;o<n.length;o+=3)i.push("\nf",n[o]+1,n[o+1]+1,n[o+2]+1);return i.push("\n"),i.join(" ")}function u(e,n,o){var a=new r.PNG({width:o[0],height:o[1],bitDepth:16,colorType:0,inputColorType:0,inputHasAlpha:!1});a.data=new t(e.buffer);var s=r.PNG.sync.write(a,{bitDepth:16,colorType:0,inputColorType:0,inputHasAlpha:!1});i.downloadBlob(n,new Blob([s]))}e.createOBJ=s,e.downloadOBJ=function(t){o.default.setExportFileInfo();var e=s(t.getHeightMapData());i.downloadBlob("terrain.obj",new Blob([e]))},e.downloadPNGHeightmap8Bit=function(t){for(var e=t.getHeightMapData(),n=i.arrayMinMax(e),r=n.min,s=n.max,u=new Uint8Array(a[0]*a[1]*4),l=0;l<e.length;++l){var h=Math.round((e[l]-r)/(s-r)*255),c=4*l;u[c]=h,u[c+1]=h,u[c+2]=h,u[c+3]=255}o.default.setExportFileInfo(r,s);var f=i.rgbaDataToPNGDataURL(u,a);i.downloadURI("Heightmap.png",f)},e.downloadPNGHeightmap16Bit=function(t){for(var e=t.getHeightMapData(),n=i.arrayMinMax(e),r=n.min,s=n.max,l=new Uint16Array(a[0]*a[1]),h=0;h<l.length;++h)l[h]=Math.round((e[h]-r)/(s-r)*65535);o.default.setExportFileInfo(r,s),u(l,"heightmap_16bit.png",a)},e.downloadPNGLayers8Bit=function(t){o.default.setExportFileInfo();for(var e=t.getLayerWeightData(),n=new Uint8Array(a[0]*a[1]*4),r=function(r){if(t.textures.layers.getLayerActive(r)){for(var o=e[Math.floor(r/4)],s=r%4,u=0;u<n.length;u+=4){var l=Math.round(255*o[s+u]);n[u]=l,n[u+1]=l,n[u+2]=l,n[u+3]=255}var h=i.rgbaDataToPNGDataURL(n,a);setTimeout((function(){i.downloadURI("layer"+r+".png",h)}),200*r)}},s=0;s<8;++s)r(s)},e.downloadPNGLayers16Bit=function(t){o.default.setExportFileInfo();for(var e=t.getLayerWeightData(),n=function(n){if(t.textures.layers.getLayerActive(n)){for(var r=e[Math.floor(n/4)],i=n%4,o=new Uint16Array(a[0]*a[1]),s=0;s<o.length;++s)o[s]=Math.round(65535*r[i+4*s]);setTimeout((function(){u(o,"layer"+n+"_16bit.png",a)}),200*n)}},r=0;r<8;++r)n(r)},e.downloadGrayscale16BitPNG=u,e.downloadFloatHeightMap=function(t){o.default.setExportFileInfo();var e=t.getHeightMapData();i.downloadBlob("Heightmap_Red32F.raw",new Blob([e]))}}).call(this,n(1).Buffer)},function(t,e,n){"use strict";e.byteLength=function(t){var e=l(t),n=e[0],r=e[1];return 3*(n+r)/4-r},e.toByteArray=function(t){var e,n,r=l(t),a=r[0],s=r[1],u=new o(function(t,e,n){return 3*(e+n)/4-n}(0,a,s)),h=0,c=s>0?a-4:a;for(n=0;n<c;n+=4)e=i[t.charCodeAt(n)]<<18|i[t.charCodeAt(n+1)]<<12|i[t.charCodeAt(n+2)]<<6|i[t.charCodeAt(n+3)],u[h++]=e>>16&255,u[h++]=e>>8&255,u[h++]=255&e;2===s&&(e=i[t.charCodeAt(n)]<<2|i[t.charCodeAt(n+1)]>>4,u[h++]=255&e);1===s&&(e=i[t.charCodeAt(n)]<<10|i[t.charCodeAt(n+1)]<<4|i[t.charCodeAt(n+2)]>>2,u[h++]=e>>8&255,u[h++]=255&e);return u},e.fromByteArray=function(t){for(var e,n=t.length,i=n%3,o=[],a=0,s=n-i;a<s;a+=16383)o.push(h(t,a,a+16383>s?s:a+16383));1===i?(e=t[n-1],o.push(r[e>>2]+r[e<<4&63]+"==")):2===i&&(e=(t[n-2]<<8)+t[n-1],o.push(r[e>>10]+r[e>>4&63]+r[e<<2&63]+"="));return o.join("")};for(var r=[],i=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,u=a.length;s<u;++s)r[s]=a[s],i[a.charCodeAt(s)]=s;function l(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");return-1===n&&(n=e),[n,n===e?0:4-n%4]}function h(t,e,n){for(var i,o,a=[],s=e;s<n;s+=3)i=(t[s]<<16&16711680)+(t[s+1]<<8&65280)+(255&t[s+2]),a.push(r[(o=i)>>18&63]+r[o>>12&63]+r[o>>6&63]+r[63&o]);return a.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},function(t,e){e.read=function(t,e,n,r,i){var o,a,s=8*i-r-1,u=(1<<s)-1,l=u>>1,h=-7,c=n?i-1:0,f=n?-1:1,d=t[e+c];for(c+=f,o=d&(1<<-h)-1,d>>=-h,h+=s;h>0;o=256*o+t[e+c],c+=f,h-=8);for(a=o&(1<<-h)-1,o>>=-h,h+=r;h>0;a=256*a+t[e+c],c+=f,h-=8);if(0===o)o=1-l;else{if(o===u)return a?NaN:1/0*(d?-1:1);a+=Math.pow(2,r),o-=l}return(d?-1:1)*a*Math.pow(2,o-r)},e.write=function(t,e,n,r,i,o){var a,s,u,l=8*o-i-1,h=(1<<l)-1,c=h>>1,f=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,d=r?0:o-1,g=r?1:-1,p=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,a=h):(a=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-a))<1&&(a--,u*=2),(e+=a+c>=1?f/u:f*Math.pow(2,1-c))*u>=2&&(a++,u/=2),a+c>=h?(s=0,a=h):a+c>=1?(s=(e*u-1)*Math.pow(2,i),a+=c):(s=e*Math.pow(2,c-1)*Math.pow(2,i),a=0));i>=8;t[n+d]=255&s,d+=g,s/=256,i-=8);for(a=a<<i|s,l+=i;l>0;t[n+d]=255&a,d+=g,a/=256,l-=8);t[n+d-g]|=128*p}},function(t,e,n){"use strict";(function(t,r){var i=n(5),o=n(16),a=n(72),s=n(84),u=n(87),l=e.PNG=function(e){o.call(this),e=e||{},this.width=0|e.width,this.height=0|e.height,this.data=this.width>0&&this.height>0?new t(4*this.width*this.height):null,e.fill&&this.data&&this.data.fill(0),this.gamma=0,this.readable=this.writable=!0,this._parser=new a(e),this._parser.on("error",this.emit.bind(this,"error")),this._parser.on("close",this._handleClose.bind(this)),this._parser.on("metadata",this._metadata.bind(this)),this._parser.on("gamma",this._gamma.bind(this)),this._parser.on("parsed",function(t){this.data=t,this.emit("parsed",t)}.bind(this)),this._packer=new s(e),this._packer.on("data",this.emit.bind(this,"data")),this._packer.on("end",this.emit.bind(this,"end")),this._parser.on("close",this._handleClose.bind(this)),this._packer.on("error",this.emit.bind(this,"error"))};i.inherits(l,o),l.sync=u,l.prototype.pack=function(){return this.data&&this.data.length?(r.nextTick(function(){this._packer.pack(this.data,this.width,this.height,this.gamma)}.bind(this)),this):(this.emit("error","No data provided"),this)},l.prototype.parse=function(t,e){var n,r;e&&(n=function(t){this.removeListener("error",r),this.data=t,e(null,this)}.bind(this),r=function(t){this.removeListener("parsed",n),e(t,null)}.bind(this),this.once("parsed",n),this.once("error",r));return this.end(t),this},l.prototype.write=function(t){return this._parser.write(t),!0},l.prototype.end=function(t){this._parser.end(t)},l.prototype._metadata=function(t){this.width=t.width,this.height=t.height,this.emit("metadata",t)},l.prototype._gamma=function(t){this.gamma=t},l.prototype._handleClose=function(){this._parser.writable||this._packer.readable||this.emit("close")},l.bitblt=function(t,e,n,r,i,o,a,s){if(r|=0,i|=0,o|=0,a|=0,s|=0,(n|=0)>t.width||r>t.height||n+i>t.width||r+o>t.height)throw new Error("bitblt reading outside image");if(a>e.width||s>e.height||a+i>e.width||s+o>e.height)throw new Error("bitblt writing outside image");for(var u=0;u<o;u++)t.data.copy(e.data,(s+u)*e.width+a<<2,(r+u)*t.width+n<<2,(r+u)*t.width+n+i<<2)},l.prototype.bitblt=function(t,e,n,r,i,o,a){return l.bitblt(this,t,e,n,r,i,o,a),this},l.adjustGamma=function(t){if(t.gamma){for(var e=0;e<t.height;e++)for(var n=0;n<t.width;n++)for(var r=t.width*e+n<<2,i=0;i<3;i++){var o=t.data[r+i]/255;o=Math.pow(o,1/2.2/t.gamma),t.data[r+i]=Math.round(255*o)}t.gamma=0}},l.prototype.adjustGamma=function(){l.adjustGamma(this)}}).call(this,n(1).Buffer,n(3))},function(t,e){t.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},function(t,e){"function"==typeof Object.create?t.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},function(t,e){},function(t,e,n){"use strict";var r=n(18).Buffer,i=n(63);t.exports=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.head=null,this.tail=null,this.length=0}return t.prototype.push=function(t){var e={data:t,next:null};this.length>0?this.tail.next=e:this.head=e,this.tail=e,++this.length},t.prototype.unshift=function(t){var e={data:t,next:this.head};0===this.length&&(this.tail=e),this.head=e,++this.length},t.prototype.shift=function(){if(0!==this.length){var t=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,t}},t.prototype.clear=function(){this.head=this.tail=null,this.length=0},t.prototype.join=function(t){if(0===this.length)return"";for(var e=this.head,n=""+e.data;e=e.next;)n+=t+e.data;return n},t.prototype.concat=function(t){if(0===this.length)return r.alloc(0);if(1===this.length)return this.head.data;for(var e,n,i,o=r.allocUnsafe(t>>>0),a=this.head,s=0;a;)e=a.data,n=o,i=s,e.copy(n,i),s+=a.data.length,a=a.next;return o},t}(),i&&i.inspect&&i.inspect.custom&&(t.exports.prototype[i.inspect.custom]=function(){var t=i.inspect({length:this.length});return this.constructor.name+" "+t})},function(t,e){},function(t,e,n){(function(t){var r=void 0!==t&&t||"undefined"!=typeof self&&self||window,i=Function.prototype.apply;function o(t,e){this._id=t,this._clearFn=e}e.setTimeout=function(){return new o(i.call(setTimeout,r,arguments),clearTimeout)},e.setInterval=function(){return new o(i.call(setInterval,r,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},o.prototype.unref=o.prototype.ref=function(){},o.prototype.close=function(){this._clearFn.call(r,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout((function(){t._onTimeout&&t._onTimeout()}),e))},n(65),e.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==t&&t.setImmediate||this&&this.setImmediate,e.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==t&&t.clearImmediate||this&&this.clearImmediate}).call(this,n(6))},function(t,e,n){(function(t,e){!function(t,n){"use strict";if(!t.setImmediate){var r,i,o,a,s,u=1,l={},h=!1,c=t.document,f=Object.getPrototypeOf&&Object.getPrototypeOf(t);f=f&&f.setTimeout?f:t,"[object process]"==={}.toString.call(t.process)?r=function(t){e.nextTick((function(){g(t)}))}:!function(){if(t.postMessage&&!t.importScripts){var e=!0,n=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=n,e}}()?t.MessageChannel?((o=new MessageChannel).port1.onmessage=function(t){g(t.data)},r=function(t){o.port2.postMessage(t)}):c&&"onreadystatechange"in c.createElement("script")?(i=c.documentElement,r=function(t){var e=c.createElement("script");e.onreadystatechange=function(){g(t),e.onreadystatechange=null,i.removeChild(e),e=null},i.appendChild(e)}):r=function(t){setTimeout(g,0,t)}:(a="setImmediate$"+Math.random()+"$",s=function(e){e.source===t&&"string"==typeof e.data&&0===e.data.indexOf(a)&&g(+e.data.slice(a.length))},t.addEventListener?t.addEventListener("message",s,!1):t.attachEvent("onmessage",s),r=function(e){t.postMessage(a+e,"*")}),f.setImmediate=function(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),n=0;n<e.length;n++)e[n]=arguments[n+1];var i={callback:t,args:e};return l[u]=i,r(u),u++},f.clearImmediate=d}function d(t){delete l[t]}function g(t){if(h)setTimeout(g,0,t);else{var e=l[t];if(e){h=!0;try{!function(t){var e=t.callback,r=t.args;switch(r.length){case 0:e();break;case 1:e(r[0]);break;case 2:e(r[0],r[1]);break;case 3:e(r[0],r[1],r[2]);break;default:e.apply(n,r)}}(e)}finally{d(t),h=!1}}}}}("undefined"==typeof self?void 0===t?this:t:self)}).call(this,n(6),n(3))},function(t,e,n){(function(e){function n(t){try{if(!e.localStorage)return!1}catch(t){return!1}var n=e.localStorage[t];return null!=n&&"true"===String(n).toLowerCase()}t.exports=function(t,e){if(n("noDeprecation"))return t;var r=!1;return function(){if(!r){if(n("throwDeprecation"))throw new Error(e);n("traceDeprecation")?console.trace(e):console.warn(e),r=!0}return t.apply(this,arguments)}}}).call(this,n(6))},function(t,e,n){"use strict";t.exports=o;var r=n(33),i=n(12);function o(t){if(!(this instanceof o))return new o(t);r.call(this,t)}i.inherits=n(11),i.inherits(o,r),o.prototype._transform=function(t,e,n){n(null,t)}},function(t,e,n){t.exports=n(22)},function(t,e,n){t.exports=n(7)},function(t,e,n){t.exports=n(21).Transform},function(t,e,n){t.exports=n(21).PassThrough},function(t,e,n){"use strict";var r=n(5),i=n(13),o=n(36),a=n(83),s=n(40),u=n(42),l=n(43),h=t.exports=function(t){o.call(this),this._parser=new s(t,{read:this.read.bind(this),error:this._handleError.bind(this),metadata:this._handleMetaData.bind(this),gamma:this.emit.bind(this,"gamma"),palette:this._handlePalette.bind(this),transColor:this._handleTransColor.bind(this),finished:this._finished.bind(this),inflateData:this._inflateData.bind(this),simpleTransparency:this._simpleTransparency.bind(this),headersFinished:this._headersFinished.bind(this)}),this._options=t,this.writable=!0,this._parser.start()};r.inherits(h,o),h.prototype._handleError=function(t){this.emit("error",t),this.writable=!1,this.destroy(),this._inflate&&this._inflate.destroy&&this._inflate.destroy(),this._filter&&(this._filter.destroy(),this._filter.on("error",(function(){}))),this.errord=!0},h.prototype._inflateData=function(t){if(!this._inflate)if(this._bitmapInfo.interlace)this._inflate=i.createInflate(),this._inflate.on("error",this.emit.bind(this,"error")),this._filter.on("complete",this._complete.bind(this)),this._inflate.pipe(this._filter);else{var e=(1+(this._bitmapInfo.width*this._bitmapInfo.bpp*this._bitmapInfo.depth+7>>3))*this._bitmapInfo.height,n=Math.max(e,i.Z_MIN_CHUNK);this._inflate=i.createInflate({chunkSize:n});var r=e,o=this.emit.bind(this,"error");this._inflate.on("error",(function(t){r&&o(t)})),this._filter.on("complete",this._complete.bind(this));var a=this._filter.write.bind(this._filter);this._inflate.on("data",(function(t){r&&(t.length>r&&(t=t.slice(0,r)),r-=t.length,a(t))})),this._inflate.on("end",this._filter.end.bind(this._filter))}this._inflate.write(t)},h.prototype._handleMetaData=function(t){this._metaData=t,this._bitmapInfo=Object.create(t),this._filter=new a(this._bitmapInfo)},h.prototype._handleTransColor=function(t){this._bitmapInfo.transColor=t},h.prototype._handlePalette=function(t){this._bitmapInfo.palette=t},h.prototype._simpleTransparency=function(){this._metaData.alpha=!0},h.prototype._headersFinished=function(){this.emit("metadata",this._metaData)},h.prototype._finished=function(){this.errord||(this._inflate?this._inflate.end():this.emit("error","No Inflate block"),this.destroySoon())},h.prototype._complete=function(t){if(!this.errord){try{var e=u.dataToBitMap(t,this._bitmapInfo),n=l(e,this._bitmapInfo);e=null}catch(t){return void this._handleError(t)}this.emit("parsed",n)}}},function(t,e,n){"use strict";(function(t,r){var i=n(23),o=n(75),a=n(76),s=n(79),u=n(82);for(var l in u)e[l]=u[l];e.NONE=0,e.DEFLATE=1,e.INFLATE=2,e.GZIP=3,e.GUNZIP=4,e.DEFLATERAW=5,e.INFLATERAW=6,e.UNZIP=7;function h(t){if("number"!=typeof t||t<e.DEFLATE||t>e.UNZIP)throw new TypeError("Bad argument");this.dictionary=null,this.err=0,this.flush=0,this.init_done=!1,this.level=0,this.memLevel=0,this.mode=t,this.strategy=0,this.windowBits=0,this.write_in_progress=!1,this.pending_close=!1,this.gzip_id_bytes_read=0}h.prototype.close=function(){this.write_in_progress?this.pending_close=!0:(this.pending_close=!1,i(this.init_done,"close before init"),i(this.mode<=e.UNZIP),this.mode===e.DEFLATE||this.mode===e.GZIP||this.mode===e.DEFLATERAW?a.deflateEnd(this.strm):this.mode!==e.INFLATE&&this.mode!==e.GUNZIP&&this.mode!==e.INFLATERAW&&this.mode!==e.UNZIP||s.inflateEnd(this.strm),this.mode=e.NONE,this.dictionary=null)},h.prototype.write=function(t,e,n,r,i,o,a){return this._write(!0,t,e,n,r,i,o,a)},h.prototype.writeSync=function(t,e,n,r,i,o,a){return this._write(!1,t,e,n,r,i,o,a)},h.prototype._write=function(n,o,a,s,u,l,h,c){if(i.equal(arguments.length,8),i(this.init_done,"write before init"),i(this.mode!==e.NONE,"already finalized"),i.equal(!1,this.write_in_progress,"write already in progress"),i.equal(!1,this.pending_close,"close is pending"),this.write_in_progress=!0,i.equal(!1,void 0===o,"must provide flush value"),this.write_in_progress=!0,o!==e.Z_NO_FLUSH&&o!==e.Z_PARTIAL_FLUSH&&o!==e.Z_SYNC_FLUSH&&o!==e.Z_FULL_FLUSH&&o!==e.Z_FINISH&&o!==e.Z_BLOCK)throw new Error("Invalid flush value");if(null==a&&(a=t.alloc(0),u=0,s=0),this.strm.avail_in=u,this.strm.input=a,this.strm.next_in=s,this.strm.avail_out=c,this.strm.output=l,this.strm.next_out=h,this.flush=o,!n)return this._process(),this._checkError()?this._afterSync():void 0;var f=this;return r.nextTick((function(){f._process(),f._after()})),this},h.prototype._afterSync=function(){var t=this.strm.avail_out,e=this.strm.avail_in;return this.write_in_progress=!1,[e,t]},h.prototype._process=function(){var t=null;switch(this.mode){case e.DEFLATE:case e.GZIP:case e.DEFLATERAW:this.err=a.deflate(this.strm,this.flush);break;case e.UNZIP:switch(this.strm.avail_in>0&&(t=this.strm.next_in),this.gzip_id_bytes_read){case 0:if(null===t)break;if(31!==this.strm.input[t]){this.mode=e.INFLATE;break}if(this.gzip_id_bytes_read=1,t++,1===this.strm.avail_in)break;case 1:if(null===t)break;139===this.strm.input[t]?(this.gzip_id_bytes_read=2,this.mode=e.GUNZIP):this.mode=e.INFLATE;break;default:throw new Error("invalid number of gzip magic number bytes read")}case e.INFLATE:case e.GUNZIP:case e.INFLATERAW:for(this.err=s.inflate(this.strm,this.flush),this.err===e.Z_NEED_DICT&&this.dictionary&&(this.err=s.inflateSetDictionary(this.strm,this.dictionary),this.err===e.Z_OK?this.err=s.inflate(this.strm,this.flush):this.err===e.Z_DATA_ERROR&&(this.err=e.Z_NEED_DICT));this.strm.avail_in>0&&this.mode===e.GUNZIP&&this.err===e.Z_STREAM_END&&0!==this.strm.next_in[0];)this.reset(),this.err=s.inflate(this.strm,this.flush);break;default:throw new Error("Unknown mode "+this.mode)}},h.prototype._checkError=function(){switch(this.err){case e.Z_OK:case e.Z_BUF_ERROR:if(0!==this.strm.avail_out&&this.flush===e.Z_FINISH)return this._error("unexpected end of file"),!1;break;case e.Z_STREAM_END:break;case e.Z_NEED_DICT:return null==this.dictionary?this._error("Missing dictionary"):this._error("Bad dictionary"),!1;default:return this._error("Zlib error"),!1}return!0},h.prototype._after=function(){if(this._checkError()){var t=this.strm.avail_out,e=this.strm.avail_in;this.write_in_progress=!1,this.callback(e,t),this.pending_close&&this.close()}},h.prototype._error=function(t){this.strm.msg&&(t=this.strm.msg),this.onerror(t,this.err),this.write_in_progress=!1,this.pending_close&&this.close()},h.prototype.init=function(t,n,r,o,a){i(4===arguments.length||5===arguments.length,"init(windowBits, level, memLevel, strategy, [dictionary])"),i(t>=8&&t<=15,"invalid windowBits"),i(n>=-1&&n<=9,"invalid compression level"),i(r>=1&&r<=9,"invalid memlevel"),i(o===e.Z_FILTERED||o===e.Z_HUFFMAN_ONLY||o===e.Z_RLE||o===e.Z_FIXED||o===e.Z_DEFAULT_STRATEGY,"invalid strategy"),this._init(n,t,r,o,a),this._setDictionary()},h.prototype.params=function(){throw new Error("deflateParams Not supported")},h.prototype.reset=function(){this._reset(),this._setDictionary()},h.prototype._init=function(t,n,r,i,u){switch(this.level=t,this.windowBits=n,this.memLevel=r,this.strategy=i,this.flush=e.Z_NO_FLUSH,this.err=e.Z_OK,this.mode!==e.GZIP&&this.mode!==e.GUNZIP||(this.windowBits+=16),this.mode===e.UNZIP&&(this.windowBits+=32),this.mode!==e.DEFLATERAW&&this.mode!==e.INFLATERAW||(this.windowBits=-1*this.windowBits),this.strm=new o,this.mode){case e.DEFLATE:case e.GZIP:case e.DEFLATERAW:this.err=a.deflateInit2(this.strm,this.level,e.Z_DEFLATED,this.windowBits,this.memLevel,this.strategy);break;case e.INFLATE:case e.GUNZIP:case e.INFLATERAW:case e.UNZIP:this.err=s.inflateInit2(this.strm,this.windowBits);break;default:throw new Error("Unknown mode "+this.mode)}this.err!==e.Z_OK&&this._error("Init error"),this.dictionary=u,this.write_in_progress=!1,this.init_done=!0},h.prototype._setDictionary=function(){if(null!=this.dictionary){switch(this.err=e.Z_OK,this.mode){case e.DEFLATE:case e.DEFLATERAW:this.err=a.deflateSetDictionary(this.strm,this.dictionary)}this.err!==e.Z_OK&&this._error("Failed to set dictionary")}},h.prototype._reset=function(){switch(this.err=e.Z_OK,this.mode){case e.DEFLATE:case e.DEFLATERAW:case e.GZIP:this.err=a.deflateReset(this.strm);break;case e.INFLATE:case e.INFLATERAW:case e.GUNZIP:this.err=s.inflateReset(this.strm)}this.err!==e.Z_OK&&this._error("Failed to reset stream")},e.Zlib=h}).call(this,n(1).Buffer,n(3))},function(t,e,n){"use strict";
/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var r=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable;function a(t){if(null==t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}t.exports=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},n=0;n<10;n++)e["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(e).map((function(t){return e[t]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(t){r[t]=t})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(t){return!1}}()?Object.assign:function(t,e){for(var n,s,u=a(t),l=1;l<arguments.length;l++){for(var h in n=Object(arguments[l]))i.call(n,h)&&(u[h]=n[h]);if(r){s=r(n);for(var c=0;c<s.length;c++)o.call(n,s[c])&&(u[s[c]]=n[s[c]])}}return u}},function(t,e,n){"use strict";t.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},function(t,e,n){"use strict";var r,i=n(19),o=n(77),a=n(34),s=n(35),u=n(78),l=0,h=1,c=3,f=4,d=5,g=0,p=1,v=-2,m=-3,_=-5,y=-1,b=1,x=2,w=3,T=4,E=0,M=2,S=8,L=9,A=15,R=8,P=286,C=30,I=19,F=2*P+1,k=15,D=3,O=258,U=O+D+1,z=32,B=42,H=69,N=73,G=91,j=103,W=113,X=666,Y=1,q=2,V=3,Z=4,K=3;function Q(t,e){return t.msg=u[e],e}function J(t){return(t<<1)-(t>4?9:0)}function $(t){for(var e=t.length;--e>=0;)t[e]=0}function tt(t){var e=t.state,n=e.pending;n>t.avail_out&&(n=t.avail_out),0!==n&&(i.arraySet(t.output,e.pending_buf,e.pending_out,n,t.next_out),t.next_out+=n,e.pending_out+=n,t.total_out+=n,t.avail_out-=n,e.pending-=n,0===e.pending&&(e.pending_out=0))}function et(t,e){o._tr_flush_block(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,tt(t.strm)}function nt(t,e){t.pending_buf[t.pending++]=e}function rt(t,e){t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=255&e}function it(t,e){var n,r,i=t.max_chain_length,o=t.strstart,a=t.prev_length,s=t.nice_match,u=t.strstart>t.w_size-U?t.strstart-(t.w_size-U):0,l=t.window,h=t.w_mask,c=t.prev,f=t.strstart+O,d=l[o+a-1],g=l[o+a];t.prev_length>=t.good_match&&(i>>=2),s>t.lookahead&&(s=t.lookahead);do{if(l[(n=e)+a]===g&&l[n+a-1]===d&&l[n]===l[o]&&l[++n]===l[o+1]){o+=2,n++;do{}while(l[++o]===l[++n]&&l[++o]===l[++n]&&l[++o]===l[++n]&&l[++o]===l[++n]&&l[++o]===l[++n]&&l[++o]===l[++n]&&l[++o]===l[++n]&&l[++o]===l[++n]&&o<f);if(r=O-(f-o),o=f-O,r>a){if(t.match_start=e,a=r,r>=s)break;d=l[o+a-1],g=l[o+a]}}}while((e=c[e&h])>u&&0!=--i);return a<=t.lookahead?a:t.lookahead}function ot(t){var e,n,r,o,u,l,h,c,f,d,g=t.w_size;do{if(o=t.window_size-t.lookahead-t.strstart,t.strstart>=g+(g-U)){i.arraySet(t.window,t.window,g,g,0),t.match_start-=g,t.strstart-=g,t.block_start-=g,e=n=t.hash_size;do{r=t.head[--e],t.head[e]=r>=g?r-g:0}while(--n);e=n=g;do{r=t.prev[--e],t.prev[e]=r>=g?r-g:0}while(--n);o+=g}if(0===t.strm.avail_in)break;if(l=t.strm,h=t.window,c=t.strstart+t.lookahead,f=o,d=void 0,(d=l.avail_in)>f&&(d=f),n=0===d?0:(l.avail_in-=d,i.arraySet(h,l.input,l.next_in,d,c),1===l.state.wrap?l.adler=a(l.adler,h,d,c):2===l.state.wrap&&(l.adler=s(l.adler,h,d,c)),l.next_in+=d,l.total_in+=d,d),t.lookahead+=n,t.lookahead+t.insert>=D)for(u=t.strstart-t.insert,t.ins_h=t.window[u],t.ins_h=(t.ins_h<<t.hash_shift^t.window[u+1])&t.hash_mask;t.insert&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[u+D-1])&t.hash_mask,t.prev[u&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=u,u++,t.insert--,!(t.lookahead+t.insert<D)););}while(t.lookahead<U&&0!==t.strm.avail_in)}function at(t,e){for(var n,r;;){if(t.lookahead<U){if(ot(t),t.lookahead<U&&e===l)return Y;if(0===t.lookahead)break}if(n=0,t.lookahead>=D&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+D-1])&t.hash_mask,n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==n&&t.strstart-n<=t.w_size-U&&(t.match_length=it(t,n)),t.match_length>=D)if(r=o._tr_tally(t,t.strstart-t.match_start,t.match_length-D),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=D){t.match_length--;do{t.strstart++,t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+D-1])&t.hash_mask,n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart}while(0!=--t.match_length);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+1])&t.hash_mask;else r=o._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(r&&(et(t,!1),0===t.strm.avail_out))return Y}return t.insert=t.strstart<D-1?t.strstart:D-1,e===f?(et(t,!0),0===t.strm.avail_out?V:Z):t.last_lit&&(et(t,!1),0===t.strm.avail_out)?Y:q}function st(t,e){for(var n,r,i;;){if(t.lookahead<U){if(ot(t),t.lookahead<U&&e===l)return Y;if(0===t.lookahead)break}if(n=0,t.lookahead>=D&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+D-1])&t.hash_mask,n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=D-1,0!==n&&t.prev_length<t.max_lazy_match&&t.strstart-n<=t.w_size-U&&(t.match_length=it(t,n),t.match_length<=5&&(t.strategy===b||t.match_length===D&&t.strstart-t.match_start>4096)&&(t.match_length=D-1)),t.prev_length>=D&&t.match_length<=t.prev_length){i=t.strstart+t.lookahead-D,r=o._tr_tally(t,t.strstart-1-t.prev_match,t.prev_length-D),t.lookahead-=t.prev_length-1,t.prev_length-=2;do{++t.strstart<=i&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+D-1])&t.hash_mask,n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart)}while(0!=--t.prev_length);if(t.match_available=0,t.match_length=D-1,t.strstart++,r&&(et(t,!1),0===t.strm.avail_out))return Y}else if(t.match_available){if((r=o._tr_tally(t,0,t.window[t.strstart-1]))&&et(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return Y}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(r=o._tr_tally(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<D-1?t.strstart:D-1,e===f?(et(t,!0),0===t.strm.avail_out?V:Z):t.last_lit&&(et(t,!1),0===t.strm.avail_out)?Y:q}function ut(t,e,n,r,i){this.good_length=t,this.max_lazy=e,this.nice_length=n,this.max_chain=r,this.func=i}function lt(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=S,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new i.Buf16(2*F),this.dyn_dtree=new i.Buf16(2*(2*C+1)),this.bl_tree=new i.Buf16(2*(2*I+1)),$(this.dyn_ltree),$(this.dyn_dtree),$(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new i.Buf16(k+1),this.heap=new i.Buf16(2*P+1),$(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new i.Buf16(2*P+1),$(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function ht(t){var e;return t&&t.state?(t.total_in=t.total_out=0,t.data_type=M,(e=t.state).pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap?B:W,t.adler=2===e.wrap?0:1,e.last_flush=l,o._tr_init(e),g):Q(t,v)}function ct(t){var e,n=ht(t);return n===g&&((e=t.state).window_size=2*e.w_size,$(e.head),e.max_lazy_match=r[e.level].max_lazy,e.good_match=r[e.level].good_length,e.nice_match=r[e.level].nice_length,e.max_chain_length=r[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=D-1,e.match_available=0,e.ins_h=0),n}function ft(t,e,n,r,o,a){if(!t)return v;var s=1;if(e===y&&(e=6),r<0?(s=0,r=-r):r>15&&(s=2,r-=16),o<1||o>L||n!==S||r<8||r>15||e<0||e>9||a<0||a>T)return Q(t,v);8===r&&(r=9);var u=new lt;return t.state=u,u.strm=t,u.wrap=s,u.gzhead=null,u.w_bits=r,u.w_size=1<<u.w_bits,u.w_mask=u.w_size-1,u.hash_bits=o+7,u.hash_size=1<<u.hash_bits,u.hash_mask=u.hash_size-1,u.hash_shift=~~((u.hash_bits+D-1)/D),u.window=new i.Buf8(2*u.w_size),u.head=new i.Buf16(u.hash_size),u.prev=new i.Buf16(u.w_size),u.lit_bufsize=1<<o+6,u.pending_buf_size=4*u.lit_bufsize,u.pending_buf=new i.Buf8(u.pending_buf_size),u.d_buf=1*u.lit_bufsize,u.l_buf=3*u.lit_bufsize,u.level=e,u.strategy=a,u.method=n,ct(t)}r=[new ut(0,0,0,0,(function(t,e){var n=65535;for(n>t.pending_buf_size-5&&(n=t.pending_buf_size-5);;){if(t.lookahead<=1){if(ot(t),0===t.lookahead&&e===l)return Y;if(0===t.lookahead)break}t.strstart+=t.lookahead,t.lookahead=0;var r=t.block_start+n;if((0===t.strstart||t.strstart>=r)&&(t.lookahead=t.strstart-r,t.strstart=r,et(t,!1),0===t.strm.avail_out))return Y;if(t.strstart-t.block_start>=t.w_size-U&&(et(t,!1),0===t.strm.avail_out))return Y}return t.insert=0,e===f?(et(t,!0),0===t.strm.avail_out?V:Z):(t.strstart>t.block_start&&(et(t,!1),t.strm.avail_out),Y)})),new ut(4,4,8,4,at),new ut(4,5,16,8,at),new ut(4,6,32,32,at),new ut(4,4,16,16,st),new ut(8,16,32,32,st),new ut(8,16,128,128,st),new ut(8,32,128,256,st),new ut(32,128,258,1024,st),new ut(32,258,258,4096,st)],e.deflateInit=function(t,e){return ft(t,e,S,A,R,E)},e.deflateInit2=ft,e.deflateReset=ct,e.deflateResetKeep=ht,e.deflateSetHeader=function(t,e){return t&&t.state?2!==t.state.wrap?v:(t.state.gzhead=e,g):v},e.deflate=function(t,e){var n,i,a,u;if(!t||!t.state||e>d||e<0)return t?Q(t,v):v;if(i=t.state,!t.output||!t.input&&0!==t.avail_in||i.status===X&&e!==f)return Q(t,0===t.avail_out?_:v);if(i.strm=t,n=i.last_flush,i.last_flush=e,i.status===B)if(2===i.wrap)t.adler=0,nt(i,31),nt(i,139),nt(i,8),i.gzhead?(nt(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),nt(i,255&i.gzhead.time),nt(i,i.gzhead.time>>8&255),nt(i,i.gzhead.time>>16&255),nt(i,i.gzhead.time>>24&255),nt(i,9===i.level?2:i.strategy>=x||i.level<2?4:0),nt(i,255&i.gzhead.os),i.gzhead.extra&&i.gzhead.extra.length&&(nt(i,255&i.gzhead.extra.length),nt(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(t.adler=s(t.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=H):(nt(i,0),nt(i,0),nt(i,0),nt(i,0),nt(i,0),nt(i,9===i.level?2:i.strategy>=x||i.level<2?4:0),nt(i,K),i.status=W);else{var m=S+(i.w_bits-8<<4)<<8;m|=(i.strategy>=x||i.level<2?0:i.level<6?1:6===i.level?2:3)<<6,0!==i.strstart&&(m|=z),m+=31-m%31,i.status=W,rt(i,m),0!==i.strstart&&(rt(i,t.adler>>>16),rt(i,65535&t.adler)),t.adler=1}if(i.status===H)if(i.gzhead.extra){for(a=i.pending;i.gzindex<(65535&i.gzhead.extra.length)&&(i.pending!==i.pending_buf_size||(i.gzhead.hcrc&&i.pending>a&&(t.adler=s(t.adler,i.pending_buf,i.pending-a,a)),tt(t),a=i.pending,i.pending!==i.pending_buf_size));)nt(i,255&i.gzhead.extra[i.gzindex]),i.gzindex++;i.gzhead.hcrc&&i.pending>a&&(t.adler=s(t.adler,i.pending_buf,i.pending-a,a)),i.gzindex===i.gzhead.extra.length&&(i.gzindex=0,i.status=N)}else i.status=N;if(i.status===N)if(i.gzhead.name){a=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>a&&(t.adler=s(t.adler,i.pending_buf,i.pending-a,a)),tt(t),a=i.pending,i.pending===i.pending_buf_size)){u=1;break}u=i.gzindex<i.gzhead.name.length?255&i.gzhead.name.charCodeAt(i.gzindex++):0,nt(i,u)}while(0!==u);i.gzhead.hcrc&&i.pending>a&&(t.adler=s(t.adler,i.pending_buf,i.pending-a,a)),0===u&&(i.gzindex=0,i.status=G)}else i.status=G;if(i.status===G)if(i.gzhead.comment){a=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>a&&(t.adler=s(t.adler,i.pending_buf,i.pending-a,a)),tt(t),a=i.pending,i.pending===i.pending_buf_size)){u=1;break}u=i.gzindex<i.gzhead.comment.length?255&i.gzhead.comment.charCodeAt(i.gzindex++):0,nt(i,u)}while(0!==u);i.gzhead.hcrc&&i.pending>a&&(t.adler=s(t.adler,i.pending_buf,i.pending-a,a)),0===u&&(i.status=j)}else i.status=j;if(i.status===j&&(i.gzhead.hcrc?(i.pending+2>i.pending_buf_size&&tt(t),i.pending+2<=i.pending_buf_size&&(nt(i,255&t.adler),nt(i,t.adler>>8&255),t.adler=0,i.status=W)):i.status=W),0!==i.pending){if(tt(t),0===t.avail_out)return i.last_flush=-1,g}else if(0===t.avail_in&&J(e)<=J(n)&&e!==f)return Q(t,_);if(i.status===X&&0!==t.avail_in)return Q(t,_);if(0!==t.avail_in||0!==i.lookahead||e!==l&&i.status!==X){var y=i.strategy===x?function(t,e){for(var n;;){if(0===t.lookahead&&(ot(t),0===t.lookahead)){if(e===l)return Y;break}if(t.match_length=0,n=o._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,n&&(et(t,!1),0===t.strm.avail_out))return Y}return t.insert=0,e===f?(et(t,!0),0===t.strm.avail_out?V:Z):t.last_lit&&(et(t,!1),0===t.strm.avail_out)?Y:q}(i,e):i.strategy===w?function(t,e){for(var n,r,i,a,s=t.window;;){if(t.lookahead<=O){if(ot(t),t.lookahead<=O&&e===l)return Y;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=D&&t.strstart>0&&(r=s[i=t.strstart-1])===s[++i]&&r===s[++i]&&r===s[++i]){a=t.strstart+O;do{}while(r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&i<a);t.match_length=O-(a-i),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=D?(n=o._tr_tally(t,1,t.match_length-D),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(n=o._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),n&&(et(t,!1),0===t.strm.avail_out))return Y}return t.insert=0,e===f?(et(t,!0),0===t.strm.avail_out?V:Z):t.last_lit&&(et(t,!1),0===t.strm.avail_out)?Y:q}(i,e):r[i.level].func(i,e);if(y!==V&&y!==Z||(i.status=X),y===Y||y===V)return 0===t.avail_out&&(i.last_flush=-1),g;if(y===q&&(e===h?o._tr_align(i):e!==d&&(o._tr_stored_block(i,0,0,!1),e===c&&($(i.head),0===i.lookahead&&(i.strstart=0,i.block_start=0,i.insert=0))),tt(t),0===t.avail_out))return i.last_flush=-1,g}return e!==f?g:i.wrap<=0?p:(2===i.wrap?(nt(i,255&t.adler),nt(i,t.adler>>8&255),nt(i,t.adler>>16&255),nt(i,t.adler>>24&255),nt(i,255&t.total_in),nt(i,t.total_in>>8&255),nt(i,t.total_in>>16&255),nt(i,t.total_in>>24&255)):(rt(i,t.adler>>>16),rt(i,65535&t.adler)),tt(t),i.wrap>0&&(i.wrap=-i.wrap),0!==i.pending?g:p)},e.deflateEnd=function(t){var e;return t&&t.state?(e=t.state.status)!==B&&e!==H&&e!==N&&e!==G&&e!==j&&e!==W&&e!==X?Q(t,v):(t.state=null,e===W?Q(t,m):g):v},e.deflateSetDictionary=function(t,e){var n,r,o,s,u,l,h,c,f=e.length;if(!t||!t.state)return v;if(2===(s=(n=t.state).wrap)||1===s&&n.status!==B||n.lookahead)return v;for(1===s&&(t.adler=a(t.adler,e,f,0)),n.wrap=0,f>=n.w_size&&(0===s&&($(n.head),n.strstart=0,n.block_start=0,n.insert=0),c=new i.Buf8(n.w_size),i.arraySet(c,e,f-n.w_size,n.w_size,0),e=c,f=n.w_size),u=t.avail_in,l=t.next_in,h=t.input,t.avail_in=f,t.next_in=0,t.input=e,ot(n);n.lookahead>=D;){r=n.strstart,o=n.lookahead-(D-1);do{n.ins_h=(n.ins_h<<n.hash_shift^n.window[r+D-1])&n.hash_mask,n.prev[r&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=r,r++}while(--o);n.strstart=r,n.lookahead=D-1,ot(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=D-1,n.match_available=0,t.next_in=l,t.input=h,t.avail_in=u,n.wrap=s,g},e.deflateInfo="pako deflate (from Nodeca project)"},function(t,e,n){"use strict";var r=n(19),i=4,o=0,a=1,s=2;function u(t){for(var e=t.length;--e>=0;)t[e]=0}var l=0,h=1,c=2,f=29,d=256,g=d+1+f,p=30,v=19,m=2*g+1,_=15,y=16,b=7,x=256,w=16,T=17,E=18,M=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],S=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],L=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],A=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],R=new Array(2*(g+2));u(R);var P=new Array(2*p);u(P);var C=new Array(512);u(C);var I=new Array(256);u(I);var F=new Array(f);u(F);var k,D,O,U=new Array(p);function z(t,e,n,r,i){this.static_tree=t,this.extra_bits=e,this.extra_base=n,this.elems=r,this.max_length=i,this.has_stree=t&&t.length}function B(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}function H(t){return t<256?C[t]:C[256+(t>>>7)]}function N(t,e){t.pending_buf[t.pending++]=255&e,t.pending_buf[t.pending++]=e>>>8&255}function G(t,e,n){t.bi_valid>y-n?(t.bi_buf|=e<<t.bi_valid&65535,N(t,t.bi_buf),t.bi_buf=e>>y-t.bi_valid,t.bi_valid+=n-y):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=n)}function j(t,e,n){G(t,n[2*e],n[2*e+1])}function W(t,e){var n=0;do{n|=1&t,t>>>=1,n<<=1}while(--e>0);return n>>>1}function X(t,e,n){var r,i,o=new Array(_+1),a=0;for(r=1;r<=_;r++)o[r]=a=a+n[r-1]<<1;for(i=0;i<=e;i++){var s=t[2*i+1];0!==s&&(t[2*i]=W(o[s]++,s))}}function Y(t){var e;for(e=0;e<g;e++)t.dyn_ltree[2*e]=0;for(e=0;e<p;e++)t.dyn_dtree[2*e]=0;for(e=0;e<v;e++)t.bl_tree[2*e]=0;t.dyn_ltree[2*x]=1,t.opt_len=t.static_len=0,t.last_lit=t.matches=0}function q(t){t.bi_valid>8?N(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0}function V(t,e,n,r){var i=2*e,o=2*n;return t[i]<t[o]||t[i]===t[o]&&r[e]<=r[n]}function Z(t,e,n){for(var r=t.heap[n],i=n<<1;i<=t.heap_len&&(i<t.heap_len&&V(e,t.heap[i+1],t.heap[i],t.depth)&&i++,!V(e,r,t.heap[i],t.depth));)t.heap[n]=t.heap[i],n=i,i<<=1;t.heap[n]=r}function K(t,e,n){var r,i,o,a,s=0;if(0!==t.last_lit)do{r=t.pending_buf[t.d_buf+2*s]<<8|t.pending_buf[t.d_buf+2*s+1],i=t.pending_buf[t.l_buf+s],s++,0===r?j(t,i,e):(j(t,(o=I[i])+d+1,e),0!==(a=M[o])&&G(t,i-=F[o],a),j(t,o=H(--r),n),0!==(a=S[o])&&G(t,r-=U[o],a))}while(s<t.last_lit);j(t,x,e)}function Q(t,e){var n,r,i,o=e.dyn_tree,a=e.stat_desc.static_tree,s=e.stat_desc.has_stree,u=e.stat_desc.elems,l=-1;for(t.heap_len=0,t.heap_max=m,n=0;n<u;n++)0!==o[2*n]?(t.heap[++t.heap_len]=l=n,t.depth[n]=0):o[2*n+1]=0;for(;t.heap_len<2;)o[2*(i=t.heap[++t.heap_len]=l<2?++l:0)]=1,t.depth[i]=0,t.opt_len--,s&&(t.static_len-=a[2*i+1]);for(e.max_code=l,n=t.heap_len>>1;n>=1;n--)Z(t,o,n);i=u;do{n=t.heap[1],t.heap[1]=t.heap[t.heap_len--],Z(t,o,1),r=t.heap[1],t.heap[--t.heap_max]=n,t.heap[--t.heap_max]=r,o[2*i]=o[2*n]+o[2*r],t.depth[i]=(t.depth[n]>=t.depth[r]?t.depth[n]:t.depth[r])+1,o[2*n+1]=o[2*r+1]=i,t.heap[1]=i++,Z(t,o,1)}while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],function(t,e){var n,r,i,o,a,s,u=e.dyn_tree,l=e.max_code,h=e.stat_desc.static_tree,c=e.stat_desc.has_stree,f=e.stat_desc.extra_bits,d=e.stat_desc.extra_base,g=e.stat_desc.max_length,p=0;for(o=0;o<=_;o++)t.bl_count[o]=0;for(u[2*t.heap[t.heap_max]+1]=0,n=t.heap_max+1;n<m;n++)(o=u[2*u[2*(r=t.heap[n])+1]+1]+1)>g&&(o=g,p++),u[2*r+1]=o,r>l||(t.bl_count[o]++,a=0,r>=d&&(a=f[r-d]),s=u[2*r],t.opt_len+=s*(o+a),c&&(t.static_len+=s*(h[2*r+1]+a)));if(0!==p){do{for(o=g-1;0===t.bl_count[o];)o--;t.bl_count[o]--,t.bl_count[o+1]+=2,t.bl_count[g]--,p-=2}while(p>0);for(o=g;0!==o;o--)for(r=t.bl_count[o];0!==r;)(i=t.heap[--n])>l||(u[2*i+1]!==o&&(t.opt_len+=(o-u[2*i+1])*u[2*i],u[2*i+1]=o),r--)}}(t,e),X(o,l,t.bl_count)}function J(t,e,n){var r,i,o=-1,a=e[1],s=0,u=7,l=4;for(0===a&&(u=138,l=3),e[2*(n+1)+1]=65535,r=0;r<=n;r++)i=a,a=e[2*(r+1)+1],++s<u&&i===a||(s<l?t.bl_tree[2*i]+=s:0!==i?(i!==o&&t.bl_tree[2*i]++,t.bl_tree[2*w]++):s<=10?t.bl_tree[2*T]++:t.bl_tree[2*E]++,s=0,o=i,0===a?(u=138,l=3):i===a?(u=6,l=3):(u=7,l=4))}function $(t,e,n){var r,i,o=-1,a=e[1],s=0,u=7,l=4;for(0===a&&(u=138,l=3),r=0;r<=n;r++)if(i=a,a=e[2*(r+1)+1],!(++s<u&&i===a)){if(s<l)do{j(t,i,t.bl_tree)}while(0!=--s);else 0!==i?(i!==o&&(j(t,i,t.bl_tree),s--),j(t,w,t.bl_tree),G(t,s-3,2)):s<=10?(j(t,T,t.bl_tree),G(t,s-3,3)):(j(t,E,t.bl_tree),G(t,s-11,7));s=0,o=i,0===a?(u=138,l=3):i===a?(u=6,l=3):(u=7,l=4)}}u(U);var tt=!1;function et(t,e,n,i){G(t,(l<<1)+(i?1:0),3),function(t,e,n,i){q(t),i&&(N(t,n),N(t,~n)),r.arraySet(t.pending_buf,t.window,e,n,t.pending),t.pending+=n}(t,e,n,!0)}e._tr_init=function(t){tt||(!function(){var t,e,n,r,i,o=new Array(_+1);for(n=0,r=0;r<f-1;r++)for(F[r]=n,t=0;t<1<<M[r];t++)I[n++]=r;for(I[n-1]=r,i=0,r=0;r<16;r++)for(U[r]=i,t=0;t<1<<S[r];t++)C[i++]=r;for(i>>=7;r<p;r++)for(U[r]=i<<7,t=0;t<1<<S[r]-7;t++)C[256+i++]=r;for(e=0;e<=_;e++)o[e]=0;for(t=0;t<=143;)R[2*t+1]=8,t++,o[8]++;for(;t<=255;)R[2*t+1]=9,t++,o[9]++;for(;t<=279;)R[2*t+1]=7,t++,o[7]++;for(;t<=287;)R[2*t+1]=8,t++,o[8]++;for(X(R,g+1,o),t=0;t<p;t++)P[2*t+1]=5,P[2*t]=W(t,5);k=new z(R,M,d+1,g,_),D=new z(P,S,0,p,_),O=new z(new Array(0),L,0,v,b)}(),tt=!0),t.l_desc=new B(t.dyn_ltree,k),t.d_desc=new B(t.dyn_dtree,D),t.bl_desc=new B(t.bl_tree,O),t.bi_buf=0,t.bi_valid=0,Y(t)},e._tr_stored_block=et,e._tr_flush_block=function(t,e,n,r){var u,l,f=0;t.level>0?(t.strm.data_type===s&&(t.strm.data_type=function(t){var e,n=4093624447;for(e=0;e<=31;e++,n>>>=1)if(1&n&&0!==t.dyn_ltree[2*e])return o;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return a;for(e=32;e<d;e++)if(0!==t.dyn_ltree[2*e])return a;return o}(t)),Q(t,t.l_desc),Q(t,t.d_desc),f=function(t){var e;for(J(t,t.dyn_ltree,t.l_desc.max_code),J(t,t.dyn_dtree,t.d_desc.max_code),Q(t,t.bl_desc),e=v-1;e>=3&&0===t.bl_tree[2*A[e]+1];e--);return t.opt_len+=3*(e+1)+5+5+4,e}(t),u=t.opt_len+3+7>>>3,(l=t.static_len+3+7>>>3)<=u&&(u=l)):u=l=n+5,n+4<=u&&-1!==e?et(t,e,n,r):t.strategy===i||l===u?(G(t,(h<<1)+(r?1:0),3),K(t,R,P)):(G(t,(c<<1)+(r?1:0),3),function(t,e,n,r){var i;for(G(t,e-257,5),G(t,n-1,5),G(t,r-4,4),i=0;i<r;i++)G(t,t.bl_tree[2*A[i]+1],3);$(t,t.dyn_ltree,e-1),$(t,t.dyn_dtree,n-1)}(t,t.l_desc.max_code+1,t.d_desc.max_code+1,f+1),K(t,t.dyn_ltree,t.dyn_dtree)),Y(t),r&&q(t)},e._tr_tally=function(t,e,n){return t.pending_buf[t.d_buf+2*t.last_lit]=e>>>8&255,t.pending_buf[t.d_buf+2*t.last_lit+1]=255&e,t.pending_buf[t.l_buf+t.last_lit]=255&n,t.last_lit++,0===e?t.dyn_ltree[2*n]++:(t.matches++,e--,t.dyn_ltree[2*(I[n]+d+1)]++,t.dyn_dtree[2*H(e)]++),t.last_lit===t.lit_bufsize-1},e._tr_align=function(t){G(t,h<<1,3),j(t,x,R),function(t){16===t.bi_valid?(N(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)}(t)}},function(t,e,n){"use strict";t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},function(t,e,n){"use strict";var r=n(19),i=n(34),o=n(35),a=n(80),s=n(81),u=0,l=1,h=2,c=4,f=5,d=6,g=0,p=1,v=2,m=-2,_=-3,y=-4,b=-5,x=8,w=1,T=2,E=3,M=4,S=5,L=6,A=7,R=8,P=9,C=10,I=11,F=12,k=13,D=14,O=15,U=16,z=17,B=18,H=19,N=20,G=21,j=22,W=23,X=24,Y=25,q=26,V=27,Z=28,K=29,Q=30,J=31,$=32,tt=852,et=592,nt=15;function rt(t){return(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24)}function it(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new r.Buf16(320),this.work=new r.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function ot(t){var e;return t&&t.state?(e=t.state,t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=1&e.wrap),e.mode=w,e.last=0,e.havedict=0,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new r.Buf32(tt),e.distcode=e.distdyn=new r.Buf32(et),e.sane=1,e.back=-1,g):m}function at(t){var e;return t&&t.state?((e=t.state).wsize=0,e.whave=0,e.wnext=0,ot(t)):m}function st(t,e){var n,r;return t&&t.state?(r=t.state,e<0?(n=0,e=-e):(n=1+(e>>4),e<48&&(e&=15)),e&&(e<8||e>15)?m:(null!==r.window&&r.wbits!==e&&(r.window=null),r.wrap=n,r.wbits=e,at(t))):m}function ut(t,e){var n,r;return t?(r=new it,t.state=r,r.window=null,(n=st(t,e))!==g&&(t.state=null),n):m}var lt,ht,ct=!0;function ft(t){if(ct){var e;for(lt=new r.Buf32(512),ht=new r.Buf32(32),e=0;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(s(l,t.lens,0,288,lt,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;s(h,t.lens,0,32,ht,0,t.work,{bits:5}),ct=!1}t.lencode=lt,t.lenbits=9,t.distcode=ht,t.distbits=5}function dt(t,e,n,i){var o,a=t.state;return null===a.window&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new r.Buf8(a.wsize)),i>=a.wsize?(r.arraySet(a.window,e,n-a.wsize,a.wsize,0),a.wnext=0,a.whave=a.wsize):((o=a.wsize-a.wnext)>i&&(o=i),r.arraySet(a.window,e,n-i,o,a.wnext),(i-=o)?(r.arraySet(a.window,e,n-i,i,0),a.wnext=i,a.whave=a.wsize):(a.wnext+=o,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=o))),0}e.inflateReset=at,e.inflateReset2=st,e.inflateResetKeep=ot,e.inflateInit=function(t){return ut(t,nt)},e.inflateInit2=ut,e.inflate=function(t,e){var n,tt,et,nt,it,ot,at,st,ut,lt,ht,ct,gt,pt,vt,mt,_t,yt,bt,xt,wt,Tt,Et,Mt,St=0,Lt=new r.Buf8(4),At=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!t||!t.state||!t.output||!t.input&&0!==t.avail_in)return m;(n=t.state).mode===F&&(n.mode=k),it=t.next_out,et=t.output,at=t.avail_out,nt=t.next_in,tt=t.input,ot=t.avail_in,st=n.hold,ut=n.bits,lt=ot,ht=at,Tt=g;t:for(;;)switch(n.mode){case w:if(0===n.wrap){n.mode=k;break}for(;ut<16;){if(0===ot)break t;ot--,st+=tt[nt++]<<ut,ut+=8}if(2&n.wrap&&35615===st){n.check=0,Lt[0]=255&st,Lt[1]=st>>>8&255,n.check=o(n.check,Lt,2,0),st=0,ut=0,n.mode=T;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&st)<<8)+(st>>8))%31){t.msg="incorrect header check",n.mode=Q;break}if((15&st)!==x){t.msg="unknown compression method",n.mode=Q;break}if(ut-=4,wt=8+(15&(st>>>=4)),0===n.wbits)n.wbits=wt;else if(wt>n.wbits){t.msg="invalid window size",n.mode=Q;break}n.dmax=1<<wt,t.adler=n.check=1,n.mode=512&st?C:F,st=0,ut=0;break;case T:for(;ut<16;){if(0===ot)break t;ot--,st+=tt[nt++]<<ut,ut+=8}if(n.flags=st,(255&n.flags)!==x){t.msg="unknown compression method",n.mode=Q;break}if(57344&n.flags){t.msg="unknown header flags set",n.mode=Q;break}n.head&&(n.head.text=st>>8&1),512&n.flags&&(Lt[0]=255&st,Lt[1]=st>>>8&255,n.check=o(n.check,Lt,2,0)),st=0,ut=0,n.mode=E;case E:for(;ut<32;){if(0===ot)break t;ot--,st+=tt[nt++]<<ut,ut+=8}n.head&&(n.head.time=st),512&n.flags&&(Lt[0]=255&st,Lt[1]=st>>>8&255,Lt[2]=st>>>16&255,Lt[3]=st>>>24&255,n.check=o(n.check,Lt,4,0)),st=0,ut=0,n.mode=M;case M:for(;ut<16;){if(0===ot)break t;ot--,st+=tt[nt++]<<ut,ut+=8}n.head&&(n.head.xflags=255&st,n.head.os=st>>8),512&n.flags&&(Lt[0]=255&st,Lt[1]=st>>>8&255,n.check=o(n.check,Lt,2,0)),st=0,ut=0,n.mode=S;case S:if(1024&n.flags){for(;ut<16;){if(0===ot)break t;ot--,st+=tt[nt++]<<ut,ut+=8}n.length=st,n.head&&(n.head.extra_len=st),512&n.flags&&(Lt[0]=255&st,Lt[1]=st>>>8&255,n.check=o(n.check,Lt,2,0)),st=0,ut=0}else n.head&&(n.head.extra=null);n.mode=L;case L:if(1024&n.flags&&((ct=n.length)>ot&&(ct=ot),ct&&(n.head&&(wt=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Array(n.head.extra_len)),r.arraySet(n.head.extra,tt,nt,ct,wt)),512&n.flags&&(n.check=o(n.check,tt,ct,nt)),ot-=ct,nt+=ct,n.length-=ct),n.length))break t;n.length=0,n.mode=A;case A:if(2048&n.flags){if(0===ot)break t;ct=0;do{wt=tt[nt+ct++],n.head&&wt&&n.length<65536&&(n.head.name+=String.fromCharCode(wt))}while(wt&&ct<ot);if(512&n.flags&&(n.check=o(n.check,tt,ct,nt)),ot-=ct,nt+=ct,wt)break t}else n.head&&(n.head.name=null);n.length=0,n.mode=R;case R:if(4096&n.flags){if(0===ot)break t;ct=0;do{wt=tt[nt+ct++],n.head&&wt&&n.length<65536&&(n.head.comment+=String.fromCharCode(wt))}while(wt&&ct<ot);if(512&n.flags&&(n.check=o(n.check,tt,ct,nt)),ot-=ct,nt+=ct,wt)break t}else n.head&&(n.head.comment=null);n.mode=P;case P:if(512&n.flags){for(;ut<16;){if(0===ot)break t;ot--,st+=tt[nt++]<<ut,ut+=8}if(st!==(65535&n.check)){t.msg="header crc mismatch",n.mode=Q;break}st=0,ut=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),t.adler=n.check=0,n.mode=F;break;case C:for(;ut<32;){if(0===ot)break t;ot--,st+=tt[nt++]<<ut,ut+=8}t.adler=n.check=rt(st),st=0,ut=0,n.mode=I;case I:if(0===n.havedict)return t.next_out=it,t.avail_out=at,t.next_in=nt,t.avail_in=ot,n.hold=st,n.bits=ut,v;t.adler=n.check=1,n.mode=F;case F:if(e===f||e===d)break t;case k:if(n.last){st>>>=7&ut,ut-=7&ut,n.mode=V;break}for(;ut<3;){if(0===ot)break t;ot--,st+=tt[nt++]<<ut,ut+=8}switch(n.last=1&st,ut-=1,3&(st>>>=1)){case 0:n.mode=D;break;case 1:if(ft(n),n.mode=N,e===d){st>>>=2,ut-=2;break t}break;case 2:n.mode=z;break;case 3:t.msg="invalid block type",n.mode=Q}st>>>=2,ut-=2;break;case D:for(st>>>=7&ut,ut-=7&ut;ut<32;){if(0===ot)break t;ot--,st+=tt[nt++]<<ut,ut+=8}if((65535&st)!=(st>>>16^65535)){t.msg="invalid stored block lengths",n.mode=Q;break}if(n.length=65535&st,st=0,ut=0,n.mode=O,e===d)break t;case O:n.mode=U;case U:if(ct=n.length){if(ct>ot&&(ct=ot),ct>at&&(ct=at),0===ct)break t;r.arraySet(et,tt,nt,ct,it),ot-=ct,nt+=ct,at-=ct,it+=ct,n.length-=ct;break}n.mode=F;break;case z:for(;ut<14;){if(0===ot)break t;ot--,st+=tt[nt++]<<ut,ut+=8}if(n.nlen=257+(31&st),st>>>=5,ut-=5,n.ndist=1+(31&st),st>>>=5,ut-=5,n.ncode=4+(15&st),st>>>=4,ut-=4,n.nlen>286||n.ndist>30){t.msg="too many length or distance symbols",n.mode=Q;break}n.have=0,n.mode=B;case B:for(;n.have<n.ncode;){for(;ut<3;){if(0===ot)break t;ot--,st+=tt[nt++]<<ut,ut+=8}n.lens[At[n.have++]]=7&st,st>>>=3,ut-=3}for(;n.have<19;)n.lens[At[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,Et={bits:n.lenbits},Tt=s(u,n.lens,0,19,n.lencode,0,n.work,Et),n.lenbits=Et.bits,Tt){t.msg="invalid code lengths set",n.mode=Q;break}n.have=0,n.mode=H;case H:for(;n.have<n.nlen+n.ndist;){for(;mt=(St=n.lencode[st&(1<<n.lenbits)-1])>>>16&255,_t=65535&St,!((vt=St>>>24)<=ut);){if(0===ot)break t;ot--,st+=tt[nt++]<<ut,ut+=8}if(_t<16)st>>>=vt,ut-=vt,n.lens[n.have++]=_t;else{if(16===_t){for(Mt=vt+2;ut<Mt;){if(0===ot)break t;ot--,st+=tt[nt++]<<ut,ut+=8}if(st>>>=vt,ut-=vt,0===n.have){t.msg="invalid bit length repeat",n.mode=Q;break}wt=n.lens[n.have-1],ct=3+(3&st),st>>>=2,ut-=2}else if(17===_t){for(Mt=vt+3;ut<Mt;){if(0===ot)break t;ot--,st+=tt[nt++]<<ut,ut+=8}ut-=vt,wt=0,ct=3+(7&(st>>>=vt)),st>>>=3,ut-=3}else{for(Mt=vt+7;ut<Mt;){if(0===ot)break t;ot--,st+=tt[nt++]<<ut,ut+=8}ut-=vt,wt=0,ct=11+(127&(st>>>=vt)),st>>>=7,ut-=7}if(n.have+ct>n.nlen+n.ndist){t.msg="invalid bit length repeat",n.mode=Q;break}for(;ct--;)n.lens[n.have++]=wt}}if(n.mode===Q)break;if(0===n.lens[256]){t.msg="invalid code -- missing end-of-block",n.mode=Q;break}if(n.lenbits=9,Et={bits:n.lenbits},Tt=s(l,n.lens,0,n.nlen,n.lencode,0,n.work,Et),n.lenbits=Et.bits,Tt){t.msg="invalid literal/lengths set",n.mode=Q;break}if(n.distbits=6,n.distcode=n.distdyn,Et={bits:n.distbits},Tt=s(h,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,Et),n.distbits=Et.bits,Tt){t.msg="invalid distances set",n.mode=Q;break}if(n.mode=N,e===d)break t;case N:n.mode=G;case G:if(ot>=6&&at>=258){t.next_out=it,t.avail_out=at,t.next_in=nt,t.avail_in=ot,n.hold=st,n.bits=ut,a(t,ht),it=t.next_out,et=t.output,at=t.avail_out,nt=t.next_in,tt=t.input,ot=t.avail_in,st=n.hold,ut=n.bits,n.mode===F&&(n.back=-1);break}for(n.back=0;mt=(St=n.lencode[st&(1<<n.lenbits)-1])>>>16&255,_t=65535&St,!((vt=St>>>24)<=ut);){if(0===ot)break t;ot--,st+=tt[nt++]<<ut,ut+=8}if(mt&&0==(240&mt)){for(yt=vt,bt=mt,xt=_t;mt=(St=n.lencode[xt+((st&(1<<yt+bt)-1)>>yt)])>>>16&255,_t=65535&St,!(yt+(vt=St>>>24)<=ut);){if(0===ot)break t;ot--,st+=tt[nt++]<<ut,ut+=8}st>>>=yt,ut-=yt,n.back+=yt}if(st>>>=vt,ut-=vt,n.back+=vt,n.length=_t,0===mt){n.mode=q;break}if(32&mt){n.back=-1,n.mode=F;break}if(64&mt){t.msg="invalid literal/length code",n.mode=Q;break}n.extra=15&mt,n.mode=j;case j:if(n.extra){for(Mt=n.extra;ut<Mt;){if(0===ot)break t;ot--,st+=tt[nt++]<<ut,ut+=8}n.length+=st&(1<<n.extra)-1,st>>>=n.extra,ut-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=W;case W:for(;mt=(St=n.distcode[st&(1<<n.distbits)-1])>>>16&255,_t=65535&St,!((vt=St>>>24)<=ut);){if(0===ot)break t;ot--,st+=tt[nt++]<<ut,ut+=8}if(0==(240&mt)){for(yt=vt,bt=mt,xt=_t;mt=(St=n.distcode[xt+((st&(1<<yt+bt)-1)>>yt)])>>>16&255,_t=65535&St,!(yt+(vt=St>>>24)<=ut);){if(0===ot)break t;ot--,st+=tt[nt++]<<ut,ut+=8}st>>>=yt,ut-=yt,n.back+=yt}if(st>>>=vt,ut-=vt,n.back+=vt,64&mt){t.msg="invalid distance code",n.mode=Q;break}n.offset=_t,n.extra=15&mt,n.mode=X;case X:if(n.extra){for(Mt=n.extra;ut<Mt;){if(0===ot)break t;ot--,st+=tt[nt++]<<ut,ut+=8}n.offset+=st&(1<<n.extra)-1,st>>>=n.extra,ut-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){t.msg="invalid distance too far back",n.mode=Q;break}n.mode=Y;case Y:if(0===at)break t;if(ct=ht-at,n.offset>ct){if((ct=n.offset-ct)>n.whave&&n.sane){t.msg="invalid distance too far back",n.mode=Q;break}ct>n.wnext?(ct-=n.wnext,gt=n.wsize-ct):gt=n.wnext-ct,ct>n.length&&(ct=n.length),pt=n.window}else pt=et,gt=it-n.offset,ct=n.length;ct>at&&(ct=at),at-=ct,n.length-=ct;do{et[it++]=pt[gt++]}while(--ct);0===n.length&&(n.mode=G);break;case q:if(0===at)break t;et[it++]=n.length,at--,n.mode=G;break;case V:if(n.wrap){for(;ut<32;){if(0===ot)break t;ot--,st|=tt[nt++]<<ut,ut+=8}if(ht-=at,t.total_out+=ht,n.total+=ht,ht&&(t.adler=n.check=n.flags?o(n.check,et,ht,it-ht):i(n.check,et,ht,it-ht)),ht=at,(n.flags?st:rt(st))!==n.check){t.msg="incorrect data check",n.mode=Q;break}st=0,ut=0}n.mode=Z;case Z:if(n.wrap&&n.flags){for(;ut<32;){if(0===ot)break t;ot--,st+=tt[nt++]<<ut,ut+=8}if(st!==(4294967295&n.total)){t.msg="incorrect length check",n.mode=Q;break}st=0,ut=0}n.mode=K;case K:Tt=p;break t;case Q:Tt=_;break t;case J:return y;case $:default:return m}return t.next_out=it,t.avail_out=at,t.next_in=nt,t.avail_in=ot,n.hold=st,n.bits=ut,(n.wsize||ht!==t.avail_out&&n.mode<Q&&(n.mode<V||e!==c))&&dt(t,t.output,t.next_out,ht-t.avail_out)?(n.mode=J,y):(lt-=t.avail_in,ht-=t.avail_out,t.total_in+=lt,t.total_out+=ht,n.total+=ht,n.wrap&&ht&&(t.adler=n.check=n.flags?o(n.check,et,ht,t.next_out-ht):i(n.check,et,ht,t.next_out-ht)),t.data_type=n.bits+(n.last?64:0)+(n.mode===F?128:0)+(n.mode===N||n.mode===O?256:0),(0===lt&&0===ht||e===c)&&Tt===g&&(Tt=b),Tt)},e.inflateEnd=function(t){if(!t||!t.state)return m;var e=t.state;return e.window&&(e.window=null),t.state=null,g},e.inflateGetHeader=function(t,e){var n;return t&&t.state?0==(2&(n=t.state).wrap)?m:(n.head=e,e.done=!1,g):m},e.inflateSetDictionary=function(t,e){var n,r=e.length;return t&&t.state?0!==(n=t.state).wrap&&n.mode!==I?m:n.mode===I&&i(1,e,r,0)!==n.check?_:dt(t,e,r,r)?(n.mode=J,y):(n.havedict=1,g):m},e.inflateInfo="pako inflate (from Nodeca project)"},function(t,e,n){"use strict";t.exports=function(t,e){var n,r,i,o,a,s,u,l,h,c,f,d,g,p,v,m,_,y,b,x,w,T,E,M,S;n=t.state,r=t.next_in,M=t.input,i=r+(t.avail_in-5),o=t.next_out,S=t.output,a=o-(e-t.avail_out),s=o+(t.avail_out-257),u=n.dmax,l=n.wsize,h=n.whave,c=n.wnext,f=n.window,d=n.hold,g=n.bits,p=n.lencode,v=n.distcode,m=(1<<n.lenbits)-1,_=(1<<n.distbits)-1;t:do{g<15&&(d+=M[r++]<<g,g+=8,d+=M[r++]<<g,g+=8),y=p[d&m];e:for(;;){if(d>>>=b=y>>>24,g-=b,0===(b=y>>>16&255))S[o++]=65535&y;else{if(!(16&b)){if(0==(64&b)){y=p[(65535&y)+(d&(1<<b)-1)];continue e}if(32&b){n.mode=12;break t}t.msg="invalid literal/length code",n.mode=30;break t}x=65535&y,(b&=15)&&(g<b&&(d+=M[r++]<<g,g+=8),x+=d&(1<<b)-1,d>>>=b,g-=b),g<15&&(d+=M[r++]<<g,g+=8,d+=M[r++]<<g,g+=8),y=v[d&_];n:for(;;){if(d>>>=b=y>>>24,g-=b,!(16&(b=y>>>16&255))){if(0==(64&b)){y=v[(65535&y)+(d&(1<<b)-1)];continue n}t.msg="invalid distance code",n.mode=30;break t}if(w=65535&y,g<(b&=15)&&(d+=M[r++]<<g,(g+=8)<b&&(d+=M[r++]<<g,g+=8)),(w+=d&(1<<b)-1)>u){t.msg="invalid distance too far back",n.mode=30;break t}if(d>>>=b,g-=b,w>(b=o-a)){if((b=w-b)>h&&n.sane){t.msg="invalid distance too far back",n.mode=30;break t}if(T=0,E=f,0===c){if(T+=l-b,b<x){x-=b;do{S[o++]=f[T++]}while(--b);T=o-w,E=S}}else if(c<b){if(T+=l+c-b,(b-=c)<x){x-=b;do{S[o++]=f[T++]}while(--b);if(T=0,c<x){x-=b=c;do{S[o++]=f[T++]}while(--b);T=o-w,E=S}}}else if(T+=c-b,b<x){x-=b;do{S[o++]=f[T++]}while(--b);T=o-w,E=S}for(;x>2;)S[o++]=E[T++],S[o++]=E[T++],S[o++]=E[T++],x-=3;x&&(S[o++]=E[T++],x>1&&(S[o++]=E[T++]))}else{T=o-w;do{S[o++]=S[T++],S[o++]=S[T++],S[o++]=S[T++],x-=3}while(x>2);x&&(S[o++]=S[T++],x>1&&(S[o++]=S[T++]))}break}}break}}while(r<i&&o<s);r-=x=g>>3,d&=(1<<(g-=x<<3))-1,t.next_in=r,t.next_out=o,t.avail_in=r<i?i-r+5:5-(r-i),t.avail_out=o<s?s-o+257:257-(o-s),n.hold=d,n.bits=g}},function(t,e,n){"use strict";var r=n(19),i=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],o=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],a=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],s=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(t,e,n,u,l,h,c,f){var d,g,p,v,m,_,y,b,x,w=f.bits,T=0,E=0,M=0,S=0,L=0,A=0,R=0,P=0,C=0,I=0,F=null,k=0,D=new r.Buf16(16),O=new r.Buf16(16),U=null,z=0;for(T=0;T<=15;T++)D[T]=0;for(E=0;E<u;E++)D[e[n+E]]++;for(L=w,S=15;S>=1&&0===D[S];S--);if(L>S&&(L=S),0===S)return l[h++]=20971520,l[h++]=20971520,f.bits=1,0;for(M=1;M<S&&0===D[M];M++);for(L<M&&(L=M),P=1,T=1;T<=15;T++)if(P<<=1,(P-=D[T])<0)return-1;if(P>0&&(0===t||1!==S))return-1;for(O[1]=0,T=1;T<15;T++)O[T+1]=O[T]+D[T];for(E=0;E<u;E++)0!==e[n+E]&&(c[O[e[n+E]]++]=E);if(0===t?(F=U=c,_=19):1===t?(F=i,k-=257,U=o,z-=257,_=256):(F=a,U=s,_=-1),I=0,E=0,T=M,m=h,A=L,R=0,p=-1,v=(C=1<<L)-1,1===t&&C>852||2===t&&C>592)return 1;for(;;){y=T-R,c[E]<_?(b=0,x=c[E]):c[E]>_?(b=U[z+c[E]],x=F[k+c[E]]):(b=96,x=0),d=1<<T-R,M=g=1<<A;do{l[m+(I>>R)+(g-=d)]=y<<24|b<<16|x|0}while(0!==g);for(d=1<<T-1;I&d;)d>>=1;if(0!==d?(I&=d-1,I+=d):I=0,E++,0==--D[T]){if(T===S)break;T=e[n+c[E]]}if(T>L&&(I&v)!==p){for(0===R&&(R=L),m+=M,P=1<<(A=T-R);A+R<S&&!((P-=D[A+R])<=0);)A++,P<<=1;if(C+=1<<A,1===t&&C>852||2===t&&C>592)return 1;l[p=I&v]=L<<24|A<<16|m-h|0}}return 0!==I&&(l[m+I]=T-R<<24|64<<16|0),f.bits=L,0}},function(t,e,n){"use strict";t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},function(t,e,n){"use strict";(function(e){var r=n(5),i=n(36),o=n(37),a=t.exports=function(t){i.call(this);var n=[],r=this;this._filter=new o(t,{read:this.read.bind(this),write:function(t){n.push(t)},complete:function(){r.emit("complete",e.concat(n))}}),this._filter.start()};r.inherits(a,i)}).call(this,n(1).Buffer)},function(t,e,n){"use strict";(function(e){var r=n(5),i=n(16),o=n(14),a=n(44),s=t.exports=function(t){i.call(this);var e=t||{};this._packer=new a(e),this._deflate=this._packer.createDeflate(),this.readable=!0};r.inherits(s,i),s.prototype.pack=function(t,n,r,i){this.emit("data",new e(o.PNG_SIGNATURE)),this.emit("data",this._packer.packIHDR(n,r)),i&&this.emit("data",this._packer.packGAMA(i));var a=this._packer.filterData(t,n,r);this._deflate.on("error",this.emit.bind(this,"error")),this._deflate.on("data",function(t){this.emit("data",this._packer.packIDAT(t))}.bind(this)),this._deflate.on("end",function(){this.emit("data",this._packer.packIEND()),this.emit("end")}.bind(this)),this._deflate.end(a)}}).call(this,n(1).Buffer)},function(t,e,n){"use strict";(function(e){var r=n(14);t.exports=function(t,n,i,o){var a,s=-1!==[r.COLORTYPE_COLOR_ALPHA,r.COLORTYPE_ALPHA].indexOf(o.colorType);if(o.colorType===o.inputColorType){var u=(a=new ArrayBuffer(2),new DataView(a).setInt16(0,256,!0),256!==new Int16Array(a)[0]);if(8===o.bitDepth||16===o.bitDepth&&u)return t}var l=16!==o.bitDepth?t:new Uint16Array(t.buffer),h=255,c=r.COLORTYPE_TO_BPP_MAP[o.inputColorType];4!==c||o.inputHasAlpha||(c=3);var f=r.COLORTYPE_TO_BPP_MAP[o.colorType];16===o.bitDepth&&(h=65535,f*=2);var d=new e(n*i*f),g=0,p=0,v=o.bgColor||{};function m(){var t,e,n,i=h;switch(o.inputColorType){case r.COLORTYPE_COLOR_ALPHA:i=l[g+3],t=l[g],e=l[g+1],n=l[g+2];break;case r.COLORTYPE_COLOR:t=l[g],e=l[g+1],n=l[g+2];break;case r.COLORTYPE_ALPHA:i=l[g+1],e=t=l[g],n=t;break;case r.COLORTYPE_GRAYSCALE:e=t=l[g],n=t;break;default:throw new Error("input color type:"+o.inputColorType+" is not supported at present")}return o.inputHasAlpha&&(s||(i/=h,t=Math.min(Math.max(Math.round((1-i)*v.red+i*t),0),h),e=Math.min(Math.max(Math.round((1-i)*v.green+i*e),0),h),n=Math.min(Math.max(Math.round((1-i)*v.blue+i*n),0),h))),{red:t,green:e,blue:n,alpha:i}}void 0===v.red&&(v.red=h),void 0===v.green&&(v.green=h),void 0===v.blue&&(v.blue=h);for(var _=0;_<i;_++)for(var y=0;y<n;y++){var b=m();switch(o.colorType){case r.COLORTYPE_COLOR_ALPHA:case r.COLORTYPE_COLOR:8===o.bitDepth?(d[p]=b.red,d[p+1]=b.green,d[p+2]=b.blue,s&&(d[p+3]=b.alpha)):(d.writeUInt16BE(b.red,p),d.writeUInt16BE(b.green,p+2),d.writeUInt16BE(b.blue,p+4),s&&d.writeUInt16BE(b.alpha,p+6));break;case r.COLORTYPE_ALPHA:case r.COLORTYPE_GRAYSCALE:var x=(b.red+b.green+b.blue)/3;8===o.bitDepth?(d[p]=x,s&&(d[p+1]=b.alpha)):(d.writeUInt16BE(x,p),s&&d.writeUInt16BE(b.alpha,p+2));break;default:throw new Error("unrecognised color Type "+o.colorType)}g+=c,p+=f}return d}}).call(this,n(1).Buffer)},function(t,e,n){"use strict";(function(e){var r=n(39);var i={0:function(t,e,n,r,i){for(var o=0;o<n;o++)r[i+o]=t[e+o]},1:function(t,e,n,r,i,o){for(var a=0;a<n;a++){var s=a>=o?t[e+a-o]:0,u=t[e+a]-s;r[i+a]=u}},2:function(t,e,n,r,i){for(var o=0;o<n;o++){var a=e>0?t[e+o-n]:0,s=t[e+o]-a;r[i+o]=s}},3:function(t,e,n,r,i,o){for(var a=0;a<n;a++){var s=a>=o?t[e+a-o]:0,u=e>0?t[e+a-n]:0,l=t[e+a]-(s+u>>1);r[i+a]=l}},4:function(t,e,n,i,o,a){for(var s=0;s<n;s++){var u=s>=a?t[e+s-a]:0,l=e>0?t[e+s-n]:0,h=e>0&&s>=a?t[e+s-(n+a)]:0,c=t[e+s]-r(u,l,h);i[o+s]=c}}},o={0:function(t,e,n){for(var r=0,i=e+n,o=e;o<i;o++)r+=Math.abs(t[o]);return r},1:function(t,e,n,r){for(var i=0,o=0;o<n;o++){var a=o>=r?t[e+o-r]:0,s=t[e+o]-a;i+=Math.abs(s)}return i},2:function(t,e,n){for(var r=0,i=e+n,o=e;o<i;o++){var a=e>0?t[o-n]:0,s=t[o]-a;r+=Math.abs(s)}return r},3:function(t,e,n,r){for(var i=0,o=0;o<n;o++){var a=o>=r?t[e+o-r]:0,s=e>0?t[e+o-n]:0,u=t[e+o]-(a+s>>1);i+=Math.abs(u)}return i},4:function(t,e,n,i){for(var o=0,a=0;a<n;a++){var s=a>=i?t[e+a-i]:0,u=e>0?t[e+a-n]:0,l=e>0&&a>=i?t[e+a-(n+i)]:0,h=t[e+a]-r(s,u,l);o+=Math.abs(h)}return o}};t.exports=function(t,n,r,a,s){var u;if("filterType"in a&&-1!==a.filterType){if("number"!=typeof a.filterType)throw new Error("unrecognised filter types");u=[a.filterType]}else u=[0,1,2,3,4];16===a.bitDepth&&(s*=2);for(var l=n*s,h=0,c=0,f=new e((l+1)*r),d=u[0],g=0;g<r;g++){if(u.length>1)for(var p=1/0,v=0;v<u.length;v++){var m=o[u[v]](t,c,l,s);m<p&&(d=u[v],p=m)}f[h]=d,h++,i[d](t,c,l,f,h,s),h+=l,c+=l}return f}}).call(this,n(1).Buffer)},function(t,e,n){"use strict";var r=n(88),i=n(91);e.read=function(t,e){return r(t,e||{})},e.write=function(t,e){return i(t,e)}},function(t,e,n){"use strict";(function(e){var r=!0,i=n(13),o=n(89);i.deflateSync||(r=!1);var a=n(45),s=n(90),u=n(40),l=n(42),h=n(43);t.exports=function(t,n){if(!r)throw new Error("To use the sync capability of this library in old node versions, please pin pngjs to v2.3.0");var c,f,d;var g=[];var p=new a(t);if(new u(n,{read:p.read.bind(p),error:function(t){c=t},metadata:function(t){f=t},gamma:function(t){d=t},palette:function(t){f.palette=t},transColor:function(t){f.transColor=t},inflateData:function(t){g.push(t)},simpleTransparency:function(){f.alpha=!0}}).start(),p.process(),c)throw c;var v,m=e.concat(g);if(g.length=0,f.interlace)v=i.inflateSync(m);else{var _=(1+(f.width*f.bpp*f.depth+7>>3))*f.height;v=o(m,{chunkSize:_,maxLength:_})}if(m=null,!v||!v.length)throw new Error("bad png - invalid inflate data response");var y=s.process(v,f);m=null;var b=l.dataToBitMap(y,f);y=null;var x=h(b,f);return f.data=x,f.gamma=d||0,f}}).call(this,n(1).Buffer)},function(t,e,n){"use strict";(function(r,i){var o=n(23).ok,a=n(13),s=n(5),u=n(1).kMaxLength;function l(t){if(!(this instanceof l))return new l(t);t&&t.chunkSize<a.Z_MIN_CHUNK&&(t.chunkSize=a.Z_MIN_CHUNK),a.Inflate.call(this,t),this._offset=void 0===this._offset?this._outOffset:this._offset,this._buffer=this._buffer||this._outBuffer,t&&null!=t.maxLength&&(this._maxLength=t.maxLength)}function h(t,e){e&&r.nextTick(e),t._handle&&(t._handle.close(),t._handle=null)}function c(t,e){return function(t,e){if("string"==typeof e&&(e=i.from(e)),!(e instanceof i))throw new TypeError("Not a string or buffer");var n=t._finishFlushFlag;return null==n&&(n=a.Z_FINISH),t._processChunk(e,n)}(new l(e),t)}l.prototype._processChunk=function(t,e,n){if("function"==typeof n)return a.Inflate._processChunk.call(this,t,e,n);var r,s=this,l=t&&t.length,c=this._chunkSize-this._offset,f=this._maxLength,d=0,g=[],p=0;function v(t,e){if(!s._hadError){var n=c-e;if(o(n>=0,"have should not go down"),n>0){var r=s._buffer.slice(s._offset,s._offset+n);if(s._offset+=n,r.length>f&&(r=r.slice(0,f)),g.push(r),p+=r.length,0===(f-=r.length))return!1}return(0===e||s._offset>=s._chunkSize)&&(c=s._chunkSize,s._offset=0,s._buffer=i.allocUnsafe(s._chunkSize)),0===e&&(d+=l-t,l=t,!0)}}this.on("error",(function(t){r=t})),o(this._handle,"zlib binding closed");do{var m=this._handle.writeSync(e,t,d,l,this._buffer,this._offset,c);m=m||this._writeState}while(!this._hadError&&v(m[0],m[1]));if(this._hadError)throw r;if(p>=u)throw h(this),new RangeError("Cannot create final Buffer. It would be larger than 0x"+u.toString(16)+" bytes");var _=i.concat(g,p);return h(this),_},s.inherits(l,a.Inflate),t.exports=e=c,e.Inflate=l,e.createInflate=function(t){return new l(t)},e.inflateSync=c}).call(this,n(3),n(1).Buffer)},function(t,e,n){"use strict";(function(t){var r=n(45),i=n(37);e.process=function(e,n){var o=[],a=new r(e);return new i(n,{read:a.read.bind(a),write:function(t){o.push(t)},complete:function(){}}).start(),a.process(),t.concat(o)}}).call(this,n(1).Buffer)},function(t,e,n){"use strict";(function(e){var r=!0,i=n(13);i.deflateSync||(r=!1);var o=n(14),a=n(44);t.exports=function(t,n){if(!r)throw new Error("To use the sync capability of this library in old node versions, please pin pngjs to v2.3.0");var s=new a(n||{}),u=[];u.push(new e(o.PNG_SIGNATURE)),u.push(s.packIHDR(t.width,t.height)),t.gamma&&u.push(s.packGAMA(t.gamma));var l=s.filterData(t.data,t.width,t.height),h=i.deflateSync(l,s.getDeflateOptions());if(l=null,!h||!h.length)throw new Error("bad png - invalid compressed data response");return u.push(s.packIDAT(h)),u.push(s.packIEND()),e.concat(u)}}).call(this,n(1).Buffer)},function(t,e,n){"use strict";function r(t,e,n){if(void 0===n)return t&&t.h5s&&t.h5s.data&&t.h5s.data[e];t.h5s=t.h5s||{},t.h5s.data=t.h5s.data||{},t.h5s.data[e]=n}n.r(e);var i=function(t,e){if(!(t instanceof NodeList||t instanceof HTMLCollection||t instanceof Array))throw new Error("You must provide a nodeList/HTMLCollection/Array of elements to be filtered.");return"string"!=typeof e?Array.from(t):Array.from(t).filter((function(t){return 1===t.nodeType&&t.matches(e)}))},o=new Map,a=function(){function t(){this._config=new Map,this._placeholder=void 0,this._data=new Map}return Object.defineProperty(t.prototype,"config",{get:function(){var t={};return this._config.forEach((function(e,n){t[n]=e})),t},set:function(t){if("object"!=typeof t)throw new Error("You must provide a valid configuration object to the config setter.");var e=Object.assign({},t);this._config=new Map(Object.entries(e))},enumerable:!0,configurable:!0}),t.prototype.setConfig=function(t,e){if(!this._config.has(t))throw new Error("Trying to set invalid configuration item: "+t);this._config.set(t,e)},t.prototype.getConfig=function(t){if(!this._config.has(t))throw new Error("Invalid configuration item requested: "+t);return this._config.get(t)},Object.defineProperty(t.prototype,"placeholder",{get:function(){return this._placeholder},set:function(t){if(!(t instanceof HTMLElement)&&null!==t)throw new Error("A placeholder must be an html element or null.");this._placeholder=t},enumerable:!0,configurable:!0}),t.prototype.setData=function(t,e){if("string"!=typeof t)throw new Error("The key must be a string.");this._data.set(t,e)},t.prototype.getData=function(t){if("string"!=typeof t)throw new Error("The key must be a string.");return this._data.get(t)},t.prototype.deleteData=function(t){if("string"!=typeof t)throw new Error("The key must be a string.");return this._data.delete(t)},t}(),s=function(t){if(!(t instanceof HTMLElement))throw new Error("Please provide a sortable to the store function.");return o.has(t)||o.set(t,new a),o.get(t)};function u(t,e,n){if(t instanceof Array)for(var r=0;r<t.length;++r)u(t[r],e,n);else t.addEventListener(e,n),s(t).setData("event"+e,n)}function l(t,e){if(t instanceof Array)for(var n=0;n<t.length;++n)l(t[n],e);else t.removeEventListener(e,s(t).getData("event"+e)),s(t).deleteData("event"+e)}function h(t,e,n){if(t instanceof Array)for(var r=0;r<t.length;++r)h(t[r],e,n);else t.setAttribute(e,n)}function c(t,e){if(t instanceof Array)for(var n=0;n<t.length;++n)c(t[n],e);else t.removeAttribute(e)}var f=function(t){if(!t.parentElement||0===t.getClientRects().length)throw new Error("target element must be part of the dom");var e=t.getClientRects()[0];return{left:e.left+window.pageXOffset,right:e.right+window.pageXOffset,top:e.top+window.pageYOffset,bottom:e.bottom+window.pageYOffset}},d=function(t,e){var n;return void 0===e&&(e=0),function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];clearTimeout(n),n=setTimeout((function(){t.apply(void 0,r)}),e)}},g=function(t,e){if(!(t instanceof HTMLElement&&(e instanceof NodeList||e instanceof HTMLCollection||e instanceof Array)))throw new Error("You must provide an element and a list of elements.");return Array.from(e).indexOf(t)},p=function(t){if(!(t instanceof HTMLElement))throw new Error("Element is not a node element.");return null!==t.parentNode},v=function(t,e,n){if(!(t instanceof HTMLElement&&t.parentElement instanceof HTMLElement))throw new Error("target and element must be a node");t.parentElement.insertBefore(e,"before"===n?t:t.nextElementSibling)},m=function(t,e){return v(t,e,"before")},_=function(t,e){return v(t,e,"after")},y=function(t,e,n){if(void 0===e&&(e=function(t,e){return t}),void 0===n&&(n=function(t){return t}),!(t instanceof HTMLElement)||!0==!t.isSortable)throw new Error("You need to provide a sortableContainer to be serialized.");if("function"!=typeof e||"function"!=typeof n)throw new Error("You need to provide a valid serializer for items and the container.");var o=r(t,"opts").items,a=i(t.children,o),s=a.map((function(e){return{parent:t,node:e,html:e.outerHTML,index:g(e,a)}}));return{container:n({node:t,itemCount:s.length}),items:s.map((function(n){return e(n,t)}))}},b=function(t,e,n){var r;if(void 0===n&&(n="sortable-placeholder"),!(t instanceof HTMLElement))throw new Error("You must provide a valid element as a sortable.");if(!(e instanceof HTMLElement)&&void 0!==e)throw new Error("You must provide a valid element as a placeholder or set ot to undefined.");return void 0===e&&(["UL","OL"].includes(t.tagName)?e=document.createElement("li"):["TABLE","TBODY"].includes(t.tagName)?(e=document.createElement("tr")).innerHTML='<td colspan="100"></td>':e=document.createElement("div")),"string"==typeof n&&(r=e.classList).add.apply(r,n.split(" ")),e},x=function(t){if(!(t instanceof HTMLElement))throw new Error("You must provide a valid dom element");var e=window.getComputedStyle(t);return["height","padding-top","padding-bottom"].map((function(t){var n=parseInt(e.getPropertyValue(t),10);return isNaN(n)?0:n})).reduce((function(t,e){return t+e}))},w=function(t){if(!(t instanceof HTMLElement))throw new Error("You must provide a valid dom element");var e=window.getComputedStyle(t);return["width","padding-left","padding-right"].map((function(t){var n=parseInt(e.getPropertyValue(t),10);return isNaN(n)?0:n})).reduce((function(t,e){return t+e}))},T=function(t,e){if(!(t instanceof Array))throw new Error("You must provide a Array of HTMLElements to be filtered.");return"string"!=typeof e?t:t.filter((function(t){return t.querySelector(e)instanceof HTMLElement||t.shadowRoot&&t.shadowRoot.querySelector(e)instanceof HTMLElement})).map((function(t){return t.querySelector(e)||t.shadowRoot&&t.shadowRoot.querySelector(e)}))},E=function(t){return t.composedPath&&t.composedPath()[0]||t.target},M=function(t,e,n){return{element:t,posX:n.pageX-e.left,posY:n.pageY-e.top}},S=function(t,e,n){if(!(t instanceof Event))throw new Error("setDragImage requires a DragEvent as the first argument.");if(!(e instanceof HTMLElement))throw new Error("setDragImage requires the dragged element as the second argument.");if(n||(n=M),t.dataTransfer&&t.dataTransfer.setDragImage){var r=n(e,f(e),t);if(!(r.element instanceof HTMLElement)||"number"!=typeof r.posX||"number"!=typeof r.posY)throw new Error("The customDragImage function you provided must return and object with the properties element[string], posX[integer], posY[integer].");t.dataTransfer.effectAllowed="copyMove",t.dataTransfer.setData("text/plain",E(t).id),t.dataTransfer.setDragImage(r.element,r.posX,r.posY)}},L=function(t,e){if(!0===t.isSortable){var n=s(t).getConfig("acceptFrom");if(null!==n&&!1!==n&&"string"!=typeof n)throw new Error('HTML5Sortable: Wrong argument, "acceptFrom" must be "null", "false", or a valid selector string.');if(null!==n)return!1!==n&&n.split(",").filter((function(t){return t.length>0&&e.matches(t)})).length>0;if(t===e)return!0;if(void 0!==s(t).getConfig("connectWith")&&null!==s(t).getConfig("connectWith"))return s(t).getConfig("connectWith")===s(e).getConfig("connectWith")}return!1},A={items:null,connectWith:null,disableIEFix:null,acceptFrom:null,copy:!1,placeholder:null,placeholderClass:"sortable-placeholder",draggingClass:"sortable-dragging",hoverClass:!1,debounce:0,throttleTime:100,maxItems:0,itemSerializer:void 0,containerSerializer:void 0,customDragImage:null,orientation:"vertical"};var R,P,C,I,F,k,D,O,U,z=function(t,e){if("string"==typeof s(t).getConfig("hoverClass")){var n=s(t).getConfig("hoverClass").split(" ");!0===e?(u(t,"mousemove",function(t,e){var n=this;if(void 0===e&&(e=250),"function"!=typeof t)throw new Error("You must provide a function as the first argument for throttle.");if("number"!=typeof e)throw new Error("You must provide a number as the second argument for throttle.");var r=null;return function(){for(var i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];var a=Date.now();(null===r||a-r>=e)&&(r=a,t.apply(n,i))}}((function(e){0===e.buttons&&i(t.children,s(t).getConfig("items")).forEach((function(t){var r,i;t!==e.target?(r=t.classList).remove.apply(r,n):(i=t.classList).add.apply(i,n)}))}),s(t).getConfig("throttleTime"))),u(t,"mouseleave",(function(){i(t.children,s(t).getConfig("items")).forEach((function(t){var e;(e=t.classList).remove.apply(e,n)}))}))):(l(t,"mousemove"),l(t,"mouseleave"))}},B=function(t){l(t,"dragstart"),l(t,"dragend"),l(t,"dragover"),l(t,"dragenter"),l(t,"drop"),l(t,"mouseenter"),l(t,"mouseleave")},H=function(t,e){var n=t;return!0===s(e).getConfig("copy")&&(h(n=t.cloneNode(!0),"aria-copied","true"),t.parentElement.appendChild(n),n.style.display="none",n.oldDisplay=t.style.display),n},N=function(t){var e;(e=t).h5s&&delete e.h5s.data,c(t,"aria-dropeffect")},G=function(t){c(t,"aria-grabbed"),c(t,"aria-copied"),c(t,"draggable"),c(t,"role")};function j(t,e){if(e.composedPath)return e.composedPath().find((function(t){return t.isSortable}));for(;!0!==t.isSortable;)t=t.parentElement;return t}function W(t,e){var n=r(t,"opts"),o=i(t.children,n.items).filter((function(t){return t.contains(e)||t.shadowRoot&&t.shadowRoot.contains(e)}));return o.length>0?o[0]:e}var X=function(t){var e=r(t,"opts"),n=i(t.children,e.items),o=T(n,e.handle);(h(t,"aria-dropeffect","move"),r(t,"_disabled","false"),h(o,"draggable","true"),!1===e.disableIEFix)&&("function"==typeof(document||window.document).createElement("span").dragDrop&&u(o,"mousedown",(function(){if(-1!==n.indexOf(this))this.dragDrop();else{for(var t=this.parentElement;-1===n.indexOf(t);)t=t.parentElement;t.dragDrop()}})))},Y=function(t){var e=r(t,"opts"),n=i(t.children,e.items),o=T(n,e.handle);r(t,"_disabled","false"),B(n),l(o,"mousedown"),l(t,"dragover"),l(t,"dragenter"),l(t,"drop")};function q(t,e){var n=String(e);return e=e||{},"string"==typeof t&&(t=document.querySelectorAll(t)),t instanceof HTMLElement&&(t=[t]),t=Array.prototype.slice.call(t),/serialize/.test(n)?t.map((function(t){var e=r(t,"opts");return y(t,e.itemSerializer,e.containerSerializer)})):(t.forEach((function(t){if(/enable|disable|destroy/.test(n))return q[n](t);["connectWith","disableIEFix"].forEach((function(t){Object.prototype.hasOwnProperty.call(e,t)&&null!==e[t]&&console.warn('HTML5Sortable: You are using the deprecated configuration "'+t+'". This will be removed in an upcoming version, make sure to migrate to the new options when updating.')})),e=Object.assign({},A,s(t).config,e),s(t).config=e,r(t,"opts",e),t.isSortable=!0,Y(t);var a,l=i(t.children,e.items);if(null!==e.placeholder&&void 0!==e.placeholder){var c=document.createElement(t.tagName);e.placeholder instanceof HTMLElement?c.appendChild(e.placeholder):c.innerHTML=e.placeholder,a=c.children[0]}s(t).placeholder=b(t,a,e.placeholderClass),r(t,"items",e.items),e.acceptFrom?r(t,"acceptFrom",e.acceptFrom):e.connectWith&&r(t,"connectWith",e.connectWith),X(t),h(l,"role","option"),h(l,"aria-grabbed","false"),z(t,!0),u(t,"dragstart",(function(t){var n=E(t);if(!0!==n.isSortable&&(t.stopImmediatePropagation(),(!e.handle||n.matches(e.handle))&&"false"!==n.getAttribute("draggable"))){var r=j(n,t),o=W(r,n);D=i(r.children,e.items),F=D.indexOf(o),k=g(o,r.children),I=r,S(t,o,e.customDragImage),P=x(o),C=w(o),o.classList.add(e.draggingClass),h(R=H(o,r),"aria-grabbed","true"),r.dispatchEvent(new CustomEvent("sortstart",{detail:{origin:{elementIndex:k,index:F,container:I},item:R,originalTarget:n}}))}})),u(t,"dragenter",(function(e){var n=E(e),o=j(n,e);o&&o!==O&&(U=i(o.children,r(o,"items")).filter((function(e){return e!==s(t).placeholder})),o.dispatchEvent(new CustomEvent("sortenter",{detail:{origin:{elementIndex:k,index:F,container:I},destination:{container:o,itemsBeforeUpdate:U},item:R,originalTarget:n}}))),O=o})),u(t,"dragend",(function(n){if(R){R.classList.remove(e.draggingClass),h(R,"aria-grabbed","false"),"true"===R.getAttribute("aria-copied")&&"true"!==r(R,"dropped")&&R.remove(),R.style.display=R.oldDisplay,delete R.oldDisplay;var i=Array.from(o.values()).map((function(t){return t.placeholder})).filter((function(t){return t instanceof HTMLElement})).filter(p)[0];i&&i.remove(),t.dispatchEvent(new CustomEvent("sortstop",{detail:{origin:{elementIndex:k,index:F,container:I},item:R}})),O=null,R=null,P=null,C=null}})),u(t,"drop",(function(n){if(L(t,R.parentElement)){n.preventDefault(),n.stopPropagation(),r(R,"dropped","true");var a=Array.from(o.values()).map((function(t){return t.placeholder})).filter((function(t){return t instanceof HTMLElement})).filter(p)[0];_(a,R),a.remove(),t.dispatchEvent(new CustomEvent("sortstop",{detail:{origin:{elementIndex:k,index:F,container:I},item:R}}));var u=s(t).placeholder,l=i(I.children,e.items).filter((function(t){return t!==u})),h=!0===this.isSortable?this:this.parentElement,c=i(h.children,r(h,"items")).filter((function(t){return t!==u})),f=g(R,Array.from(R.parentElement.children).filter((function(t){return t!==u}))),d=g(R,c);k===f&&I===h||t.dispatchEvent(new CustomEvent("sortupdate",{detail:{origin:{elementIndex:k,index:F,container:I,itemsBeforeUpdate:D,items:l},destination:{index:d,elementIndex:f,container:h,itemsBeforeUpdate:U,items:c},item:R}}))}}));var v=d((function(t,n,r,a){if(R)if(e.forcePlaceholderSize&&(s(t).placeholder.style.height=P+"px",s(t).placeholder.style.width=C+"px"),Array.from(t.children).indexOf(n)>-1){var u=x(n),l=w(n),h=g(s(t).placeholder,n.parentElement.children),c=g(n,n.parentElement.children);if(u>P||l>C){var d=u-P,p=l-C,v=f(n).top,y=f(n).left;if(h<c&&("vertical"===e.orientation&&a<v||"horizontal"===e.orientation&&r<y))return;if(h>c&&("vertical"===e.orientation&&a>v+u-d||"horizontal"===e.orientation&&r>y+l-p))return}void 0===R.oldDisplay&&(R.oldDisplay=R.style.display),"none"!==R.style.display&&(R.style.display="none");var b=!1;try{var T=f(n).top+n.offsetHeight/2,E=f(n).left+n.offsetWidth/2;b="vertical"===e.orientation&&a>=T||"horizontal"===e.orientation&&r>=E}catch(t){b=h<c}b?_(n,s(t).placeholder):m(n,s(t).placeholder),Array.from(o.values()).filter((function(t){return void 0!==t.placeholder})).forEach((function(e){e.placeholder!==s(t).placeholder&&e.placeholder.remove()}))}else{var M=Array.from(o.values()).filter((function(t){return void 0!==t.placeholder})).map((function(t){return t.placeholder}));-1!==M.indexOf(n)||t!==n||i(n.children,e.items).length||(M.forEach((function(t){return t.remove()})),n.appendChild(s(t).placeholder))}}),e.debounce),y=function(t){var e=t.target,n=!0===e.isSortable?e:j(e,t);if(e=W(n,e),R&&L(n,R.parentElement)&&"true"!==r(n,"_disabled")){var o=r(n,"opts");parseInt(o.maxItems)&&i(n.children,r(n,"items")).length>=parseInt(o.maxItems)&&R.parentElement!==n||(t.preventDefault(),t.stopPropagation(),t.dataTransfer.dropEffect=!0===s(n).getConfig("copy")?"copy":"move",v(n,e,t.pageX,t.pageY))}};u(l.concat(t),"dragover",y),u(l.concat(t),"dragenter",y)})),t)}q.destroy=function(t){!function(t){var e=r(t,"opts")||{},n=i(t.children,e.items),o=T(n,e.handle);l(t,"dragover"),l(t,"dragenter"),l(t,"dragstart"),l(t,"dragend"),l(t,"drop"),N(t),l(o,"mousedown"),B(n),G(n),t.isSortable=!1}(t)},q.enable=function(t){X(t)},q.disable=function(t){!function(t){var e=r(t,"opts"),n=i(t.children,e.items),o=T(n,e.handle);h(t,"aria-dropeffect","none"),r(t,"_disabled","true"),h(o,"draggable","false"),l(o,"mousedown")}(t)},q.__testing={_data:r,_removeItemEvents:B,_removeItemData:G,_removeSortableData:N},e.default=q},function(t,e,n){"use strict";e.__esModule=!0;var r=n(15),i=[],o=document.getElementById("alert"),a=o.querySelector("span"),s=o.querySelectorAll("button");function u(){var t;0===i.length?o.setAttribute("hidden","true"):(a.innerHTML=i[0].message,t=i[0].type,r.show(s[0],0===t||1===t),r.show(s[1],2===t||3===t),r.show(s[2],2===t||3===t),r.show(s[3],1===t||3===t),o.removeAttribute("hidden"))}s.forEach((function(t,e){t.onclick=function(){i[0]&&i[0].callback&&i[0].callback(e),i.shift(),o.setAttribute("hidden","true"),setTimeout(u,160)}})),function(t){t[t.Ok=0]="Ok",t[t.Yes=1]="Yes",t[t.No=2]="No",t[t.Cancel=3]="Cancel"}(e.AlertButton||(e.AlertButton={})),function(t){t[t.Ok=0]="Ok",t[t.OkCancel=1]="OkCancel",t[t.YesNo=2]="YesNo",t[t.YesNoCancel=3]="YesNoCancel"}(e.AlertType||(e.AlertType={})),e.showAlert=function(t,e,n){i.push({message:t,type:e,callback:n}),u()}},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});e.__esModule=!0;var o=n(9),a=n(15),s=function(t){function e(e,n){void 0===n&&(n="span");var r=t.call(this)||this;if("string"==typeof e){var i=document.querySelector(e);if(!i)throw new Error("Could't find element with selector: "+e);r.element=i}else r.element=e;r.children=r.element.querySelectorAll(n);for(var o=0;o<r.children.length;++o)r.children[o].addEventListener("click",r.select.bind(r,o));return r}return i(e,t),e.prototype.select=function(t){for(var e=0;e<this.children.length;++e)this.children[e].removeAttribute("selected");this.children[t].setAttribute("selected","true"),this.emit("change",t)},e.prototype.hide=function(t){a.hide(this.element,t)},e.prototype.getElement=function(){return this.element},e.prototype.getChildren=function(){return this.children},e}(o.EventEmitter);e.default=s},function(t,e,n){"use strict";e.__esModule=!0,e.createRandom=function(t){for(var e=0,n=1779033703^t.length;e<t.length;e++)n=(n=Math.imul(n^t.charCodeAt(e),3432918353))<<13|n>>>19;n=Math.imul(n^n>>>16,2246822507),n=Math.imul(n^n>>>13,3266489909);var r=(n^=n>>>16)>>>0;n=Math.imul(n^n>>>16,2246822507),n=Math.imul(n^n>>>13,3266489909);var i=(n^=n>>>16)>>>0;n=Math.imul(n^n>>>16,2246822507),n=Math.imul(n^n>>>13,3266489909);var o=(n^=n>>>16)>>>0;n=Math.imul(n^n>>>16,2246822507),n=Math.imul(n^n>>>13,3266489909);var a=(n^=n>>>16)>>>0;return function(){var t=(r>>>=0)+(i>>>=0)|0;return r=i^i>>>9,i=(o>>>=0)+(o<<3)|0,o=(o=o<<21|o>>>11)+(t=t+(a=(a>>>=0)+1|0)|0)|0,(t>>>0)/4294967296}}},function(t,e,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};e.__esModule=!0;var i=n(8),o=n(48),a={87:[0,0,-1],65:[-1,0,0],83:[0,0,1],68:[1,0,0],67:[0,-1,0],32:[0,1,0]},s=r({},a),u=function(){function t(t,e){var n=this;this.mouse={canvas:{last:[0,0],current:[0,0],over:!1},terrain:{input:[0,0],last:[0,0],current:[0,0],over:!1},button:0,buttonDown:!1},this.keyDown={},this.fpsMode=!0,this.isRunning=!1,this.camera=t,this.cameraController=new o.CameraController(this.camera,[512,100,256],1100,.25*Math.PI,-Math.PI),this.canvas=e;var r=this.mouseUp.bind(this),i=this.mouseMove.bind(this),a=this.mouseDown.bind(this);document.oncontextmenu=function(){return!1},e.addEventListener("mousedown",a),e.addEventListener("touchstart",a),document.addEventListener("mousemove",i),document.addEventListener("touchmove",i),document.addEventListener("mouseup",r),document.addEventListener("touchend",r),document.addEventListener("touchcancel",r),e.addEventListener("mouseleave",(function(){n.mouse.canvas.over=!1})),e.addEventListener("wheel",(function(t){n.fpsMode||n.cameraController.updateArcBall([0,0,0],[0,0],.1*Math.sign(t.deltaY)),t.preventDefault(),t.stopPropagation()})),window.addEventListener("keydown",this.keyboardChange.bind(this,!0)),window.addEventListener("keyup",this.keyboardChange.bind(this,!1)),window.addEventListener("blur",(function(){n.keyDown={}}))}return t.prototype.keyboardChange=function(t,e){e.keyCode in s&&(this.keyDown[e.keyCode]=t),t||82!==e.keyCode||(this.isRunning=!this.isRunning)},t.prototype.mouseDown=function(t){var e=t.clientX||t.targetTouches&&t.targetTouches[0].pageX||0,n=t.clientY||t.targetTouches&&t.targetTouches[0].pageY||0;this.mouse.canvas.current[0]=e,this.mouse.canvas.current[1]=n,this.mouse.canvas.last[0]=e,this.mouse.canvas.last[1]=n,this.mouse.terrain.current[0]=this.mouse.terrain.input[0],this.mouse.terrain.current[1]=this.mouse.terrain.input[1],this.mouse.terrain.last[0]=this.mouse.terrain.input[0],this.mouse.terrain.last[1]=this.mouse.terrain.input[1],this.mouse.buttonDown=!0,this.mouse.button=t.button},t.prototype.mouseMove=function(t){if(this.mouse.canvas.last[0]=this.mouse.canvas.current[0],this.mouse.canvas.last[1]=this.mouse.canvas.current[1],this.mouse.canvas.current[0]=t.clientX||t.targetTouches&&t.targetTouches[0].pageX||0,this.mouse.canvas.current[1]=t.clientY||t.targetTouches&&t.targetTouches[0].pageY||0,this.mouse.terrain.over?(this.mouse.terrain.last[0]=this.mouse.terrain.current[0],this.mouse.terrain.last[1]=this.mouse.terrain.current[1]):(this.mouse.terrain.last[0]=this.mouse.terrain.input[0],this.mouse.terrain.last[1]=this.mouse.terrain.input[1]),this.mouse.terrain.current[0]=this.mouse.terrain.input[0],this.mouse.terrain.current[1]=this.mouse.terrain.input[1],this.mouse.terrain.over=!(!this.mouse.terrain.input[0]&&!this.mouse.terrain.input[1]),this.mouse.buttonDown){var e=this.mouse.canvas.last[0]-this.mouse.canvas.current[0],n=this.mouse.canvas.last[1]-this.mouse.canvas.current[1];2===this.mouse.button?this.fpsMode?this.cameraController.updateFPS([0,0,0],-.0075*n,-.0075*e):this.cameraController.updateArcBall([0,0,0],[.0075*e,.0075*n],0):1!==this.mouse.button||this.fpsMode||this.cameraController.updateArcBall([e,0,n],[0,0],0)}this.mouse.canvas.over=!0},t.prototype.mouseUp=function(t){this.mouse.buttonDown=!1},t.prototype.setTerrainMousePos=function(t){this.mouse.terrain.input[0]=t[0],this.mouse.terrain.input[1]=t[2]},t.prototype.update=function(t,e){for(var n in a)if(this.keyDown[n]){var r=.5*e;this.isRunning&&(r*=3),this.fpsMode||(r*=.5);var o=i.vec3.scale([0,0,0],a[n],r);this.fpsMode?this.cameraController.updateFPS(o,0,0):this.cameraController.updateArcBall(o,[0,0],0)}},t.prototype.setFpsMode=function(t){this.fpsMode=t,this.fpsMode?this.cameraController.updateFPS([0,0,0],0,0):this.cameraController.updateArcBall([0,0,0],[0,0],0)},t.prototype.isFpsMode=function(){return this.fpsMode},t}();e.default=u},function(t,e,n){"use strict";e.__esModule=!0;var r=n(98),i=n(0),o=n(4),a=n(24),s=n(99),u=n(101),l=n(103),h=n(105),c=n(107),f=n(109),d=n(111),g=n(26),p=n(113),v=n(2),m=n(115),_=function(){function t(t){var e=this;this.size=[1024,1024],this.passQueue=[],this.framebuffer=new r.default,this.textures={heightMap:new a.PingPongTexture,waterHeightMap:new a.PingPongTexture,sedimentHardnessMap:new a.PingPongTexture,waterFluxMap:new a.PingPongTexture,waterVelocityMap:new a.default,soilFluxPlusMap:new a.default,soilFluxCrossMap:new a.default,shadowMap:new a.default,layers:t,brushes:a.default.fromRGBAImage("/data/brushes/brushes.png")},this.perlinPass=new m.PerlinPass,this.invertPass=new v.InvertPass,this.heightBrushPass=new g.HeightBrushPass,this.layerBrushPass=new p.LayerBrushPass,this.generateSurfacePass=new d.GenerateSurfacePass,this.erosionWaterFluxPass=new c.ErosionWaterFluxPass,this.erosionSuspensionDepositionPass=new h.ErosionSuspensionDepositionPass,this.erosionSedimentAdvectionPass=new s.ErosionSedimentAdvectionPass,this.erosionSoilFluxPass=new l.ErosionSoilFluxPass,this.erosionSoilAdvectionPass=new u.ErosionSoilAdvectionPass,this.generateHardnessPass=new f.GenerateHardnessPass,this.textures.heightMap.initialize((function(t){return t.updateFloatRedData(e.size,null)})),this.textures.waterHeightMap.initialize((function(t){return t.updateFloatRedData(e.size,null)})),this.textures.sedimentHardnessMap.initialize((function(t){return t.updateFloatRGData(e.size,null)})),this.textures.waterFluxMap.initialize((function(t){return t.updateFloatRGBAData(e.size,null)})),this.textures.waterVelocityMap.updateFloatRGData(this.size,null),this.textures.soilFluxPlusMap.updateFloatRGBAData(this.size,null),this.textures.soilFluxCrossMap.updateFloatRGBAData(this.size,null),this.textures.shadowMap.updateFloatRedData(this.size,null),this.framebuffer.setColorAttachment(this.textures.heightMap.current()),r.default.unbind(),o.default.checkGLError()}return t.prototype.queuePass=function(t){this.passQueue.push(t)},t.prototype.render=function(){if(o.default.checkGLError(),0!==this.passQueue.length){var t;for(i.gl.disable(i.gl.DEPTH_TEST),this.framebuffer.bind(),o.default.checkGLError();t=this.passQueue.shift();)o.default.checkGLError(),o.default.checkGLError(),t.shader.use(),t.initalizePass(this.textures,this.framebuffer),i.gl.drawArrays(i.gl.TRIANGLES,0,3),t.finalizePass(this.framebuffer);r.default.unbind(),i.gl.enable(i.gl.DEPTH_TEST)}},t.prototype.getHeightMapData=function(){var t=i.gl.createFramebuffer();i.gl.bindFramebuffer(i.gl.FRAMEBUFFER,t),i.gl.viewport(0,0,this.size[0],this.size[1]);var e=new Float32Array(this.size[0]*this.size[1]),n=this.textures.heightMap.current().id;return i.gl.framebufferTexture2D(i.gl.FRAMEBUFFER,i.gl.COLOR_ATTACHMENT0,i.gl.TEXTURE_2D,n,0),i.gl.readPixels(0,0,this.size[0],this.size[1],i.gl.RED,i.gl.FLOAT,e),i.gl.deleteFramebuffer(t),r.default.unbind(),e},t.prototype.getLayerWeightData=function(){var t=i.gl.createFramebuffer();i.gl.bindFramebuffer(i.gl.FRAMEBUFFER,t),i.gl.viewport(0,0,this.size[0],this.size[1]);var e=new Float32Array(this.size[0]*this.size[1]*4),n=new Float32Array(this.size[0]*this.size[1]*4);return i.gl.framebufferTextureLayer(i.gl.FRAMEBUFFER,i.gl.COLOR_ATTACHMENT0,this.textures.layers.weightMapCurrent,0,0),i.gl.readPixels(0,0,this.size[0],this.size[1],i.gl.RGBA,i.gl.FLOAT,e),i.gl.framebufferTextureLayer(i.gl.FRAMEBUFFER,i.gl.COLOR_ATTACHMENT0,this.textures.layers.weightMapCurrent,0,1),i.gl.readPixels(0,0,this.size[0],this.size[1],i.gl.RGBA,i.gl.FLOAT,n),i.gl.deleteFramebuffer(t),r.default.unbind(),[e,n]},t.prototype.setHeightMapData=function(t){if(t.length!==this.size[0]*this.size[1])throw new Error("setHeightMapData data is wrong size");this.textures.heightMap.current().updateFloatRedData(this.size,t)},t.prototype.setLayerWeightData=function(t){if(t[0].length!==this.size[0]*this.size[1]*4||t[1].length!==this.size[0]*this.size[1]*4)throw new Error("setLayerWeightData datas are wrong size");i.gl.activeTexture(i.gl.TEXTURE0),i.gl.bindTexture(i.gl.TEXTURE_2D_ARRAY,this.textures.layers.weightMapCurrent),i.gl.texSubImage3D(i.gl.TEXTURE_2D_ARRAY,0,0,0,0,this.size[0],this.size[1],1,i.gl.RGBA,i.gl.FLOAT,t[0]),i.gl.texSubImage3D(i.gl.TEXTURE_2D_ARRAY,0,0,0,1,this.size[0],this.size[1],1,i.gl.RGBA,i.gl.FLOAT,t[1])},t}();e.default=_},function(t,e,n){"use strict";e.__esModule=!0;var r=n(0),i=function(){function t(){this.size=[0,0],this.id=r.gl.createFramebuffer()}return t.prototype.bind=function(){r.gl.viewport(0,0,this.size[0],this.size[1]),r.gl.bindFramebuffer(r.gl.FRAMEBUFFER,this.id)},t.unbind=function(){r.gl.viewport(0,0,r.gl.canvas.width,r.gl.canvas.height),r.gl.bindFramebuffer(r.gl.FRAMEBUFFER,null)},t.prototype.setColorAttachment=function(t,e){void 0===e&&(e=0),this.size[0]=t.size[0],this.size[1]=t.size[1],this.bind(),r.gl.framebufferTexture2D(r.gl.FRAMEBUFFER,r.gl.COLOR_ATTACHMENT0+e,r.gl.TEXTURE_2D,t.id,0)},t.prototype.unsetColorAttachment=function(t){this.bind(),r.gl.framebufferTexture2D(r.gl.FRAMEBUFFER,r.gl.COLOR_ATTACHMENT0+t,r.gl.TEXTURE_2D,null,0)},t}();e.default=i},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});e.__esModule=!0;var o=n(0),a=n(4),s=n(2),u=n(100).default,l=function(t){function e(){var e=t.call(this,u)||this;return e.uSedimentHardnessTextureLocation2=e.shader.getUniformLocation("uSedimentHardnessTexture"),e.uVelocityTextureLocation2=e.shader.getUniformLocation("uVelocityTexture"),e.uDeltaTimeLocation2=e.shader.getUniformLocation("uDeltaTime"),e.uTexelSizeInMetersLocation2=e.shader.getUniformLocation("uTexelSizeInMeters"),e}return i(e,t),e.prototype.initalizePass=function(t,e){a.default.checkGLError(),this.shader.setUniformI(this.uSedimentHardnessTextureLocation2,0),this.shader.setUniformI(this.uVelocityTextureLocation2,1),this.shader.setUniformF(this.uDeltaTimeLocation2,o.erosionParams.deltaTime),this.shader.setUniformF(this.uTexelSizeInMetersLocation2,o.erosionParams.pipeLength),a.default.checkGLError(),t.sedimentHardnessMap.current().bind(0),t.waterVelocityMap.bind(1),a.default.checkGLError(),e.setColorAttachment(t.sedimentHardnessMap.next(),0),o.gl.drawBuffers([o.gl.COLOR_ATTACHMENT0]),a.default.checkGLError()},e.prototype.finalizePass=function(t){a.default.checkGLError(),t.unsetColorAttachment(0),a.default.checkGLError()},e}(s.Pass);e.ErosionSedimentAdvectionPass=l},function(t,e,n){"use strict";n.r(e),e.default="#version 300 es\nprecision highp float;\n\nin vec2 vCoords;\n\nlayout (location = 0) out vec4 oSedimentHardness;\n\nuniform sampler2D uSedimentHardnessTexture;\nuniform sampler2D uVelocityTexture;\nuniform float uDeltaTime;\nuniform float uTexelSizeInMeters;\n\nvoid main(void) {\n\t// move sediment\n\tvec2 velocity = texelFetch(uVelocityTexture, ivec2(gl_FragCoord.xy), 0).xy * uDeltaTime;\n\tvec2 texelSize = 1.0 / vec2(textureSize(uSedimentHardnessTexture, 0).xy);\n\tvec2 texCoord = vCoords - velocity / uTexelSizeInMeters * texelSize;\n\tfloat sediment = textureLod(uSedimentHardnessTexture, texCoord, 0.0).x;\n\toSedimentHardness = vec4(sediment, texelFetch(uSedimentHardnessTexture, ivec2(gl_FragCoord.xy), 0).y, 0.0, 1.0);\n}"},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});e.__esModule=!0;var o=n(0),a=n(4),s=n(2),u=n(102).default,l=function(t){function e(){var e=t.call(this,u)||this;return e.uTerrainHeightTextureLocation=e.shader.getUniformLocation("uTerrainHeightTexture"),e.uSoilFluxPlusTextureLocation=e.shader.getUniformLocation("uSoilFluxPlusTexture"),e.uSoilFluxCrossTextureLocation=e.shader.getUniformLocation("uSoilFluxCrossTexture"),e}return i(e,t),e.prototype.initalizePass=function(t,e){a.default.checkGLError(),this.shader.setUniformI(this.uTerrainHeightTextureLocation,0),this.shader.setUniformI(this.uSoilFluxPlusTextureLocation,1),this.shader.setUniformI(this.uSoilFluxCrossTextureLocation,2),a.default.checkGLError(),t.heightMap.current().bind(0),t.soilFluxPlusMap.bind(1),t.soilFluxCrossMap.bind(2),a.default.checkGLError(),e.setColorAttachment(t.heightMap.next(),0),o.gl.drawBuffers([o.gl.COLOR_ATTACHMENT0]),a.default.checkGLError()},e.prototype.finalizePass=function(t){a.default.checkGLError(),t.unsetColorAttachment(0),a.default.checkGLError()},e}(s.Pass);e.ErosionSoilAdvectionPass=l},function(t,e,n){"use strict";n.r(e),e.default="#version 300 es\nprecision highp float;\n\nin vec2 vCoords;\n\nlayout (location = 0) out vec4 oTerrainHeight;\n\nuniform sampler2D uTerrainHeightTexture;\nuniform sampler2D uSoilFluxPlusTexture;\nuniform sampler2D uSoilFluxCrossTexture;\n\nvoid main(void) {\n\tvec4 plusInflowingFlux;\n\tplusInflowingFlux.x = texelFetch(uSoilFluxPlusTexture, ivec2(gl_FragCoord.xy) + ivec2(-1, 0), 0).y;\n\tplusInflowingFlux.y = texelFetch(uSoilFluxPlusTexture, ivec2(gl_FragCoord.xy) + ivec2( 1, 0), 0).x;\n\tplusInflowingFlux.z = texelFetch(uSoilFluxPlusTexture, ivec2(gl_FragCoord.xy) + ivec2( 0, 1), 0).w;\n\tplusInflowingFlux.w = texelFetch(uSoilFluxPlusTexture, ivec2(gl_FragCoord.xy) + ivec2( 0,-1), 0).z;\n\n\tvec4 plusOutflowingFlux = texelFetch(uSoilFluxPlusTexture, ivec2(gl_FragCoord.xy), 0);\n\tfloat plusInflowingSoil = plusInflowingFlux.x + plusInflowingFlux.y + plusInflowingFlux.z + plusInflowingFlux.w;\n\tfloat plusOutflowingSoil = plusOutflowingFlux.x + plusOutflowingFlux.y + plusOutflowingFlux.z + plusOutflowingFlux.w;\n\tfloat plusVolumeChange = plusInflowingSoil - plusOutflowingSoil;\n\n\tfloat terrainHeight = texelFetch(uTerrainHeightTexture, ivec2(gl_FragCoord.xy), 0).x;\n\n\tterrainHeight += plusVolumeChange;\n\n\tvec4 crossInflowingFlux;\n\tcrossInflowingFlux.x = texelFetch(uSoilFluxCrossTexture, ivec2(gl_FragCoord.xy) + ivec2(-1,  1), 0).y;\n\tcrossInflowingFlux.y = texelFetch(uSoilFluxCrossTexture, ivec2(gl_FragCoord.xy) + ivec2( 1, -1), 0).x;\n\tcrossInflowingFlux.z = texelFetch(uSoilFluxCrossTexture, ivec2(gl_FragCoord.xy) + ivec2( 1,  1), 0).w;\n\tcrossInflowingFlux.w = texelFetch(uSoilFluxCrossTexture, ivec2(gl_FragCoord.xy) + ivec2(-1, -1), 0).z;\n\n\tvec4 crossOutflowingFlux = texelFetch(uSoilFluxCrossTexture, ivec2(gl_FragCoord.xy), 0);\n\tfloat crossInflowingSoil = crossInflowingFlux.x + crossInflowingFlux.y + crossInflowingFlux.z + crossInflowingFlux.w;\n\tfloat crossOutflowingSoil = crossInflowingFlux.x + crossInflowingFlux.y + crossInflowingFlux.z + crossInflowingFlux.w;\n\tfloat crossVolumeChange = crossInflowingSoil - crossOutflowingSoil;\n\n\tterrainHeight += crossVolumeChange;\n\n\toTerrainHeight = vec4(terrainHeight);\n}"},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});e.__esModule=!0;var o=n(0),a=n(2),s=n(104).default,u=function(t){function e(){var e=t.call(this,s)||this;return e.uTerrainHeightTextureLocation=e.shader.getUniformLocation("uTerrainHeightTexture"),e.uSedimentHardnessTextureLocation=e.shader.getUniformLocation("uSedimentHardnessTexture"),e.uDeltaTimeLocation=e.shader.getUniformLocation("uDeltaTime"),e.uCellSizeLocation=e.shader.getUniformLocation("uCellSize"),e.uThermalErosionRateLocation=e.shader.getUniformLocation("uThermalErosionRate"),e.uTalusAngleTangentCoeffLocation=e.shader.getUniformLocation("uTalusAngleTangentCoeff"),e.uTalusAngleTangentBiasLocation=e.shader.getUniformLocation("uTalusAngleTangentBias"),e}return i(e,t),e.prototype.initalizePass=function(t,e){this.shader.setUniformI(this.uTerrainHeightTextureLocation,0),this.shader.setUniformI(this.uSedimentHardnessTextureLocation,1),this.shader.setUniformF(this.uDeltaTimeLocation,o.erosionParams.deltaTime),this.shader.setUniformF(this.uCellSizeLocation,o.erosionParams.pipeLength),this.shader.setUniformF(this.uThermalErosionRateLocation,o.erosionParams.thermalErosionRate),this.shader.setUniformF(this.uTalusAngleTangentCoeffLocation,o.erosionParams.talusAngleTangentCoeff),this.shader.setUniformF(this.uTalusAngleTangentBiasLocation,o.erosionParams.talusAngleTangentBias),t.heightMap.current().bind(0),t.sedimentHardnessMap.current().bind(1),e.setColorAttachment(t.soilFluxPlusMap,0),e.setColorAttachment(t.soilFluxCrossMap,1),o.gl.drawBuffers([o.gl.COLOR_ATTACHMENT0,o.gl.COLOR_ATTACHMENT1])},e.prototype.finalizePass=function(t){t.unsetColorAttachment(0),t.unsetColorAttachment(1)},e}(a.Pass);e.ErosionSoilFluxPass=u},function(t,e,n){"use strict";n.r(e),e.default="#version 300 es\nprecision highp float;\n\nin vec2 vCoords;\n\nlayout (location = 0) out vec4 oSoilOutflowFluxPlus;\nlayout (location = 1) out vec4 oSoilOutflowFluxCross;\n\nuniform sampler2D uTerrainHeightTexture;\nuniform sampler2D uSedimentHardnessTexture;\nuniform float uDeltaTime;\nuniform float uCellSize;\nuniform float uThermalErosionRate;\nuniform float uTalusAngleTangentCoeff;\nuniform float uTalusAngleTangentBias;\n\n\nvoid main(void) {\t\n\tfloat terrainHeight = texelFetch(uTerrainHeightTexture, ivec2(gl_FragCoord.xy), 0).x;\n\t\n\tvec4 plusNeighborHeights;\n\tplusNeighborHeights.x = texelFetch(uTerrainHeightTexture, ivec2(gl_FragCoord.xy) + ivec2(-1, 0), 0).x;\n\tplusNeighborHeights.y = texelFetch(uTerrainHeightTexture, ivec2(gl_FragCoord.xy) + ivec2( 1, 0), 0).x;\n\tplusNeighborHeights.z = texelFetch(uTerrainHeightTexture, ivec2(gl_FragCoord.xy) + ivec2(0,  1), 0).x;\n\tplusNeighborHeights.w = texelFetch(uTerrainHeightTexture, ivec2(gl_FragCoord.xy) + ivec2(0, -1), 0).x;\n\n\t// rotated right by 45°\n\tvec4 crossNeighborHeights;\n\tcrossNeighborHeights.x = texelFetch(uTerrainHeightTexture, ivec2(gl_FragCoord.xy) + ivec2(-1,  1), 0).x;\n\tcrossNeighborHeights.y = texelFetch(uTerrainHeightTexture, ivec2(gl_FragCoord.xy) + ivec2( 1, -1), 0).x;\n\tcrossNeighborHeights.z = texelFetch(uTerrainHeightTexture, ivec2(gl_FragCoord.xy) + ivec2( 1,  1), 0).x;\n\tcrossNeighborHeights.w = texelFetch(uTerrainHeightTexture, ivec2(gl_FragCoord.xy) + ivec2(-1, -1), 0).x;\n\n\tvec4 plusHeightDiff = max(vec4(0.0), terrainHeight - plusNeighborHeights);\n\tvec4 crossHeightDiff = max(vec4(0.0), terrainHeight - crossNeighborHeights);\n\n\tfloat maxHeightDiff = max(max(plusHeightDiff.x, plusHeightDiff.y), max(plusHeightDiff.z, plusHeightDiff.w));\n\tmaxHeightDiff = max(maxHeightDiff, max(max(crossHeightDiff.x, crossHeightDiff.y), max(crossHeightDiff.z, crossHeightDiff.w)));\n\n\tfloat hardness = texelFetch(uSedimentHardnessTexture, ivec2(gl_FragCoord.xy), 0).y;\n\tfloat soilVolume = uDeltaTime * maxHeightDiff * 0.5 * uCellSize * uCellSize * uThermalErosionRate * hardness;\n\n\tvec4 plusTanAngle = plusHeightDiff / uCellSize;\n\tvec4 crossTanAngle = crossHeightDiff / length(vec2(uCellSize, uCellSize));\n\n\tfloat theshold = hardness * uTalusAngleTangentCoeff + uTalusAngleTangentBias;\n\n\tvec4 plusK = mix(vec4(0.0), plusHeightDiff, greaterThan(plusTanAngle, vec4(theshold)));\n\tvec4 crossK = mix(vec4(0.0), crossHeightDiff, greaterThan(crossTanAngle, vec4(theshold)));\n\n\tif (int(gl_FragCoord.x) == 0) plusK.x = 0.0; crossK.x = 0.0;\n\tif (int(gl_FragCoord.y) == 0) plusK.w = 0.0; crossK.w = 0.0;\n\tif (int(gl_FragCoord.x) == int(textureSize(uTerrainHeightTexture, 0).x) - 1) plusK.y = 0.0; crossK.y = 0.0;\n\tif (int(gl_FragCoord.y) == int(textureSize(uTerrainHeightTexture, 0).y) - 1) plusK.z = 0.0; crossK.z = 0.0;\n\n\tfloat sumK = plusK.x + plusK.y + plusK.z + plusK.w + crossK.x + crossK.y + crossK.z + crossK.w;\n\tvec4 plusOutFlux = sumK > 0.0 ? soilVolume * plusK / sumK : vec4(0.0);\n\tvec4 crossOutFlux = sumK > 0.0 ? soilVolume * crossK / sumK : vec4(0.0);\n\n\toSoilOutflowFluxPlus = plusOutFlux;\n\toSoilOutflowFluxCross = crossOutFlux;\n}"},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});e.__esModule=!0;var o=n(0),a=n(4),s=n(2),u=n(106).default,l=function(t){function e(){var e=t.call(this,u)||this;return e.uTerrainHeightTextureLocation1=e.shader.getUniformLocation("uTerrainHeightTexture"),e.uWaterHeightTextureLocation1=e.shader.getUniformLocation("uWaterHeightTexture"),e.uSedimentHardnessTextureLocation1=e.shader.getUniformLocation("uSedimentHardnessTexture"),e.uWaterOutflowFluxTextureLocation1=e.shader.getUniformLocation("uWaterOutflowFluxTexture"),e.uDeltaTimeLocation1=e.shader.getUniformLocation("uDeltaTime"),e.uPipeLengthLocation1=e.shader.getUniformLocation("uPipeLength"),e.uSedimentCapacityLocation1=e.shader.getUniformLocation("uSedimentCapacity"),e.uMaxErosionDepthLocation1=e.shader.getUniformLocation("uMaxErosionDepth"),e.uSuspensionRateLocation1=e.shader.getUniformLocation("uSuspensionRate"),e.uDepositionRateLocation1=e.shader.getUniformLocation("uDepositionRate"),e.uSedimentSofteningRateLocation1=e.shader.getUniformLocation("uSedimentSofteningRate"),e.uEvaporationRateLocation1=e.shader.getUniformLocation("uEvaporationRate"),a.default.checkGLError(),e}return i(e,t),e.prototype.initalizePass=function(t,e){a.default.checkGLError(),this.shader.setUniformI(this.uTerrainHeightTextureLocation1,0),this.shader.setUniformI(this.uWaterHeightTextureLocation1,1),this.shader.setUniformI(this.uWaterOutflowFluxTextureLocation1,2),this.shader.setUniformI(this.uSedimentHardnessTextureLocation1,3),this.shader.setUniformF(this.uDeltaTimeLocation1,o.erosionParams.deltaTime),this.shader.setUniformF(this.uPipeLengthLocation1,o.erosionParams.pipeLength),this.shader.setUniformF(this.uSedimentCapacityLocation1,o.erosionParams.sedimentCapacity),this.shader.setUniformF(this.uMaxErosionDepthLocation1,o.erosionParams.maxErosionDepth),this.shader.setUniformF(this.uSuspensionRateLocation1,o.erosionParams.suspensionRate),this.shader.setUniformF(this.uDepositionRateLocation1,o.erosionParams.depositionRate),this.shader.setUniformF(this.uSedimentSofteningRateLocation1,o.erosionParams.sedimentSofteningRate),this.shader.setUniformF(this.uEvaporationRateLocation1,o.erosionParams.evaporationRate),t.heightMap.current().bind(0),t.waterHeightMap.current().bind(1),t.waterFluxMap.current().bind(2),t.sedimentHardnessMap.current().bind(3),a.default.checkGLError(),e.setColorAttachment(t.heightMap.next(),0),e.setColorAttachment(t.waterHeightMap.next(),1),e.setColorAttachment(t.waterVelocityMap,2),e.setColorAttachment(t.sedimentHardnessMap.next(),3),o.gl.drawBuffers([o.gl.COLOR_ATTACHMENT0,o.gl.COLOR_ATTACHMENT1,o.gl.COLOR_ATTACHMENT2,o.gl.COLOR_ATTACHMENT3]),a.default.checkGLError()},e.prototype.finalizePass=function(t){a.default.checkGLError(),t.unsetColorAttachment(0),t.unsetColorAttachment(1),t.unsetColorAttachment(2),t.unsetColorAttachment(3)},e}(s.Pass);e.ErosionSuspensionDepositionPass=l},function(t,e,n){"use strict";n.r(e),e.default="#version 300 es\nprecision highp float;\n\nin vec2 vCoords;\n\nlayout (location = 0) out vec4 oTerrainHeight;\nlayout (location = 1) out vec4 oWaterHeight;\nlayout (location = 2) out vec4 oVelocity;\nlayout (location = 3) out vec4 oSedimentHardness;\n\nuniform sampler2D uTerrainHeightTexture;\nuniform sampler2D uWaterHeightTexture;\nuniform sampler2D uSedimentHardnessTexture;\nuniform sampler2D uWaterOutflowFluxTexture;\nuniform float uDeltaTime;\nuniform float uPipeLength;\nuniform float uSedimentCapacity;\nuniform float uMaxErosionDepth;\nuniform float uSuspensionRate;\nuniform float uDepositionRate;\nuniform float uSedimentSofteningRate;\nuniform float uEvaporationRate;\n\n\nvoid main(void) {\t\n\t// calculate water height change\n\tvec4 inflowingFlux;\n\tinflowingFlux.x = texelFetch(uWaterOutflowFluxTexture, ivec2(gl_FragCoord.xy) + ivec2(-1, 0), 0).y;\n\tinflowingFlux.y = texelFetch(uWaterOutflowFluxTexture, ivec2(gl_FragCoord.xy) + ivec2( 1, 0), 0).x;\n\tinflowingFlux.z = texelFetch(uWaterOutflowFluxTexture, ivec2(gl_FragCoord.xy) + ivec2( 0, 1), 0).w;\n\tinflowingFlux.w = texelFetch(uWaterOutflowFluxTexture, ivec2(gl_FragCoord.xy) + ivec2( 0,-1), 0).z;\n\tvec4 outflowingFlux = texelFetch(uWaterOutflowFluxTexture, ivec2(gl_FragCoord.xy), 0);\n\tfloat inflowingWater = inflowingFlux.x + inflowingFlux.y + inflowingFlux.z + inflowingFlux.w;\n\tfloat outflowingWater = outflowingFlux.x + outflowingFlux.y + outflowingFlux.z + outflowingFlux.w;\n\tfloat waterHeightChange = uDeltaTime * (inflowingWater - outflowingWater);\n\n\t// update water height with in/out-flowing water\n\tfloat waterHeight = texelFetch(uWaterHeightTexture, ivec2(gl_FragCoord.xy), 0).x + waterHeightChange / (uPipeLength * uPipeLength);\n\n\t// calculate water flow velocity\n\tvec2 velocity = 0.5 * (inflowingFlux.xz - outflowingFlux.xz + inflowingFlux.yw - outflowingFlux.yw);\n\n\t// calculate normal\n\tvec3 dhdx = vec3(2.0 * uPipeLength, texelFetch(uTerrainHeightTexture, ivec2(gl_FragCoord.xy) + ivec2(1, 0), 0).x - texelFetch(uTerrainHeightTexture, ivec2(gl_FragCoord.xy) + ivec2(-1, 0), 0).x, 0.0);\n\tvec3 dhdy = vec3(0.0, texelFetch(uTerrainHeightTexture, ivec2(gl_FragCoord.xy) + ivec2(0, 1), 0).x - texelFetch(uTerrainHeightTexture, ivec2(gl_FragCoord.xy) + ivec2(0, -1), 0).x, 2.0 * uPipeLength);\n\tvec3 N = normalize(cross(dhdx, dhdy));\n\n\t// calculate sediment capacity of water\n\tfloat lmax = clamp((uMaxErosionDepth - waterHeight) / uMaxErosionDepth, 0.0, 1.0);\n\tfloat localTiltAngle = min(abs(N.y), 0.05);\n\tfloat velocityLength = dot(velocity, velocity) > 1e-7 ? length(velocity) : 0.0;\n\tfloat waterSedimentCapacity = uSedimentCapacity * localTiltAngle * velocityLength * lmax;\n\n\tfloat terrainHeight = texelFetch(uTerrainHeightTexture, ivec2(gl_FragCoord.xy), 0).x;\n\tvec2 sedimentHardness = texelFetch(uSedimentHardnessTexture, ivec2(gl_FragCoord.xy), 0).xy;\n\tfloat sediment = sedimentHardness.x;\n\tfloat hardness = sedimentHardness.y;\n\t\n\t// suspend or depose soil\n\tbool deposeSoil = sediment >= waterSedimentCapacity;\n\tfloat sedimentDelta = deposeSoil\n\t\t\t\t\t? -(uDepositionRate * (sediment - waterSedimentCapacity))\n\t\t\t\t\t: (hardness * uSuspensionRate * (waterSedimentCapacity - sediment));\n\tsedimentDelta *= uDeltaTime;\n\n\tterrainHeight -= sedimentDelta;\n\tsediment += sedimentDelta;\n\twaterHeight += sedimentDelta;\n\n\t// soften terrain, if soil was deposed\n\thardness = deposeSoil\n\t\t\t\t\t? max(0.1, hardness - uDeltaTime * uSedimentSofteningRate * uSuspensionRate * (sediment - sedimentDelta - waterSedimentCapacity))\n\t\t\t\t\t: hardness;\n\n\t// evaporation\n\twaterHeight = waterHeight * (1.0 - uEvaporationRate * uDeltaTime);\n\n\toTerrainHeight = vec4(terrainHeight);\n\toWaterHeight = vec4(waterHeight);\n\toVelocity = vec4(velocity, 0.0, 1.0);\n\toSedimentHardness = vec4(sediment, hardness, 0.0, 1.0);\n}"},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});e.__esModule=!0;var o=n(0),a=n(2),s=n(108).default,u=function(t){function e(){var e=t.call(this,s)||this;return e.uTerrainHeightTextureLocation0=e.shader.getUniformLocation("uTerrainHeightTexture"),e.uWaterHeightTextureLocation0=e.shader.getUniformLocation("uWaterHeightTexture"),e.uWaterOutflowFluxTextureLocation0=e.shader.getUniformLocation("uWaterOutflowFluxTexture"),e.uDeltaTimeLocation0=e.shader.getUniformLocation("uDeltaTime"),e.uRainRateLocation0=e.shader.getUniformLocation("uRainRate"),e.uPipeCrossSectionAreaLocation0=e.shader.getUniformLocation("uPipeCrossSectionArea"),e.uPipeLengthLocation0=e.shader.getUniformLocation("uPipeLength"),e}return i(e,t),e.prototype.initalizePass=function(t,e){this.shader.setUniformI(this.uTerrainHeightTextureLocation0,0),this.shader.setUniformI(this.uWaterHeightTextureLocation0,1),this.shader.setUniformI(this.uWaterOutflowFluxTextureLocation0,2),this.shader.setUniformF(this.uDeltaTimeLocation0,o.erosionParams.deltaTime),this.shader.setUniformF(this.uRainRateLocation0,o.erosionParams.rainRate),this.shader.setUniformF(this.uPipeCrossSectionAreaLocation0,o.erosionParams.pipeCrossSectionArea),this.shader.setUniformF(this.uPipeLengthLocation0,o.erosionParams.pipeLength),t.heightMap.current().bind(0),t.waterHeightMap.current().bind(1),t.waterFluxMap.current().bind(2),e.setColorAttachment(t.waterHeightMap.next(),0),e.setColorAttachment(t.waterFluxMap.next(),1),o.gl.drawBuffers([o.gl.COLOR_ATTACHMENT0,o.gl.COLOR_ATTACHMENT1])},e.prototype.finalizePass=function(t){t.unsetColorAttachment(0),t.unsetColorAttachment(1)},e}(a.Pass);e.ErosionWaterFluxPass=u},function(t,e,n){"use strict";n.r(e),e.default="#version 300 es\nprecision highp float;\n\nin vec2 vCoords;\n\nlayout (location = 0) out vec4 oWaterHeight;\nlayout (location = 1) out vec4 oWaterOutflowFlux;\n\nuniform sampler2D uTerrainHeightTexture;\nuniform sampler2D uWaterHeightTexture;\nuniform sampler2D uWaterOutflowFluxTexture;\nuniform float uDeltaTime;\nuniform float uRainRate;\nuniform float uPipeCrossSectionArea;\nuniform float uPipeLength;\n\nconst float g = 9.81;\n\n\nvoid main(void) {\t\n\tfloat terrainHeight = texelFetch(uTerrainHeightTexture, ivec2(gl_FragCoord.xy), 0).x;\n\tfloat waterHeight = texelFetch(uWaterHeightTexture, ivec2(gl_FragCoord.xy), 0).x;\n\t\n\tfloat waterIncrement = uDeltaTime * uRainRate;\n\twaterHeight += waterIncrement;\n\n\tfloat combinedHeight = terrainHeight + waterHeight;\n\n\tvec4 waterOutflowFlux = texelFetch(uWaterOutflowFluxTexture, ivec2(gl_FragCoord.xy), 0);\n\tvec4 neighborHeight;\n\tneighborHeight.x = texelFetch(uTerrainHeightTexture, ivec2(gl_FragCoord.xy) + ivec2(-1, 0), 0).x;\n\tneighborHeight.y = texelFetch(uTerrainHeightTexture, ivec2(gl_FragCoord.xy) + ivec2( 1, 0), 0).x;\n\tneighborHeight.z = texelFetch(uTerrainHeightTexture, ivec2(gl_FragCoord.xy) + ivec2(0,  1), 0).x;\n\tneighborHeight.w = texelFetch(uTerrainHeightTexture, ivec2(gl_FragCoord.xy) + ivec2(0, -1), 0).x;\n\n\tneighborHeight.x += texelFetch(uWaterHeightTexture, ivec2(gl_FragCoord.xy) + ivec2(-1, 0), 0).x + waterIncrement;\n\tneighborHeight.y += texelFetch(uWaterHeightTexture, ivec2(gl_FragCoord.xy) + ivec2( 1, 0), 0).x + waterIncrement;\n\tneighborHeight.z += texelFetch(uWaterHeightTexture, ivec2(gl_FragCoord.xy) + ivec2(0,  1), 0).x + waterIncrement;\n\tneighborHeight.w += texelFetch(uWaterHeightTexture, ivec2(gl_FragCoord.xy) + ivec2(0, -1), 0).x + waterIncrement;\n\t\n\tvec4 heightDiff = combinedHeight - neighborHeight;\n\tfloat invPipelength = 1.0 / uPipeLength;\n\twaterOutflowFlux = max(vec4(0.0), waterOutflowFlux + uDeltaTime * uPipeCrossSectionArea * (g * heightDiff) * invPipelength);\n\n\tif (int(gl_FragCoord.x) == 0) waterOutflowFlux.x = 0.0;\n\tif (int(gl_FragCoord.y) == 0) waterOutflowFlux.w = 0.0;\n\tif (int(gl_FragCoord.x) == int(textureSize(uTerrainHeightTexture, 0).x) - 1) waterOutflowFlux.y = 0.0;\n\tif (int(gl_FragCoord.y) == int(textureSize(uTerrainHeightTexture, 0).y) - 1) waterOutflowFlux.z = 0.0;\n\n\tfloat outfluxSum = waterOutflowFlux.x + waterOutflowFlux.y + waterOutflowFlux.z + waterOutflowFlux.w;\n\twaterOutflowFlux *= outfluxSum > 0.0 ? min(1.0, (waterHeight * uPipeLength * uPipeLength) / (outfluxSum * uDeltaTime)) : 1.0;\n\n\toWaterOutflowFlux = waterOutflowFlux;\n\toWaterHeight = vec4(waterHeight);\n}"},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});e.__esModule=!0;var o=n(0),a=n(4),s=n(2),u=n(110).default,l=function(t){function e(){var e=t.call(this,u)||this;return e.uTerrainHeightTextureLocation=e.shader.getUniformLocation("uTerrainHeightTexture"),e.uSedimentHardnessTextureLocation=e.shader.getUniformLocation("uSedimentHardnessTexture"),e.uTexelSizeInMetersLocation=e.shader.getUniformLocation("uTexelSizeInMeters"),e.uHeightScaleInMetersLocation=e.shader.getUniformLocation("uHeightScaleInMeters"),e.uUpdateValuesLocation=e.shader.getUniformLocation("uUpdateValues"),e.updateValues=!1,e}return i(e,t),e.prototype.initalizePass=function(t,e){a.default.checkGLError(),this.shader.setUniformI(this.uTerrainHeightTextureLocation,0),this.shader.setUniformI(this.uSedimentHardnessTextureLocation,1),this.shader.setUniformF(this.uTexelSizeInMetersLocation,1),this.shader.setUniformF(this.uHeightScaleInMetersLocation,1),this.shader.setUniformI(this.uUpdateValuesLocation,this.updateValues?1:0),this.updateValues=!1,a.default.checkGLError(),t.heightMap.current().bind(0),t.sedimentHardnessMap.current().bind(1),a.default.checkGLError(),e.setColorAttachment(t.sedimentHardnessMap.next(),0),o.gl.drawBuffers([o.gl.COLOR_ATTACHMENT0]),a.default.checkGLError()},e.prototype.finalizePass=function(t){a.default.checkGLError(),t.unsetColorAttachment(0),a.default.checkGLError()},e}(s.Pass);e.GenerateHardnessPass=l},function(t,e,n){"use strict";n.r(e),e.default="#version 300 es\nprecision highp float;\n\nin vec2 vCoords;\n\nlayout (location = 0) out vec4 oSedimentHardness;\n\nuniform sampler2D uTerrainHeightTexture;\nuniform sampler2D uSedimentHardnessTexture;\nuniform float uTexelSizeInMeters;\nuniform float uHeightScaleInMeters;\nuniform int uUpdateValues;\n\nuint rngState = 0u;\n\nuint rand_xorshift()\n{\n    // Xorshift algorithm from George Marsaglia's paper\n    rngState ^= (rngState << 13u);\n    rngState ^= (rngState >> 17u);\n    rngState ^= (rngState << 5u);\n    return rngState;\n}\n\nuint wang_hash(uint seed)\n{\n    seed = (seed ^ 61u) ^ (seed >> 16u);\n    seed *= 9u;\n    seed = seed ^ (seed >> 4u);\n    seed *= 0x27d4eb2du;\n    seed = seed ^ (seed >> 15u);\n    return seed;\n}\n\nvoid main(void) {\n\tvec3 worldSpacePos = vec3(vCoords.x, 0.0, vCoords.y);\n\tworldSpacePos.xz *= vec2(textureSize(uTerrainHeightTexture, 0).xy) * uTexelSizeInMeters;\n\tvec3 Pr = worldSpacePos + vec3(uTexelSizeInMeters, 0.0, 0.0);\n\tvec3 Pl = worldSpacePos + vec3(-uTexelSizeInMeters, 0.0, 0.0);\n\tvec3 Pb = worldSpacePos + vec3(0.0, 0.0, uTexelSizeInMeters);\n\tvec3 Pt = worldSpacePos + vec3(0.0, 0.0, -uTexelSizeInMeters);\n\n\tvec2 texelSize = 1.0 / vec2(textureSize(uTerrainHeightTexture, 0).xy);\n\n\tPr.y = textureLod(uTerrainHeightTexture, Pr.xz  * uTexelSizeInMeters * texelSize, 0.0).x * uHeightScaleInMeters;\n\tPl.y = textureLod(uTerrainHeightTexture, Pl.xz  * uTexelSizeInMeters * texelSize, 0.0).x * uHeightScaleInMeters;\n\tPb.y = textureLod(uTerrainHeightTexture, Pb.xz  * uTexelSizeInMeters * texelSize, 0.0).x * uHeightScaleInMeters;\n\tPt.y = textureLod(uTerrainHeightTexture, Pt.xz  * uTexelSizeInMeters * texelSize, 0.0).x * uHeightScaleInMeters;\n\n\t// Calculate tangent basis vectors using the difference\n\tvec3 dPdu =  Pr - Pl;\n\tvec3 dPdv =  Pt - Pb;\n\n\tvec3 N = normalize(cross(dPdu, dPdv));\n\tfloat flatness = max(N.y, 0.0);\n\n\trngState = wang_hash(uint(gl_FragCoord.x) * uint(floatBitsToInt(gl_FragCoord.x)));\n\tfloat rnd = float(rand_xorshift()) * (1.0 / 4294967296.0);\n\tfloat hardness = 0.1 + flatness * 0.9;// * rnd;\n\tfloat sediment = 0.0;\n\n\tif (uUpdateValues != 0) {\n\t\tvec2 sedimentHardness = texelFetch(uSedimentHardnessTexture, ivec2(gl_FragCoord.xy), 0).xy;\n\t\thardness = mix(hardness, sedimentHardness.y, 0.9);\n\t\tsediment = sedimentHardness.x;\n\t}\n\n\toSedimentHardness = vec4(sediment, hardness, 0.0, 1.0);\n}"},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});e.__esModule=!0;var o=n(0),a=n(2),s=n(112).default,u=function(t){function e(){var e=t.call(this,s)||this;return e.minSlopes=new Array(16),e.maxSlopes=new Array(16),e.minHeights=new Array(16),e.maxHeights=new Array(16),e.dataQueue=[],e.uHeightmapTexture=e.shader.getUniformLocation("uHeightmapTexture"),e.uMinSlopes=e.shader.getUniformLocation("uMinSlopes"),e.uMaxSlopes=e.shader.getUniformLocation("uMaxSlopes"),e.uMinHeights=e.shader.getUniformLocation("uMinHeights"),e.uMaxHeights=e.shader.getUniformLocation("uMaxHeights"),e.uTexelSizeInMeters=e.shader.getUniformLocation("uTexelSizeInMeters"),e.uHeightScaleInMeters=e.shader.getUniformLocation("uHeightScaleInMeters"),e.uRadius=e.shader.getUniformLocation("uRadius"),e.uStrength=e.shader.getUniformLocation("uStrength"),e.uPoints=e.shader.getUniformLocation("uPoints"),e.uPointCount=e.shader.getUniformLocation("uPointCount"),e.uSurfaceMapTexture=e.shader.getUniformLocation("uSurfaceMapTexture"),e.setSurfaceTypes([[0,.8,-200,1e3],[0,.8,-1e3,-30],[.7,1,-1e3,-150],[.5,1,-150,1e3]]),e}return i(e,t),e.prototype.setSurfaceTypes=function(t){this.minSlopes.fill(Number.MAX_VALUE),this.maxSlopes.fill(Number.MAX_VALUE),this.minHeights.fill(Number.MAX_VALUE),this.maxHeights.fill(Number.MAX_VALUE);for(var e=0;e<t.length;++e){var n=t[e],r=n[0],i=n[1],o=n[2],a=n[3];this.minSlopes[e]=r,this.maxSlopes[e]=i,this.minHeights[e]=o,this.maxHeights[e]=a}},e.prototype.initalizePass=function(t,e){t.heightMap.current().bind(0),this.shader.setUniformI(this.uHeightmapTexture,0),o.gl.activeTexture(o.gl.TEXTURE1),o.gl.bindTexture(o.gl.TEXTURE_2D_ARRAY,t.layers.weightMapCurrent),this.shader.setUniformI(this.uSurfaceMapTexture,1),this.shader.setUniformFv(this.uMinSlopes,this.minSlopes),this.shader.setUniformFv(this.uMaxSlopes,this.maxSlopes),this.shader.setUniformFv(this.uMinHeights,this.minHeights),this.shader.setUniformFv(this.uMaxHeights,this.maxHeights),this.shader.setUniformF(this.uTexelSizeInMeters,1),this.shader.setUniformF(this.uHeightScaleInMeters,1);var n=this.dataQueue.shift();n?(n.points.length>=100&&console.error("Too much points"),this.shader.setUniformVec2(this.uPoints,n.points),this.shader.setUniformI(this.uPointCount,n.points.length/2),this.shader.setUniformF(this.uRadius,n.radius),this.shader.setUniformF(this.uStrength,n.strength)):this.shader.setUniformI(this.shader.getUniformLocation("uPointCount"),0),o.gl.framebufferTextureLayer(o.gl.FRAMEBUFFER,o.gl.COLOR_ATTACHMENT0,t.layers.weightMapNext,0,0),o.gl.framebufferTextureLayer(o.gl.FRAMEBUFFER,o.gl.COLOR_ATTACHMENT1,t.layers.weightMapNext,0,1),t.layers.swapWeightMaps(),o.gl.drawBuffers([o.gl.COLOR_ATTACHMENT0,o.gl.COLOR_ATTACHMENT1])},e.prototype.finalizePass=function(t){t.unsetColorAttachment(0),t.unsetColorAttachment(1),o.gl.drawBuffers([o.gl.COLOR_ATTACHMENT0])},e.prototype.queueData=function(t){this.dataQueue.push(t)},e}(a.Pass);e.GenerateSurfacePass=u},function(t,e,n){"use strict";n.r(e),e.default="#version 300 es\n\nprecision highp float;\nprecision highp sampler2DArray;\n\nin vec2 vCoords;\n\nuniform sampler2D uHeightmapTexture;\nuniform sampler2DArray uSurfaceMapTexture;\n\nuniform float uTexelSizeInMeters;\nuniform float uHeightScaleInMeters;\n\nuniform float uMinSlopes[8];\nuniform float uMaxSlopes[8];\nuniform float uMinHeights[8];\nuniform float uMaxHeights[8];\n\nuniform vec2 uPoints[16];\nuniform int uPointCount;\nuniform float uRadius;\nuniform float uStrength;\n\nlayout (location = 0) out vec4 oSurfaceMap0;\nlayout (location = 1) out vec4 oSurfaceMap1;\n\nfloat linePointDist(vec2 a, vec2 b, vec2 p) {\n\tvec2 n = b - a;\n\tfloat t = dot(p - a, n) / dot(n, n);\n\tt = min(max(t, 0.0), 1.0);\n\n\tvec2 s = a + t * n;\n\treturn distance(s, p);\n}\n\nfloat peak(float x)\n{\n\treturn max(0.0, 1.0 - abs(2.0*x - 1.0));\n}\n\nfloat peak(float minVal, float maxVal, float value)\n{\n\treturn peak((value - minVal)/(maxVal - minVal));\n}\n\nfloat getBrushWeight() \n{\n\tvec2 terrainSize = vec2(textureSize(uHeightmapTexture, 0));\n\tvec2 fragmentPosition = vCoords * terrainSize;\n\tfloat radius = uRadius;\n\n\tfloat minDist = 10000000.0;\n\n\t// find minimum distance to path\n\tfor (int i = 0; i < uPointCount - 1; ++i) {\n\t\tvec2 fromPoint = uPoints[i];\n\t\tvec2 toPoint = uPoints[i + 1];\n\n\t\tfloat dist = linePointDist(fromPoint, toPoint, fragmentPosition);\n\t\tminDist = min(minDist, dist);\n\t}\n\n\treturn uStrength * smoothstep(radius, 0.0, minDist);\t\n}\n\nvec4 calculateSurfaceMap(int surfaceMapIndex, float height, float slope)\n{\n\tvec4 result;\n\tfor(int i = 0; i < 4; ++i)\n\t{\n\t\tint typeIndex = surfaceMapIndex * 4 + i;\n\n\t\tfloat minSlope = uMinSlopes[typeIndex];\n\t\tfloat maxSlope = uMaxSlopes[typeIndex];\n\t\tfloat midSlope = (minSlope + maxSlope) * 0.5;\n\n\t\tfloat minHeight = uMinHeights[typeIndex];\n\t\tfloat maxHeight = uMaxHeights[typeIndex];\n\t\tfloat midHeight = (minHeight + maxHeight) * 0.5;\n\n\t\t// float fadeInOutHeight = smoothstep(minHeight, midHeight, height) * smoothstep(maxHeight, midHeight, height);\n\t\t// float fadeInOutSlope = smoothstep(minSlope, midSlope, slope) * smoothstep(maxSlope, midSlope, slope);\n\t\t\n\t\tfloat fadeInOutHeight = peak(minHeight, maxHeight, height);\n\t\tfloat fadeInOutSlope = peak(minSlope, maxSlope, slope);\n\n\t\tresult[i] = fadeInOutHeight * fadeInOutSlope;\n\t}\n\n\treturn result;\n}\n\n\nvoid main(void) {\t\n\tfloat height = texture(uHeightmapTexture, vCoords).r;\n\t\n\tvec2 texelSize = (uTexelSizeInMeters / vec2(textureSize(uHeightmapTexture, 0).xy));\n\t\n\t// calculate normal\n\tvec3 Pr = vec3(uTexelSizeInMeters, 0.0, 0.0);\n\tvec3 Pl = vec3(-uTexelSizeInMeters, 0.0, 0.0);\n\tvec3 Pb = vec3(0.0, 0.0, uTexelSizeInMeters);\n\tvec3 Pt = vec3(0.0, 0.0, -uTexelSizeInMeters);\n\tPr.y = texture(uHeightmapTexture, vCoords + Pr.xz  * texelSize).x * uHeightScaleInMeters;\n\tPl.y = texture(uHeightmapTexture, vCoords + Pl.xz  * texelSize).x * uHeightScaleInMeters;\n\tPb.y = texture(uHeightmapTexture, vCoords + Pb.xz  * texelSize).x * uHeightScaleInMeters;\n\tPt.y = texture(uHeightmapTexture, vCoords + Pt.xz  * texelSize).x * uHeightScaleInMeters;\n\tvec3 dPdu =  Pr - Pl;\n\tvec3 dPdv =  Pt - Pb;\n\tvec3 normal = normalize(cross(dPdu, dPdv));\n\n\t// calculate slope\n\tfloat slope = max(0.0, dot(vec3(0.0, 1.0, 0.0), normal));\t\n\n\n\tif (uPointCount == 0){\n\t\toSurfaceMap0 = calculateSurfaceMap(0, height, slope);\n\t\toSurfaceMap1 = calculateSurfaceMap(1, height, slope);\n\t}else{\n\t\tfloat weight = clamp(getBrushWeight(), 0.0, 1.0);\t\n\t\t\n\t\toSurfaceMap0 = mix(texture(uSurfaceMapTexture, vec3(vCoords, 0.0)), calculateSurfaceMap(0, height, slope), weight);\n\t\toSurfaceMap1 = mix(texture(uSurfaceMapTexture, vec3(vCoords, 1.0)), calculateSurfaceMap(1, height, slope), weight);\n\t}\t\n}"},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});e.__esModule=!0;var o=n(0),a=n(2),s=n(114).default,u=function(t){function e(){var e=t.call(this,s)||this;return e.dataQueue=[],e.uHeightmapTexture=e.shader.getUniformLocation("uHeightmapTexture"),e.uSurfaceMapTexture=e.shader.getUniformLocation("uSurfaceMapTexture"),e.uType=e.shader.getUniformLocation("uType"),e.uRadius=e.shader.getUniformLocation("uRadius"),e.uStrength=e.shader.getUniformLocation("uStrength"),e.uValue=e.shader.getUniformLocation("uValue"),e.uPoints=e.shader.getUniformLocation("uPoints"),e.uPointCount=e.shader.getUniformLocation("uPointCount"),e.uMinSlope=e.shader.getUniformLocation("uMinSlope"),e.uMaxSlope=e.shader.getUniformLocation("uMaxSlope"),e}return i(e,t),e.prototype.initalizePass=function(t,e){t.heightMap.current().bind(0),this.shader.setUniformI(this.uHeightmapTexture,0),o.gl.activeTexture(o.gl.TEXTURE1),o.gl.bindTexture(o.gl.TEXTURE_2D_ARRAY,t.layers.weightMapCurrent),this.shader.setUniformI(this.uSurfaceMapTexture,1);var n=this.dataQueue.shift();n?(n.points.length>=100&&console.error("Too much points for LayerBrushPass"),this.shader.setUniformVec2(this.uPoints,n.points),this.shader.setUniformI(this.uPointCount,n.points.length/2),this.shader.setUniformI(this.uType,n.type),this.shader.setUniformF(this.uRadius,n.radius),this.shader.setUniformF(this.uStrength,n.strength),this.shader.setUniformF(this.uValue,n.value),this.shader.setUniformF(this.uMinSlope,n.minSlope),this.shader.setUniformF(this.uMaxSlope,n.maxSlope)):this.shader.setUniformI(this.shader.getUniformLocation("uPointCount"),0),o.gl.framebufferTextureLayer(o.gl.FRAMEBUFFER,o.gl.COLOR_ATTACHMENT0,t.layers.weightMapNext,0,0),o.gl.framebufferTextureLayer(o.gl.FRAMEBUFFER,o.gl.COLOR_ATTACHMENT1,t.layers.weightMapNext,0,1),t.layers.swapWeightMaps(),o.gl.drawBuffers([o.gl.COLOR_ATTACHMENT0,o.gl.COLOR_ATTACHMENT1])},e.prototype.finalizePass=function(t){t.unsetColorAttachment(0),t.unsetColorAttachment(1),o.gl.drawBuffers([o.gl.COLOR_ATTACHMENT0])},e.prototype.queueData=function(t){this.dataQueue.push(t)},e}(a.Pass);e.LayerBrushPass=u},function(t,e,n){"use strict";n.r(e),e.default="#version 300 es\nprecision highp float;\nprecision highp sampler2DArray;\n\nin vec2 vCoords;\n\nuniform sampler2D uHeightmapTexture;\nuniform sampler2DArray uSurfaceMapTexture;\n\nuniform vec2 uPoints[200];\nuniform int uPointCount;\nuniform int uType;\nuniform float uRadius;\nuniform float uStrength;\nuniform float uValue;\n\nuniform float uMinSlope;\nuniform float uMaxSlope;\n\nlayout (location = 0) out vec4 oSurfaceMap0;\nlayout (location = 1) out vec4 oSurfaceMap1;\n\n\nfloat linePointDist(vec2 a, vec2 b, vec2 p) {\n\tvec2 n = b - a;\n\tfloat t = dot(p - a, n) / dot(n, n);\n\tt = min(max(t, 0.0), 1.0);\n\n\tvec2 s = a + t * n;\n\treturn distance(s, p);\n}\n\nvoid main(void) {\n\tfloat height = texture(uHeightmapTexture, vCoords).r;\n\n\tfloat uTexelSizeInMeters = 1.0; //TODO: get as uniform\n\tfloat uHeightScaleInMeters = 1.0; //TODO: get as uniform\n\n\tvec2 texelSize = (uTexelSizeInMeters / vec2(textureSize(uHeightmapTexture, 0).xy));\n\t\n\t// calculate normal\n\tvec3 Pr = vec3(uTexelSizeInMeters, 0.0, 0.0);\n\tvec3 Pl = vec3(-uTexelSizeInMeters, 0.0, 0.0);\n\tvec3 Pb = vec3(0.0, 0.0, uTexelSizeInMeters);\n\tvec3 Pt = vec3(0.0, 0.0, -uTexelSizeInMeters);\n\tPr.y = texture(uHeightmapTexture, vCoords + Pr.xz  * texelSize).x * uHeightScaleInMeters;\n\tPl.y = texture(uHeightmapTexture, vCoords + Pl.xz  * texelSize).x * uHeightScaleInMeters;\n\tPb.y = texture(uHeightmapTexture, vCoords + Pb.xz  * texelSize).x * uHeightScaleInMeters;\n\tPt.y = texture(uHeightmapTexture, vCoords + Pt.xz  * texelSize).x * uHeightScaleInMeters;\n\tvec3 dPdu =  Pr - Pl;\n\tvec3 dPdv =  Pt - Pb;\n\tvec3 normal = normalize(cross(dPdu, dPdv));\n\n\n\tvec2 terrainSize = vec2(textureSize(uHeightmapTexture, 0));\n\tvec2 fragmentPosition = vCoords * terrainSize;\n\tfloat radius = uRadius;\n\n\tfloat minDist = 10000000.0;\n\n\t// find minimum distance to path\n\tfor (int i = 0; i < uPointCount - 1; ++i) {\n\t\tvec2 fromPoint = uPoints[i];\n\t\tvec2 toPoint = uPoints[i + 1];\n\n\t\tfloat dist = linePointDist(fromPoint, toPoint, fragmentPosition);\n\t\tminDist = min(minDist, dist);\n\t}\n\n\tfloat weight = uStrength * smoothstep(radius, 0.0, minDist);\n\tfloat slope = max(0.0, dot(vec3(0.0, 1.0, 0.0), normal));\t\n\t\n\tconst float slopeOverlap = 0.05;\n\tslope= smoothstep(uMinSlope-slopeOverlap, uMinSlope, slope) * smoothstep(uMaxSlope+slopeOverlap, uMaxSlope, slope);\t\n\t// slope = step(uMinSlope, slope) * (1.0 - step(uMaxSlope, slope));\n\n\tfloat value = uValue * slope;\n\n\toSurfaceMap0 = texture(uSurfaceMapTexture, vec3(vCoords, 0.0));\n\toSurfaceMap1 = texture(uSurfaceMapTexture, vec3(vCoords, 1.0));\n\n\toSurfaceMap0 = mix(oSurfaceMap0, vec4(value), weight * vec4(equal(ivec4(uType), ivec4(0, 1, 2, 3))));\n\toSurfaceMap1 = mix(oSurfaceMap1, vec4(value), weight * vec4(equal(ivec4(uType), ivec4(4, 5, 6, 7))));\n}"},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});e.__esModule=!0;var o=n(0),a=n(2),s=n(116).default,u=function(t){function e(){var e=t.call(this,s)||this;return e.seeds=[1,200,300,0,10,800,3e3,1e4],e.amplitudes=[512,128,64,32,16,8,1,.5],e.scales=[512,256,128,64,32,16,8,2],e.offsets=[0,0],e.ridgeFactor=[1,0,1,0,1,1,0],e}return i(e,t),e.prototype.initalizePass=function(t,e){o.gl.uniform1fv(this.shader.getUniformLocation("uSeed"),this.seeds),o.gl.uniform1fv(this.shader.getUniformLocation("uAmplitude"),this.amplitudes),o.gl.uniform1fv(this.shader.getUniformLocation("uScale"),this.scales),o.gl.uniform2fv(this.shader.getUniformLocation("uOffset"),this.offsets),o.gl.uniform1fv(this.shader.getUniformLocation("uRidgeFactor"),this.ridgeFactor),o.gl.uniform1i(this.shader.getUniformLocation("uLayerCount"),this.seeds.length),t.heightMap.current().bind(0),this.shader.setUniformI(this.shader.getUniformLocation("uTexture"),0),e.setColorAttachment(t.heightMap.next()),o.gl.drawBuffers([o.gl.COLOR_ATTACHMENT0])},e.prototype.finalizePass=function(t){t.unsetColorAttachment(0)},e}(a.Pass);e.PerlinPass=u},function(t,e,n){"use strict";n.r(e),e.default='#version 300 es\n\nprecision highp float;\n\nin vec2 vCoords;\n\nuniform float uSeed[32];\nuniform float uAmplitude[32];\nuniform float uScale[32];\nuniform float uRidgeFactor[32];\nuniform vec2 uOffset[32];\n\nuniform sampler2D uTexture;\n\nuniform int uLayerCount;\n\nfloat cnoise(vec3 v);\n\nout vec4 oHeight;\n\nfloat smoothRidge(float x){\n\tconst float factor = 5.0;\n\treturn (factor - sqrt(x*x + factor*factor));\n}\n\nfloat ridge(float x) { return -abs(x); }\n\nvoid main(void) {\t\n\tvec2 pos = vCoords * vec2(textureSize(uTexture, 0));\n\n\tfloat height = 0.0;\n\n\tfor (int i = 0; i < uLayerCount; ++i){\n\t\tfloat h = (uAmplitude[i] * cnoise(vec3((pos + uOffset[i]) / uScale[i], uSeed[i])));\n\n\t\theight += mix(h, smoothRidge(h), uRidgeFactor[i]);\n\t}\n\n\toHeight = vec4(height, 0.0, 0.0, 1.0);\n}\n\n\n\n//////////////////////////////////////////////////////////\n//\n// GLSL textureless classic 3D noise "cnoise",\n// with an RSL-style periodic variant "pnoise".\n// Author:  Stefan Gustavson (stefan.gustavson@liu.se)\n// Version: 2011-10-11\n//\n// Many thanks to Ian McEwan of Ashima Arts for the\n// ideas for permutation and gradient selection.\n//\n// Copyright (c) 2011 Stefan Gustavson. All rights reserved.\n// Distributed under the MIT license. See LICENSE file.\n// https://github.com/stegu/webgl-noise\n//\n\nvec3 mod289(vec3 x)\n{\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 mod289(vec4 x)\n{\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 permute(vec4 x) {\n     return mod289(((x*34.0)+1.0)*x);\n}\n\nvec4 taylorInvSqrt(vec4 r)\n{\n  return 1.79284291400159 - 0.85373472095314 * r;\n}\n\nvec3 fade(vec3 t) {\n  return t*t*t*(t*(t*6.0-15.0)+10.0);\n}\n\n// Classic Perlin noise\nfloat cnoise(vec3 P)\n{\n  vec3 Pi0 = floor(P); // Integer part for indexing\n  vec3 Pi1 = Pi0 + vec3(1.0); // Integer part + 1\n  Pi0 = mod289(Pi0);\n  Pi1 = mod289(Pi1);\n  vec3 Pf0 = fract(P); // Fractional part for interpolation\n  vec3 Pf1 = Pf0 - vec3(1.0); // Fractional part - 1.0\n  vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);\n  vec4 iy = vec4(Pi0.yy, Pi1.yy);\n  vec4 iz0 = Pi0.zzzz;\n  vec4 iz1 = Pi1.zzzz;\n\n  vec4 ixy = permute(permute(ix) + iy);\n  vec4 ixy0 = permute(ixy + iz0);\n  vec4 ixy1 = permute(ixy + iz1);\n\n  vec4 gx0 = ixy0 * (1.0 / 7.0);\n  vec4 gy0 = fract(floor(gx0) * (1.0 / 7.0)) - 0.5;\n  gx0 = fract(gx0);\n  vec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);\n  vec4 sz0 = step(gz0, vec4(0.0));\n  gx0 -= sz0 * (step(0.0, gx0) - 0.5);\n  gy0 -= sz0 * (step(0.0, gy0) - 0.5);\n\n  vec4 gx1 = ixy1 * (1.0 / 7.0);\n  vec4 gy1 = fract(floor(gx1) * (1.0 / 7.0)) - 0.5;\n  gx1 = fract(gx1);\n  vec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);\n  vec4 sz1 = step(gz1, vec4(0.0));\n  gx1 -= sz1 * (step(0.0, gx1) - 0.5);\n  gy1 -= sz1 * (step(0.0, gy1) - 0.5);\n\n  vec3 g000 = vec3(gx0.x,gy0.x,gz0.x);\n  vec3 g100 = vec3(gx0.y,gy0.y,gz0.y);\n  vec3 g010 = vec3(gx0.z,gy0.z,gz0.z);\n  vec3 g110 = vec3(gx0.w,gy0.w,gz0.w);\n  vec3 g001 = vec3(gx1.x,gy1.x,gz1.x);\n  vec3 g101 = vec3(gx1.y,gy1.y,gz1.y);\n  vec3 g011 = vec3(gx1.z,gy1.z,gz1.z);\n  vec3 g111 = vec3(gx1.w,gy1.w,gz1.w);\n\n  vec4 norm0 = taylorInvSqrt(vec4(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));\n  g000 *= norm0.x;\n  g010 *= norm0.y;\n  g100 *= norm0.z;\n  g110 *= norm0.w;\n  vec4 norm1 = taylorInvSqrt(vec4(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));\n  g001 *= norm1.x;\n  g011 *= norm1.y;\n  g101 *= norm1.z;\n  g111 *= norm1.w;\n\n  float n000 = dot(g000, Pf0);\n  float n100 = dot(g100, vec3(Pf1.x, Pf0.yz));\n  float n010 = dot(g010, vec3(Pf0.x, Pf1.y, Pf0.z));\n  float n110 = dot(g110, vec3(Pf1.xy, Pf0.z));\n  float n001 = dot(g001, vec3(Pf0.xy, Pf1.z));\n  float n101 = dot(g101, vec3(Pf1.x, Pf0.y, Pf1.z));\n  float n011 = dot(g011, vec3(Pf0.x, Pf1.yz));\n  float n111 = dot(g111, Pf1);\n\n  vec3 fade_xyz = fade(Pf0);\n  vec4 n_z = mix(vec4(n000, n100, n010, n110), vec4(n001, n101, n011, n111), fade_xyz.z);\n  vec2 n_yz = mix(n_z.xy, n_z.zw, fade_xyz.y);\n  float n_xyz = mix(n_yz.x, n_yz.y, fade_xyz.x); \n  return 2.2 * n_xyz;\n}\n'},function(t,e,n){"use strict";e.__esModule=!0;var r=n(8),i=n(118),o=n(0),a=n(4),s=n(125),u=n(24),l=n(25),h=n(128),c=n(129),f=n(132),d=n(134),g=function(){function t(){this.texelSizeInMeters=1,this.heightScaleInMeters=1,this.worldSpaceMousePos=r.vec3.create(),this.shadowsNeedUpdate=!0,this.uniformGridMesh=new f.default,this.waterGridMesh=new d.default,this.skybox=new s.default,this.decorationObjects=new i.default,this.terrainShadows=new c.default;var t=o.gl.createBuffer();if(!t)throw new Error("Couldn't create buffer!");this.materialsUBO=t,o.gl.bindBuffer(o.gl.UNIFORM_BUFFER,this.materialsUBO),o.gl.bufferData(o.gl.UNIFORM_BUFFER,16*l.MAX_LAYERS,o.gl.DYNAMIC_DRAW),o.gl.bindBuffer(o.gl.UNIFORM_BUFFER,null),this.fbo=o.gl.createFramebuffer(),this.depthAttachment=new u.default,this.depthAttachment.bind(0),o.gl.texStorage2D(o.gl.TEXTURE_2D,1,o.gl.DEPTH_COMPONENT32F,o.gl.canvas.width,o.gl.canvas.height),this.colorAttachment=new u.default,this.colorAttachment.bind(0),o.gl.texStorage2D(o.gl.TEXTURE_2D,1,o.gl.RGBA8,o.gl.canvas.width,o.gl.canvas.height),this.readBackDepthAttachment=new u.default,this.readBackDepthAttachment.bind(0),o.gl.texStorage2D(o.gl.TEXTURE_2D,1,o.gl.RGBA16F,o.gl.canvas.width,o.gl.canvas.height),o.gl.bindFramebuffer(o.gl.FRAMEBUFFER,this.fbo),o.gl.framebufferTexture2D(o.gl.FRAMEBUFFER,o.gl.DEPTH_ATTACHMENT,o.gl.TEXTURE_2D,this.depthAttachment.id,0),o.gl.framebufferTexture2D(o.gl.FRAMEBUFFER,o.gl.COLOR_ATTACHMENT0,o.gl.TEXTURE_2D,this.colorAttachment.id,0),o.gl.framebufferTexture2D(o.gl.FRAMEBUFFER,o.gl.COLOR_ATTACHMENT1,o.gl.TEXTURE_2D,this.readBackDepthAttachment.id,0),o.gl.bindFramebuffer(o.gl.FRAMEBUFFER,null),a.default.checkGLError()}return t.prototype.draw=function(t,e,n,i,s,u,c,f,d,g,p,v,m){void 0===f&&(f=!1),void 0===d&&(d=0),void 0===g&&(g=0),void 0===m&&(m=!1),this.shadowsNeedUpdate&&(this.terrainShadows.update(this.texelSizeInMeters,this.heightScaleInMeters,r.vec3.clone(i),s.heightMap.current().id),this.shadowsNeedUpdate=!1),o.gl.bindFramebuffer(o.gl.FRAMEBUFFER,this.fbo),o.gl.viewport(0,0,o.gl.canvas.width,o.gl.canvas.height);var _=[o.gl.COLOR_ATTACHMENT0,o.gl.COLOR_ATTACHMENT1];o.gl.drawBuffers(_),o.gl.clearBufferfv(o.gl.DEPTH,0,[1]),o.gl.bindBuffer(o.gl.UNIFORM_BUFFER,this.materialsUBO),a.default.checkGLError();for(var y=new Uint32Array(4*l.MAX_LAYERS),b=0;b<l.MAX_LAYERS;++b)y[4*b+0]=u.getLayerMaterial(b).albedoRoughness;o.gl.bufferSubData(o.gl.UNIFORM_BUFFER,0,y),a.default.checkGLError();var x=new h.default;x.viewProjection=e,x.camPos=n,x.lightDir=r.vec3.clone(i),x.cursorPosRadius=[p,v,c],x.drawCursor=m,x.texelSizeInMeters=this.texelSizeInMeters,x.heightScaleInMeters=this.heightScaleInMeters,x.enableAlphaBlending=!1,x.time=t,x.layerOrder=u.layerOrder,x.heightMap=s.heightMap.current().id,x.debugTexture=s.waterHeightMap.current().id,x.shadowMap=s.shadowMap.id,x.shadowMap2=this.terrainShadows.getShadowMap().id,x.weightMap=u.weightMapCurrent,x.materialUBO=this.materialsUBO,x.activeLayers=0;for(b=0;b<l.MAX_LAYERS;++b)x.activeLayers|=u.getLayerActive(b)?1<<b:0;this.uniformGridMesh.draw(x);var w=r.mat4.create();if(r.mat4.invert(w,e),this.skybox.draw(w,i),o.gl.drawBuffers([o.gl.COLOR_ATTACHMENT0]),this.waterGridMesh.draw(x),this.decorationObjects.draw(e,this.texelSizeInMeters,this.heightScaleInMeters,n,i,s.heightMap.current().id,this.terrainShadows.getShadowMap().id),a.default.checkGLError(),f){o.gl.readBuffer(o.gl.COLOR_ATTACHMENT1);var T=new Float32Array(4);o.gl.readPixels(d,o.gl.canvas.height-g,1,1,o.gl.RGBA,o.gl.FLOAT,T),this.worldSpaceMousePos[0]=T[0],this.worldSpaceMousePos[1]=T[1],this.worldSpaceMousePos[2]=T[2]}o.gl.readBuffer(o.gl.COLOR_ATTACHMENT0),o.gl.bindFramebuffer(o.gl.DRAW_FRAMEBUFFER,null),o.gl.blitFramebuffer(0,0,o.gl.canvas.width,o.gl.canvas.height,0,0,o.gl.canvas.width,o.gl.canvas.height,o.gl.COLOR_BUFFER_BIT,o.gl.NEAREST),o.gl.bindFramebuffer(o.gl.FRAMEBUFFER,null),o.gl.viewport(0,0,o.gl.canvas.width,o.gl.canvas.height)},t.prototype.resize=function(){o.gl.deleteTexture(this.depthAttachment.id),o.gl.deleteTexture(this.colorAttachment.id),o.gl.deleteTexture(this.readBackDepthAttachment.id);var t=o.gl.createTexture();if(!t)throw new Error("Couldn't create texture.");if(this.depthAttachment.id=t,!(t=o.gl.createTexture()))throw new Error("Couldn't create texture.");if(this.colorAttachment.id=t,!(t=o.gl.createTexture()))throw new Error("Couldn't create texture.");this.readBackDepthAttachment.id=t,this.depthAttachment.bind(0),o.gl.texStorage2D(o.gl.TEXTURE_2D,1,o.gl.DEPTH_COMPONENT32F,o.gl.canvas.width,o.gl.canvas.height),this.colorAttachment=new u.default,this.colorAttachment.bind(0),o.gl.texStorage2D(o.gl.TEXTURE_2D,1,o.gl.RGBA8,o.gl.canvas.width,o.gl.canvas.height),this.readBackDepthAttachment=new u.default,this.readBackDepthAttachment.bind(0),o.gl.texStorage2D(o.gl.TEXTURE_2D,1,o.gl.RGBA16F,o.gl.canvas.width,o.gl.canvas.height),o.gl.bindFramebuffer(o.gl.FRAMEBUFFER,this.fbo),o.gl.framebufferTexture2D(o.gl.FRAMEBUFFER,o.gl.DEPTH_ATTACHMENT,o.gl.TEXTURE_2D,this.depthAttachment.id,0),o.gl.framebufferTexture2D(o.gl.FRAMEBUFFER,o.gl.COLOR_ATTACHMENT0,o.gl.TEXTURE_2D,this.colorAttachment.id,0),o.gl.framebufferTexture2D(o.gl.FRAMEBUFFER,o.gl.COLOR_ATTACHMENT1,o.gl.TEXTURE_2D,this.readBackDepthAttachment.id,0),o.gl.bindFramebuffer(o.gl.FRAMEBUFFER,null)},t.prototype.getMouseWorldSpacePos=function(){return this.worldSpaceMousePos},t}();e.default=g},function(t,e,n){"use strict";e.__esModule=!0;var r=n(0),i=n(119),o=n(10),a=n(121).default,s=n(122).default,u=n(123).default,l=n(124).default,h=function(){function t(){this.treeCount=0,this.decorationObjectsShader=new o.default(s,a),this.uViewProjectionMatrixLocation=this.decorationObjectsShader.getUniformLocation("uViewProjectionMatrix"),this.uTexelSizeInMetersLocation=this.decorationObjectsShader.getUniformLocation("uTexelSizeInMeters"),this.uHeightScaleInMetersLocation=this.decorationObjectsShader.getUniformLocation("uHeightScaleInMeters"),this.uHeightmapTextureLocation=this.decorationObjectsShader.getUniformLocation("uHeightmapTexture"),this.uCamPosLocation=this.decorationObjectsShader.getUniformLocation("uCamPos"),this.uLightDirLocation=this.decorationObjectsShader.getUniformLocation("uLightDir"),this.uAlbedoTextureLocation=this.decorationObjectsShader.getUniformLocation("uAlbedoTexture"),this.uTerrainShadowTextureLocation=this.decorationObjectsShader.getUniformLocation("uTerrainShadowTexture");var t=0,e=0,n=[],h=[];this.treeBranchesVertexOffset=t/8,this.treeBranchesIndexOffset=e;var c=this.treeBranchesVertexOffset,f=i.loadOBJ(u,!0,!0);f.vertexBuffer.forEach((function(e){t++,n.push(e)})),f.indexBuffer.forEach((function(t){e++,h.push(t+c)})),this.treeBranchesIndexCount=e-this.treeBranchesIndexOffset,this.treeTrunkVertexOffset=t/8,this.treeTrunkIndexOffset=e;var d=this.treeTrunkVertexOffset,g=i.loadOBJ(l,!0,!0);g.vertexBuffer.forEach((function(e){t++,n.push(e)})),g.indexBuffer.forEach((function(t){e++,h.push(t+d)})),this.treeTrunkIndexCount=e-this.treeTrunkIndexOffset;var p=r.gl.createVertexArray(),v=r.gl.createBuffer(),m=r.gl.createBuffer(),_=r.gl.createBuffer();if(!(v&&m&&p&&_))throw new Error("Couldn't create vertex or indexbuffer.");this.treeVao=p,this.treeVbo=v,this.treeIbo=m,this.treePositionsVbo=_,r.gl.bindVertexArray(this.treeVao),r.gl.bindBuffer(r.gl.ELEMENT_ARRAY_BUFFER,this.treeIbo),r.gl.bufferData(r.gl.ELEMENT_ARRAY_BUFFER,new Uint32Array(h),r.gl.STATIC_DRAW),r.gl.bindBuffer(r.gl.ARRAY_BUFFER,this.treeVbo),r.gl.bufferData(r.gl.ARRAY_BUFFER,new Float32Array(n),r.gl.STATIC_DRAW),r.gl.enableVertexAttribArray(0),r.gl.enableVertexAttribArray(1),r.gl.enableVertexAttribArray(2),r.gl.vertexAttribPointer(this.decorationObjectsShader.getAttributeLocation("aPosition"),3,r.gl.FLOAT,!1,32,0),r.gl.vertexAttribPointer(this.decorationObjectsShader.getAttributeLocation("aNormal"),3,r.gl.FLOAT,!1,32,12),r.gl.vertexAttribPointer(this.decorationObjectsShader.getAttributeLocation("aTexCoord"),2,r.gl.FLOAT,!1,32,24),r.gl.bindBuffer(r.gl.ARRAY_BUFFER,this.treePositionsVbo),r.gl.enableVertexAttribArray(3),r.gl.vertexAttribPointer(this.decorationObjectsShader.getAttributeLocation("aObjectPosition"),2,r.gl.FLOAT,!1,8,0),r.gl.vertexAttribDivisor(this.decorationObjectsShader.getAttributeLocation("aObjectPosition"),1),r.gl.bindVertexArray(null),this.treeBranchesTexture2=this.loadTexture("/data/spruce_tree/spruce_branches.png"),this.treeTrunkTexture2=this.loadTexture("/data/spruce_tree/spruce_trunk.jpeg"),this.updateTreePositions(new Float32Array)}return t.prototype.draw=function(t,e,n,i,o,a,s){this.decorationObjectsShader.use(),this.decorationObjectsShader.setUniformMat4(this.uViewProjectionMatrixLocation,t),this.decorationObjectsShader.setUniformF(this.uTexelSizeInMetersLocation,e),this.decorationObjectsShader.setUniformF(this.uHeightScaleInMetersLocation,n),this.decorationObjectsShader.setUniformI(this.uHeightmapTextureLocation,0),this.decorationObjectsShader.setUniformVec3(this.uCamPosLocation,i),this.decorationObjectsShader.setUniformVec3(this.uLightDirLocation,o),this.decorationObjectsShader.setUniformI(this.uAlbedoTextureLocation,2),this.decorationObjectsShader.setUniformI(this.uTerrainShadowTextureLocation,1),r.gl.activeTexture(r.gl.TEXTURE0),r.gl.bindTexture(r.gl.TEXTURE_2D,a),r.gl.activeTexture(r.gl.TEXTURE1),r.gl.bindTexture(r.gl.TEXTURE_2D,s),0!==this.treeCount&&(r.gl.bindVertexArray(this.treeVao),r.gl.activeTexture(r.gl.TEXTURE2),r.gl.bindTexture(r.gl.TEXTURE_2D,this.treeBranchesTexture2),r.gl.drawElementsInstanced(r.gl.TRIANGLES,this.treeBranchesIndexCount,r.gl.UNSIGNED_INT,4*this.treeBranchesIndexOffset,this.treeCount),r.gl.activeTexture(r.gl.TEXTURE2),r.gl.bindTexture(r.gl.TEXTURE_2D,this.treeTrunkTexture2),r.gl.drawElementsInstanced(r.gl.TRIANGLES,this.treeTrunkIndexCount,r.gl.UNSIGNED_INT,4*this.treeTrunkIndexOffset,this.treeCount),r.gl.bindVertexArray(null))},t.prototype.updateTreePositions=function(t){this.treeCount=t.length/2,r.gl.bindBuffer(r.gl.ARRAY_BUFFER,this.treePositionsVbo),r.gl.bufferData(r.gl.ARRAY_BUFFER,t,r.gl.DYNAMIC_DRAW)},t.prototype.loadTexture=function(t){var e=r.gl.createTexture();r.gl.bindTexture(r.gl.TEXTURE_2D,e);var n=r.gl.RGBA,i=r.gl.RGBA,o=r.gl.UNSIGNED_BYTE,a=new Uint8Array([0,0,255,255]);r.gl.texImage2D(r.gl.TEXTURE_2D,0,n,1,1,0,i,o,a);var s=new Image;return s.onload=function(){r.gl.bindTexture(r.gl.TEXTURE_2D,e),r.gl.texImage2D(r.gl.TEXTURE_2D,0,n,i,o,s);var t=function(t){return 0==(t&t-1)};t(s.width)&&t(s.height)?(r.gl.generateMipmap(r.gl.TEXTURE_2D),r.gl.texParameteri(r.gl.TEXTURE_2D,r.gl.TEXTURE_MIN_FILTER,r.gl.LINEAR_MIPMAP_LINEAR)):(r.gl.texParameteri(r.gl.TEXTURE_2D,r.gl.TEXTURE_WRAP_S,r.gl.CLAMP_TO_EDGE),r.gl.texParameteri(r.gl.TEXTURE_2D,r.gl.TEXTURE_WRAP_T,r.gl.CLAMP_TO_EDGE),r.gl.texParameteri(r.gl.TEXTURE_2D,r.gl.TEXTURE_MIN_FILTER,r.gl.LINEAR))},s.src=t,e},t}();e.default=h},function(t,e,n){"use strict";e.__esModule=!0;var r=n(120);function i(t){for(var e=[],n=[],i=[],o=[],a=new r.LineParser(t);!a.eof();){var s=a.getLine().trim();if(s&&"#"!==s.charAt(0)){var u=r.splitStringAtWhitespaces(s);switch(u[0].toLowerCase()){case"v":e.push({x:parseFloat(u[1]),y:parseFloat(u[2]),z:parseFloat(u[3]),w:5===u.length?parseFloat(u[4]):1});break;case"vt":n.push({u:parseFloat(u[1]),v:parseFloat(u[2]),w:4===u.length?parseFloat(u[3]):0});break;case"vn":i.push({x:parseFloat(u[1]),y:parseFloat(u[2]),z:parseFloat(u[3])});break;case"f":for(var l=[],h=1;h<u.length;++h){var c=u[h].split("/");l.push({v:parseInt(c[0]),vt:parseInt(c[1]),vn:parseInt(c[2])})}o.push(l)}}}return{vertices:e,textureCoordinates:n,normals:i,faces:o}}e.parseOBJ=i,e.loadOBJ=function(t,e,n){void 0===e&&(e=!1),void 0===n&&(n=!1);for(var r=i(t),o={vertexBuffer:[],indexBuffer:[]},a=[],s=[],u={},l=r.vertices.length,h=r.normals.length,c=r.textureCoordinates.length,f=0,d=r.faces;f<d.length;f++)for(var g=0,p=_=d[f];g<p.length;g++){(S=p[g]).v+=S.v>0?-1:l,S.vn&&(S.vn+=S.vn>0?-1:h),S.vt&&(S.vt+=S.vt>0?-1:c)}for(var v=0,m=r.faces;v<m.length;v++)for(var _=m[v],y=2;y<_.length;++y)a.push([_[0],_[y-1],_[y]]);for(var b=0,x=a;b<x.length;b++){var w=x[b];for(y=0;y<3;++y){var T=(S=w[y]).v+"-"+S.vt+"-"+S.vn;T in u?w[y]=u[T]:(w[y]=s.length,u[T]=s.length,s.push({v:r.vertices[S.v],vn:r.normals[S.vn],vt:r.textureCoordinates[S.vt]}))}}for(var E=0,M=s;E<M.length;E++){var S=M[E];o.vertexBuffer.push(S.v.x/S.v.w,S.v.y/S.v.w,S.v.z/S.v.w),e&&o.vertexBuffer.push(S.vn.x,S.vn.y,S.vn.z),n&&o.vertexBuffer.push(S.vt.u,S.vt.v)}for(var L=0,A=a;L<A.length;L++){w=A[L];o.indexBuffer.push(w[0],w[1],w[2])}return o}},function(t,e,n){"use strict";function r(t){for(var e=0;e<t.length;++e)t[e]=t[e].trim();return t}e.__esModule=!0,e.splitStringAtWhitespaces=function(t){return t.trim().split(/\s+/)},e.trimStringsInArray=r,e.parseFloatsInArray=function(t){for(var e=t.length,n=0;n<e;++n)if(t[n]=parseFloat(t[n]),isNaN(t[n]))return!1;return!0};var i=function(){function t(t,e){void 0===e&&(e=!1),this.pos=0,this.lines=t.split(/\r\n|\r|\n/),e&&r(this.lines)}return t.prototype.peekLine=function(){return this.lines[this.pos]},t.prototype.skipLine=function(){++this.pos},t.prototype.checkLineKeyword=function(t,e){void 0===e&&(e=!1);var n=this.peekLine().substring(0,t.length);return e?t===n:t.toUpperCase()===n.toUpperCase()},t.prototype.getLine=function(){return this.lines[this.pos++]},t.prototype.eof=function(){return this.pos>=this.lines.length},t.prototype.getLinePos=function(){return this.pos},t.prototype.error=function(t){throw Error("Parsing error at line "+this.getLinePos()+": "+t)},t}();e.LineParser=i},function(t,e,n){"use strict";n.r(e),e.default="#version 300 es\n\n#ifndef PI\n#define PI (3.14159265359)\n#endif // PI\n\n#define ALPHA_CUTOFF (0.9)\n#define MIP_SCALE (0.25)\n\n#define GRID_WORLD_SIZE (1024) // TODO: make this dynamic\n\nprecision mediump float;\n\nout vec4 oColor;\n\nin vec3 vWorldPos;\nin vec3 vNormal;\nin vec2 vTexCoord;\n\nuniform vec3 uCamPos;\nuniform vec3 uLightDir;\nuniform sampler2D uAlbedoTexture;\nuniform sampler2D uTerrainShadowTexture;\n\nstruct LightingParams {\n\tvec3 albedo;\n\tvec3 N;\n\tvec3 V;\n\tfloat metalness;\n\tfloat roughness;\n};\n\nconst float A = 0.15; // shoulder strength\nconst float B = 0.50; // linear strength\nconst float C = 0.10; // linear angle\nconst float D = 0.20; // toe strength\nconst float E = 0.02; // toe numerator\nconst float F = 0.30; // toe denominator\nconst vec3 W = vec3(11.2); // linear white point value\n\nvec3 uncharted2Tonemap(vec3 x)\n{\n   return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;\n}\n\nvec3 accurateLinearToSRGB(in vec3 linearCol)\n{\n\tvec3 sRGBLo = linearCol * 12.92;\n\tvec3 sRGBHi = (pow(abs(linearCol), vec3(1.0/2.4)) * 1.055) - 0.055;\n\tvec3 sRGB = mix(sRGBLo, sRGBHi, vec3(greaterThan(linearCol, vec3(0.0031308))));\n\treturn sRGB;\n}\n\nfloat DistributionGGX(vec3 N, vec3 H, float roughness) {\n    float a2 = roughness*roughness;\n    a2 *= a2;\n    float NdotH2 = max(dot(N, H), 0.0);\n    NdotH2 *= NdotH2;\n\n    float nom   = a2;\n    float denom = NdotH2 * (a2 - 1.0) + 1.0;\n\n    denom = PI * denom * denom;\n\n    return nom / max(denom, 0.0000001);\n}\n\nfloat GeometrySmith(float NdotV, float NdotL, float roughness) {\n\tfloat r = (roughness + 1.0);\n    float k = (r*r) / 8.0;\n    float ggx2 =  NdotV / max(NdotV * (1.0 - k) + k, 0.0000001);\n    float ggx1 = NdotL / max(NdotL * (1.0 - k) + k, 0.0000001);\n\n    return ggx1 * ggx2;\n}\n\n\nvec3 fresnelSchlick(float HdotV, vec3 F0) {\n\tfloat power = (-5.55473 * HdotV - 6.98316) * HdotV;\n\treturn F0 + (1.0 - F0) * pow(2.0, power);\n}\n\nvec3 cookTorranceSpecularBrdf(const LightingParams params, vec3 radiance, vec3 L) {\n\tvec3 H = normalize(params.V + L);\n\tfloat NdotL = max(dot(params.N, L), 0.0);\n\tfloat NdotV = max(dot(params.N, params.V), 0.0);\n\t\n\t// Cook-Torrance BRDF\n\tfloat NDF = DistributionGGX(params.N, H, params.roughness);\n\tfloat G = GeometrySmith(NdotV, NdotL, params.roughness);\n\tvec3 F0 = mix(vec3(0.04), params.albedo, params.metalness);\n\tvec3 F = fresnelSchlick(max(dot(H, params.V), 0.0), F0);\n\t\n\tvec3 numerator = NDF * G * F;\n\tfloat denominator = max(4.0 * NdotV * NdotL, 1e-6);\n\n\tvec3 specular = numerator * (1.0 / denominator);\n\t\n\t// because of energy conversion kD and kS must add up to 1.0.\n\t// multiply kD by the inverse metalness so if a material is metallic, it has no diffuse lighting (and otherwise a blend)\n\tvec3 kD = (vec3(1.0) - F) * (1.0 - params.metalness);\n\n\treturn (kD * params.albedo * (1.0 / PI) + specular) * radiance * NdotL;\n}\n\nfloat linearDepth(float depth)\n{\n\tfloat n = 0.1;\n\tfloat f = 10000.0;\n    float z_n = 2.0 * depth - 1.0;\n    return 2.0 * n * f / (f + n - z_n * (f - n));\n}\n\n// Does not take into account GL_TEXTURE_MIN_LOD/GL_TEXTURE_MAX_LOD/GL_TEXTURE_LOD_BIAS,\n// nor implementation-specific flexibility allowed by OpenGL spec\nfloat mip_map_level(in vec2 texture_coordinate) // in texel units\n{\n    vec2  dx_vtc        = dFdx(texture_coordinate);\n    vec2  dy_vtc        = dFdy(texture_coordinate);\n    float delta_max_sqr = max(dot(dx_vtc, dx_vtc), dot(dy_vtc, dy_vtc));\n    float mml = 0.5 * log2(delta_max_sqr);\n    return max( 0.0, mml ); // Thanks @Nims\n}\n\nvec3 accurateSRGBToLinear(in vec3 sRGBCol)\n{\n\tvec3 linearRGBLo = sRGBCol * (1.0 / 12.92);\n\tvec3 linearRGBHi = pow((sRGBCol + vec3(0.055)) * vec3(1.0 / 1.055), vec3(2.4));\n\tvec3 linearRGB = mix(linearRGBLo, linearRGBHi, vec3(greaterThan(sRGBCol, vec3(0.04045))));\n\treturn linearRGB;\n}\n\nvoid main(void) {\n\n\tvec4 albedo = texture(uAlbedoTexture, vTexCoord);\n\n\talbedo.a *= 1.0 + mip_map_level(vec2(textureSize(uAlbedoTexture, 0)) * vTexCoord) * MIP_SCALE;\n\tif(albedo.a < ALPHA_CUTOFF)\n\t{\n\t\tdiscard;\n\t}\n\n\tLightingParams lightingParams;\n\tlightingParams.albedo = accurateSRGBToLinear(albedo.rgb);\n\tlightingParams.N = normalize(vNormal);\n\tlightingParams.V = normalize(uCamPos - vWorldPos);\n\tlightingParams.metalness = 0.0;\n\tlightingParams.roughness = 0.0;\n\n\tfloat terrainShadowHeight = texture(uTerrainShadowTexture, vWorldPos.xz * vec2(1.0 / float(GRID_WORLD_SIZE))).x;\n\tfloat currentHeight = vWorldPos.y;\n\tfloat penumbraZone = 25.0;\n\tfloat distToShadowHeight = -clamp(currentHeight - terrainShadowHeight, -penumbraZone, 0.0);\n\tfloat shadowAlpha = 1.0 - distToShadowHeight / penumbraZone;\n\tfloat shadow = smoothstep(0.0, 1.0, shadowAlpha);\n\n\tvec3 color = cookTorranceSpecularBrdf(lightingParams, vec3(10.0), normalize(uLightDir)) * shadow;\n\n\tvec3 skyColor = pow(vec3(0.529, 0.808, 0.922), vec3(2.2));\n\n\t// ambient\n\tvec3 ambientColor = mix(vec3(0.18), skyColor, vec3(lightingParams.N.y) * 0.5 + 0.5);\n\tcolor += ambientColor * 6.0 * (1.0 / PI) * lightingParams.albedo;\n\n\t// fog\n\tfloat fogAlpha = exp(-0.66 * linearDepth(gl_FragCoord.z) / 10000.0);\n\tcolor += mix(skyColor, color, clamp(fogAlpha * fogAlpha, 0.0, 1.0));\n\n\n\tcolor = uncharted2Tonemap(1.0 * color);\n\tvec3 whiteScale = 1.0/uncharted2Tonemap(W);\n\tcolor *= whiteScale;\n    // gamma correct\n    color = accurateLinearToSRGB(color);//pow(color, vec3(1.0/2.2));\n\n\toColor = vec4(color, 1.0);\n}"},function(t,e,n){"use strict";n.r(e),e.default="#version 300 es\n\nprecision mediump float;\n\nin vec3 aPosition;\nin vec3 aNormal;\nin vec2 aTexCoord;\nin vec2 aObjectPosition;\n\nout vec3 vWorldPos;\nout vec3 vNormal;\nout vec2 vTexCoord;\n\nuniform mat4 uViewProjectionMatrix;\nuniform float uTexelSizeInMeters;\nuniform float uHeightScaleInMeters;\nuniform sampler2D uHeightmapTexture;\n\nvoid main(void) {\n\tfloat height = texture(uHeightmapTexture, aObjectPosition.xy * uTexelSizeInMeters * (1.0 / vec2(textureSize(uHeightmapTexture, 0).xy))).r * uHeightScaleInMeters;\n\t\n\t// calc scale and rotation mat\n\tfloat scale = 0.7 + 0.6 * fract(aObjectPosition.x * aObjectPosition.y);\n\tfloat angle = 3.1415 * 2.0 * fract(aObjectPosition.x + aObjectPosition.y);\n\tfloat c = cos(angle);\n\tfloat s = sin(angle);\n\tmat2 rotationMatrix = mat2(c, s, -s, c);\n\t//\n\n\tvec3 position = aPosition * scale;\n\tposition.xz *= rotationMatrix;  //rotate position around y axis\n\tposition += vec3(aObjectPosition.x, height, aObjectPosition.y);\n\n\tgl_Position = uViewProjectionMatrix * vec4(position, 1.0);\n\tvWorldPos = position;\n\tvNormal = aNormal;\n\tvNormal.xz *= rotationMatrix; //rotate normal around y axis\n\n\tvTexCoord = vec2(aTexCoord.x, 1.0 - aTexCoord.y);\n}"},function(t,e,n){"use strict";n.r(e),e.default="# Blender v2.75 (sub 0) OBJ File: ''\n# www.blender.org\no Spruce\nv 0.192806 10.735374 -0.208768\nv 0.183077 10.860580 -0.292858\nv 0.000000 11.043040 0.000001\nv 0.009730 10.917834 0.084091\nv 0.103221 10.735374 -0.264771\nv -0.079856 10.917834 0.028088\nv 0.246783 10.719641 0.062859\nv 0.326460 10.838087 0.013216\nv 0.000000 11.052154 0.000001\nv -0.079677 10.933707 0.049645\nv 0.251056 10.719642 -0.042705\nv -0.075404 10.933707 -0.055920\nv -0.108877 10.715702 -0.208442\nv -0.203909 10.829384 -0.238235\nv 0.000000 11.062277 0.000001\nv 0.095032 10.948595 0.029794\nv -0.189141 10.715702 -0.139743\nv 0.014768 10.948596 0.098493\nv -0.255072 10.747328 0.073063\nv -0.296038 10.868284 0.153895\nv 0.000000 11.071391 0.000001\nv 0.040966 10.950436 -0.080831\nv -0.206342 10.747328 0.166803\nv 0.089696 10.950436 0.012909\nv -0.058596 10.746388 0.245666\nv -0.007622 10.864331 0.325249\nv 0.000000 11.080503 0.000001\nv -0.050974 10.962561 -0.079582\nv 0.047024 10.746388 0.248142\nv 0.054646 10.962561 -0.077107\nv 0.311028 10.497366 -0.003828\nv 0.377665 10.637273 -0.079425\nv 0.000000 10.860069 0.000001\nv -0.066637 10.720162 0.075598\nv 0.286223 10.497367 -0.121777\nv -0.091442 10.720162 -0.042351\nv 0.170153 10.510488 0.290356\nv 0.261629 10.655973 0.304316\nv 0.000000 10.849675 0.000001\nv -0.091476 10.704187 -0.013958\nv 0.261548 10.510487 0.211781\nv -0.000081 10.704186 -0.092534\nv -0.239648 10.492640 0.225207\nv -0.234469 10.636492 0.320125\nv 0.000000 10.839277 0.000001\nv -0.005180 10.695426 -0.094917\nv -0.142411 10.492640 0.296427\nv 0.092058 10.695426 -0.023697\nv -0.007231 10.509344 -0.356210\nv -0.077987 10.658840 -0.404934\nv 0.000000 10.827727 0.000001\nv 0.070756 10.678231 0.048725\nv -0.125585 10.509344 -0.333416\nv -0.047599 10.678231 0.071519\nv -0.322733 10.510644 -0.173473\nv -0.395431 10.662068 -0.134552\nv 0.000000 10.817330 0.000001\nv 0.072699 10.665905 -0.038920\nv -0.361559 10.510643 -0.059369\nv 0.033872 10.665904 0.075185\nv -0.357304 10.173251 0.288728\nv -0.347642 10.363100 0.391662\nv 0.000000 10.557760 0.000001\nv -0.009662 10.367911 -0.102934\nv -0.244288 10.173250 0.389042\nv 0.103354 10.367910 -0.002619\nv -0.415218 10.171621 -0.164712\nv -0.505911 10.359053 -0.106607\nv 0.000000 10.570797 0.000001\nv 0.090692 10.383365 -0.058105\nv -0.446378 10.171621 -0.016845\nv 0.059533 10.383366 0.089762\nv 0.193721 10.267544 0.469463\nv 0.280876 10.465364 0.467842\nv 0.000000 10.585279 0.000001\nv -0.087155 10.387458 0.001622\nv 0.323280 10.267543 0.391681\nv 0.042404 10.387459 -0.076161\nv 0.418261 10.173053 -0.055586\nv 0.478840 10.355460 -0.154531\nv 0.000000 10.598314 0.000001\nv -0.060579 10.415907 0.098946\nv 0.371850 10.173053 -0.199397\nv -0.106990 10.415908 -0.044865\nv 0.160112 10.227168 -0.430870\nv 0.099270 10.417070 -0.514342\nv 0.000000 10.611346 0.000001\nv 0.060842 10.421444 0.083473\nv 0.011735 10.227169 -0.459507\nv -0.087535 10.421445 0.054835\nv -0.585940 9.871813 -0.162172\nv -0.689045 10.122988 -0.072538\nv 0.000000 10.379946 0.000001\nv 0.103105 10.128771 -0.089633\nv -0.606866 9.871813 0.036602\nv 0.082179 10.128772 0.109141\nv -0.120644 9.800236 -0.544882\nv -0.257897 10.041495 -0.613501\nv 0.000000 10.362707 0.000001\nv 0.137253 10.121447 0.068621\nv -0.304899 9.800235 -0.467427\nv -0.047002 10.121447 0.146076\nv 0.596703 9.925213 -0.308476\nv 0.584692 10.186864 -0.423145\nv 0.000000 10.345469 0.000001\nv 0.012011 10.083817 0.114670\nv 0.479522 9.925214 -0.470394\nv -0.105170 10.083818 -0.047248\nv -0.170010 9.798341 0.565836\nv -0.083163 10.046247 0.678766\nv 0.000000 10.326313 0.000001\nv -0.086847 10.078405 -0.112929\nv 0.028379 9.798342 0.590143\nv 0.111542 10.078405 -0.088622\nv 0.420966 9.800497 0.438139\nv 0.555518 10.051603 0.413743\nv 0.000000 10.309072 0.000001\nv -0.134552 10.057965 0.024397\nv 0.540354 9.800496 0.277841\nv -0.015164 10.057965 -0.135901\nv 0.815947 9.462076 0.171107\nv 0.891414 9.785781 0.051865\nv 0.000000 9.974498 0.000001\nv -0.075467 9.650792 0.119243\nv 0.830285 9.462077 -0.075325\nv -0.061130 9.650793 -0.127188\nv 0.263727 9.514286 0.810078\nv 0.399345 9.840303 0.805775\nv 0.000000 9.995790 0.000001\nv -0.135618 9.669770 0.004304\nv 0.484903 9.514285 0.700463\nv 0.085557 9.669771 -0.105311\nv 0.406169 9.500422 -0.723367\nv 0.315925 9.823567 -0.833513\nv 0.000000 10.019447 0.000001\nv 0.090244 9.696302 0.110147\nv 0.175344 9.500422 -0.810856\nv -0.140580 9.696302 0.022658\nv -0.612148 9.520947 -0.559207\nv -0.740125 9.844027 -0.496429\nv 0.000000 10.040739 0.000001\nv 0.127977 9.717661 -0.062777\nv -0.749653 9.520947 -0.354202\nv -0.009528 9.717660 0.142227\nv -0.796418 9.563111 0.272803\nv -0.795815 9.887889 0.411434\nv 0.000000 10.062031 0.000001\nv -0.000604 9.737253 -0.138631\nv -0.683053 9.563111 0.492080\nv 0.112762 9.737253 0.080647\nv -0.144515 9.099484 1.056124\nv 0.012649 9.510724 1.134313\nv 0.000000 9.731226 0.000001\nv -0.157165 9.319986 -0.078189\nv 0.168031 9.099485 1.052639\nv 0.155382 9.319986 -0.081674\nv -0.980855 9.046094 0.374315\nv -0.982650 9.455183 0.554800\nv 0.000000 9.704267 0.000001\nv 0.001795 9.295177 -0.180484\nv -0.827183 9.046094 0.646496\nv 0.155467 9.295177 0.091697\nv -0.587196 9.020104 -0.871012\nv -0.763138 9.429276 -0.831593\nv 0.000000 9.677306 0.000001\nv 0.175942 9.268133 -0.039418\nv -0.817489 9.020104 -0.659677\nv -0.054351 9.268133 0.171918\nv 1.066411 9.037659 0.162552\nv 1.138701 9.450472 0.006692\nv 0.000000 9.647351 0.000001\nv -0.072290 9.234539 0.155862\nv 1.068248 9.037661 -0.150008\nv -0.070454 9.234538 -0.156698\nv 0.657778 8.971551 -0.825658\nv 0.565827 9.381434 -0.978869\nv 0.000000 9.620392 0.000001\nv 0.091952 9.210508 0.153212\nv 0.387170 8.971552 -0.982081\nv -0.178657 9.210508 -0.003211\nv -0.371890 8.464923 -1.176593\nv -0.580484 8.944043 -1.187326\nv 0.000000 9.223368 0.000001\nv 0.208594 8.744245 0.010735\nv -0.700127 8.464923 -1.016118\nv -0.119643 8.744245 0.171210\nv 0.853233 8.542196 -0.928433\nv 0.749193 9.024743 -1.100216\nv 0.000000 9.254880 0.000001\nv 0.104040 8.772333 0.171783\nv 0.551236 8.542196 -1.134078\nv -0.197957 8.772334 -0.033861\nv -1.227904 8.521675 0.001495\nv -1.304422 8.999968 0.197875\nv 0.000000 9.289896 0.000001\nv 0.076518 8.811604 -0.196379\nv -1.173107 8.521677 0.362728\nv 0.131315 8.811603 0.164854\nv -0.276652 8.552057 1.195606\nv -0.102747 9.030252 1.315067\nv 0.000000 9.321409 0.000001\nv -0.173906 8.843215 -0.119460\nv 0.087603 8.552055 1.224067\nv 0.190349 8.843215 -0.091000\nv 0.930219 8.614466 0.829029\nv 1.108573 9.095174 0.727572\nv 0.000000 9.352923 0.000001\nv -0.178355 8.872216 0.101458\nv 1.130692 8.614466 0.523575\nv 0.022119 8.872214 -0.203995\nv 0.617564 8.107303 1.224584\nv 0.841162 8.636412 1.192748\nv 0.000000 8.920115 0.000001\nv -0.223598 8.391005 0.031838\nv 0.946211 8.107303 0.992813\nv 0.105049 8.391004 -0.199935\nv -0.766211 8.038610 1.112418\nv -0.636406 8.564952 1.304980\nv 0.000000 8.885427 0.000001\nv -0.129806 8.359085 -0.192561\nv -0.404751 8.038609 1.288694\nv 0.231656 8.359085 -0.016285\nv -1.257841 8.005170 -0.494467\nv -1.415512 8.531621 -0.324304\nv 0.000000 8.850741 0.000001\nv 0.157671 8.324289 -0.170162\nv -1.347651 8.005170 -0.102470\nv 0.067862 8.324289 0.221835\nv 1.248645 8.027757 -0.605959\nv 1.211510 8.558890 -0.823871\nv 0.000000 8.812200 0.000001\nv 0.037136 8.281067 0.217913\nv 1.022503 8.027758 -0.938505\nv -0.189007 8.281066 -0.114633\nv 0.094497 7.942701 -1.354921\nv -0.114745 8.470064 -1.450170\nv 0.000000 8.777513 0.000001\nv 0.209242 8.250150 0.095250\nv -0.306403 7.942702 -1.323200\nv -0.191659 8.250150 0.126971\nv -1.240127 7.370968 0.788420\nv -1.188578 7.941554 1.031763\nv 0.000000 8.274199 0.000001\nv -0.051549 7.703613 -0.243342\nv -0.954896 7.370969 1.117003\nv 0.233682 7.703614 0.085241\nv -1.329844 7.462995 -0.697503\nv -1.495664 8.037659 -0.525147\nv 0.000000 8.311728 0.000001\nv 0.165820 7.737065 -0.172355\nv -1.473991 7.462996 -0.286961\nv 0.021672 7.737065 0.238188\nv 0.377877 7.438556 1.412645\nv 0.627316 8.008155 1.440544\nv 0.000000 8.353429 0.000001\nv -0.249439 7.783830 -0.027899\nv 0.776805 7.438557 1.238923\nv 0.149489 7.783830 -0.201621\nv 1.460681 7.474735 -0.047884\nv 1.544885 8.044217 -0.284614\nv 0.000000 8.390958 0.000001\nv -0.084204 7.821476 0.236732\nv 1.381847 7.474735 -0.475795\nv -0.163038 7.821476 -0.191180\nv 0.669101 7.549059 -1.324482\nv 0.497705 8.121533 -1.498656\nv 0.000000 8.428488 0.000001\nv 0.171397 7.856013 0.174176\nv 0.256164 7.549059 -1.461619\nv -0.241540 7.856012 0.037039\nv 1.693507 6.741893 0.733104\nv 1.897110 7.453823 0.507503\nv 0.000000 7.835551 0.000001\nv -0.203602 7.123621 0.225602\nv 1.833344 6.741894 0.210378\nv -0.063766 7.123621 -0.297124\nv 0.167006 6.649465 1.809791\nv 0.467088 7.357673 1.896890\nv 0.000000 7.788879 0.000001\nv -0.300083 7.080672 -0.087099\nv 0.692418 6.649466 1.680414\nv 0.225330 7.080672 -0.216476\nv -1.725855 6.604471 0.573128\nv -1.742122 7.312825 0.884841\nv 0.000000 7.742208 0.000001\nv 0.016267 7.033855 -0.311712\nv -1.480818 6.604472 1.055573\nv 0.261305 7.033854 0.170733\nv 0.767966 6.634865 -1.702254\nv 0.541791 7.349516 -1.895413\nv 0.000000 7.690350 0.000001\nv 0.226176 6.975698 0.193160\nv 0.247698 6.634865 -1.850970\nv -0.294093 6.975698 0.044445\nv -0.065807 5.838205 0.360416\nv 1.045065 5.566065 -0.060301\nv 1.056982 6.396748 -0.400307\nv 0.000000 6.657686 0.000001\nv 0.822822 5.566066 -0.647117\nv -0.288050 5.838204 -0.226400\nv 2.137639 6.295649 -0.809581\nv -0.352450 5.913792 0.126736\nv 0.587609 5.643504 0.918344\nv 0.894469 6.502394 0.753219\nv 0.000000 6.761636 0.000001\nv 1.004956 5.643504 0.422733\nv 0.064898 5.913792 -0.368876\nv 1.807831 6.408419 1.522348\nv 0.048809 5.973171 -0.365462\nv -1.121253 5.734763 0.039398\nv -1.113374 6.596692 0.385233\nv 0.000000 6.825603 0.000001\nv -0.908322 5.731247 0.652710\nv 0.261741 5.969654 0.247850\nv -2.245717 6.533971 0.778005\nv 0.268745 6.057580 0.259717\nv 0.587543 5.796031 -0.939368\nv 0.303342 6.662618 -1.140950\nv 0.000000 6.913559 0.000001\nv -0.043444 5.796030 -1.107128\nv -0.362243 6.057579 0.091957\nv 0.612706 6.578424 -2.304550\nv 0.376957 6.137119 -0.130162\nv -0.615535 5.809790 -0.856488\nv -0.944286 6.671986 -0.691048\nv 0.000000 6.985523 0.000001\nv -1.002546 5.809790 -0.327656\nv -0.010054 6.137118 0.398671\nv -1.914596 6.524351 -1.401142\nv -0.288863 6.199592 -0.275967\nv -0.480307 5.871686 0.941110\nv -0.182146 6.735402 1.157964\nv 0.000000 7.049492 0.000001\nv 0.168192 5.871686 1.043119\nv 0.359636 6.199592 -0.173959\nv -0.369311 6.587506 2.347840\nv 0.317873 5.233417 -0.327416\nv -1.070562 4.858858 -0.557266\nv -1.320998 5.845459 -0.218685\nv 0.000000 6.204237 0.000001\nv -1.193034 4.858859 0.182539\nv 0.195401 5.233416 0.412388\nv -2.678402 5.676523 -0.443397\nv 0.145216 5.162055 0.431771\nv 0.983967 4.788156 -0.695223\nv 0.798013 5.773022 -1.072255\nv 0.000000 6.131168 0.000001\nv 0.383467 4.788156 -1.142138\nv -0.455284 5.162055 -0.015143\nv 1.618018 5.604383 -2.174061\nv -0.299125 5.071200 0.304587\nv 1.067590 4.772439 0.679740\nv 1.300454 5.762320 0.356966\nv 0.000000 6.048965 0.000001\nv 1.265005 4.772439 -0.039458\nv -0.101710 5.071199 -0.414612\nv 2.626722 5.666148 0.721018\nv 0.416998 4.974782 0.059108\nv -0.034706 4.702456 -1.281100\nv -0.429806 5.687016 -1.275275\nv 0.000000 5.948495 0.000001\nv -0.737210 4.698438 -1.043513\nv -0.285506 4.970765 0.296696\nv -0.868048 5.615370 -2.572288\nv -0.141525 4.906955 -0.403745\nv -1.054362 4.598211 0.662759\nv -0.868568 5.579300 1.014782\nv 0.000000 5.875425 0.000001\nv -0.492087 4.598212 1.144020\nv 0.420750 4.906955 0.077517\nv -1.755482 5.471954 2.050998\nv -0.411077 4.820614 -0.078475\nv 0.059284 4.509756 1.194268\nv 0.447542 5.458624 1.211003\nv 0.000000 5.756687 0.000001\nv 0.731608 4.509756 0.945802\nv 0.261248 4.820614 -0.326942\nv 0.905109 5.343141 2.449130\nv 0.231942 3.711336 -0.410347\nv -1.295717 3.361214 -0.367307\nv -1.453550 4.429934 0.040953\nv 0.000000 4.765646 0.000001\nv -1.272981 3.361214 0.439676\nv 0.254677 3.711336 0.396637\nv -2.939658 4.299864 0.082822\nv 0.481840 3.808583 -0.005453\nv -0.327070 3.460842 -1.364000\nv -0.769680 4.565852 -1.292661\nv 0.000000 4.899382 0.000001\nv -1.043315 3.460842 -0.937532\nv -0.234405 3.808583 0.421015\nv -1.555618 4.444947 -2.612628\nv -0.213409 3.884978 0.423648\nv 1.379512 3.578253 0.424838\nv 1.515740 4.687173 0.001148\nv 0.000000 4.981680 0.000001\nv 1.379265 3.573728 -0.410425\nv -0.213656 3.880453 -0.411616\nv 3.057716 4.606479 0.001130\nv -0.217166 3.993573 -0.428993\nv -1.110211 3.657077 0.894107\nv -0.849748 4.771990 1.258954\nv 0.000000 5.094841 0.000001\nv -0.413964 3.657077 1.364051\nv 0.479081 3.993573 0.040950\nv -1.716365 4.663670 2.542897\nv -0.513075 4.095905 -0.000712\nv 0.387092 3.674778 1.300589\nv 0.856445 4.784042 1.238098\nv 0.000000 5.187427 0.000001\nv 1.080469 3.674778 0.820951\nv 0.180302 4.095905 -0.480351\nv 1.736493 4.594101 2.510314\nv 0.234768 4.176280 0.457229\nv 0.980597 3.754411 -0.941433\nv 0.709604 4.865631 -1.330728\nv 0.000000 5.269726 0.000001\nv 0.235344 3.754411 -1.338837\nv -0.510485 4.176280 0.059827\nv 1.438764 4.675355 -2.698133\nv 0.458997 3.130755 0.318452\nv 0.458997 2.672220 -1.404404\nv 0.000000 3.880017 -1.639176\nv 0.000000 4.319233 0.000001\nv -0.458997 2.672220 -1.404405\nv -0.458997 3.130755 0.318451\nv 0.000000 3.673205 -3.323527\nv -0.492441 3.043394 0.261714\nv 1.036399 2.585666 1.049395\nv 1.454584 3.791338 0.749424\nv 0.000000 4.229781 0.000001\nv 1.456102 2.585666 0.234779\nv -0.072738 3.043394 -0.552903\nv 2.949256 3.584890 1.519501\nv -0.427675 2.932168 -0.300373\nv -0.607510 2.566426 1.425302\nv -0.171117 3.778238 1.642012\nv 0.000000 4.129149 0.000000\nv 0.300581 2.566426 1.519936\nv 0.480417 2.932168 -0.205739\nv -0.345631 3.660504 3.316617\nv 0.011987 2.814134 0.515452\nv 1.540326 2.480751 -0.298060\nv 1.454295 3.686050 -0.774081\nv 0.000000 4.006154 0.000000\nv 1.112919 2.475834 -1.099015\nv -0.415421 2.809216 -0.285502\nv 2.933157 3.598342 -1.562698\nv 0.459332 2.731099 -0.251654\nv -1.011263 2.353136 -1.140908\nv -1.399276 3.554185 -0.846129\nv 0.000000 3.916702 0.000000\nv -1.480091 2.353136 -0.365590\nv -0.009496 2.731099 0.523665\nv -2.828108 3.422772 -1.710130\nv 0.012590 2.625401 -0.512173\nv -1.430538 2.244849 0.310383\nv -1.373121 3.406454 0.782653\nv 0.000000 3.771343 0.000000\nv -0.996025 2.244849 1.072713\nv 0.447103 2.625401 0.250157\nv -2.776998 3.265079 1.582835\nv 0.477451 1.659876 0.134652\nv 0.051933 1.291396 -1.416434\nv -0.404875 2.416151 -1.475841\nv 0.000000 2.769464 0.000000\nv -0.767425 1.291396 -1.191656\nv -0.341907 1.659876 0.359430\nv -0.818820 2.279261 -2.984739\nv 0.125910 1.762221 0.491258\nv 1.312832 1.396248 -0.675030\nv 1.129361 2.559196 -1.109727\nv 0.000000 2.910213 0.000000\nv 0.697949 1.396248 -1.300793\nv -0.488974 1.762221 -0.134505\nv 2.282576 2.431952 -2.242893\nv -0.486422 1.842621 -0.112382\nv -0.089825 1.519814 1.516472\nv 0.377366 2.686877 1.549935\nv 0.000000 2.996826 0.000000\nv 0.764062 1.515053 1.307623\nv 0.367466 1.837860 -0.321232\nv 0.762476 2.601952 3.126402\nv 0.384355 1.956911 -0.329160\nv -1.191371 1.602772 -0.911755\nv -1.499332 2.776142 -0.554349\nv 0.000000 3.115920 0.000000\nv -1.497947 1.602772 -0.082569\nv 0.077779 1.956911 0.500025\nv -3.028427 2.662142 -1.119703\nv -0.127406 2.064609 -0.524731\nv -1.233012 1.621402 0.720559\nv -1.051907 2.788826 1.184805\nv 0.000000 3.213360 0.000000\nv -0.569482 1.621402 1.309663\nv 0.536125 2.064609 0.064374\nv -2.132804 2.588927 2.402263\nv -0.408827 2.149198 0.354208\nv 1.207387 1.705210 0.767422\nv 1.537714 2.874692 0.393144\nv 0.000000 3.299974 0.000000\nv 1.427562 1.705210 -0.093750\nv -0.188653 2.149198 -0.506965\nv 3.117807 2.674440 0.797123\nv -0.171727 1.246093 0.469762\nv 1.320467 0.835561 0.079060\nv 1.419718 1.916917 -0.371725\nv 0.000000 2.310153 0.000000\nv 1.112289 0.835561 -0.716030\nv -0.379905 1.246093 -0.325328\nv 2.878562 1.731755 -0.753695\nv -0.338348 1.167878 -0.367162\nv -0.673869 0.758068 1.135620\nv -0.319224 1.837522 1.429791\nv 0.000000 2.230066 0.000000\nv 0.126862 0.758069 1.314397\nv 0.462383 1.167878 -0.188385\nv -0.647246 1.652686 2.898986\nv 0.163172 1.068295 -0.438533\nv -1.372246 0.740841 -0.202951\nv -1.460978 1.825793 0.224161\nv 0.000000 2.139968 0.000000\nv -1.248278 0.740842 0.605023\nv 0.287140 1.068295 0.369441\nv -2.950957 1.720384 0.452771\nv -0.443723 0.962618 0.127274\nv 0.607464 0.664136 1.266511\nv 1.000244 1.743256 1.084047\nv 0.000000 2.029848 0.000000\nv 1.204258 0.659732 0.714689\nv 0.153071 0.958215 -0.424548\nv 2.018649 1.664730 2.186075\nv 0.322127 0.888276 0.340766\nv 0.758829 0.549880 -1.134602\nv 0.415524 1.625195 -1.403818\nv 0.000000 1.949761 0.000000\nv -0.019005 0.549880 -1.364839\nv -0.455708 0.888276 0.110530\nv 0.839826 1.507539 -2.837288\nv -1.070077 6.520420 -1.481458\nv -1.368372 7.230000 -1.399545\nv 0.000000 7.643678 0.000001\nv 0.298295 6.934098 -0.081912\nv -1.456982 6.520420 -1.103172\nv -0.088611 6.934098 0.296375\nv 0.446457 0.793643 -0.105244\nv -0.593239 0.452930 -1.168626\nv -0.989259 1.492929 -1.011796\nv 0.000000 1.819619 0.000000\nv -1.154969 0.452930 -0.619409\nv -0.115273 0.793643 0.443973\nv -2.000676 1.366355 -2.046256\nvt 1.000000 0.996531\nvt 0.500000 0.996531\nvt 0.500000 0.012400\nvt 1.000000 0.012400\nvt 0.000001 0.996531\nvt 0.000000 0.012400\nvt 1.000000 0.577794\nvt 0.500000 0.577794\nvt 0.000000 0.577794\nvt 0.500000 1.010132\nvn 0.881000 0.309000 0.358200\nvn 0.247600 0.884200 -0.396100\nvn -0.707900 0.309000 -0.635100\nvn 0.153500 0.292400 0.943900\nvn 0.547600 0.836500 0.022200\nvn 0.229300 0.292400 -0.928400\nvn 0.576300 0.280600 -0.767600\nvn -0.387700 0.802800 -0.453000\nvn -0.847300 0.280600 0.450900\nvn -0.593400 0.298500 -0.747500\nvn -0.461400 0.854200 0.239800\nvn 0.270900 0.298600 0.915100\nvn -0.941200 0.291100 0.171400\nvn -0.013000 0.832900 0.553300\nvn 0.932100 0.291100 0.215300\nvn 0.363800 0.302700 0.880900\nvn 0.489300 0.866000 -0.102900\nvn -0.021800 0.302700 -0.952800\nvn -0.611400 0.314800 0.726000\nvn 0.283400 0.900600 0.329600\nvn 0.809500 0.314800 -0.495600\nvn -0.849900 0.311200 -0.425300\nvn -0.268900 0.890500 0.367100\nvn 0.661900 0.311200 0.681900\nvn 0.895000 0.323400 -0.307300\nvn -0.071700 0.925400 -0.372200\nvn -0.945100 0.323400 0.047100\nvn 0.186500 0.327600 -0.926200\nvn -0.329800 0.937300 -0.112200\nvn -0.417100 0.327600 0.847800\nvn -0.781600 0.327600 -0.530900\nvn -0.231300 0.937300 0.260600\nvn 0.619900 0.327600 0.713000\nvn 0.063600 0.323400 -0.944100\nvn -0.370900 0.925400 -0.078100\nvn -0.322800 0.323400 0.889500\nvn -0.764700 0.341400 0.546600\nvn 0.110500 0.976700 0.184000\nvn 0.841900 0.341400 -0.417900\nvn 0.432300 0.314800 0.845000\nvn 0.413700 0.900600 -0.133500\nvn -0.143200 0.314800 -0.938300\nvn 0.943000 0.327700 0.058200\nvn 0.065900 0.937600 -0.341400\nvn -0.896900 0.327700 -0.296900\nvn -0.022800 0.327700 -0.944500\nvn -0.345800 0.937600 -0.036400\nvn -0.219000 0.327700 0.919100\nvn 0.804800 0.314800 -0.503100\nvn -0.168400 0.900600 -0.400700\nvn -0.922600 0.314800 0.223000\nvn 0.610100 0.341400 0.715000\nvn 0.173900 0.976700 -0.125800\nvn -0.488500 0.341400 -0.803000\nvn -0.946100 0.323400 0.017500\nvn -0.046100 0.925400 0.376200\nvn 0.913900 0.323400 0.245400\nvn -0.462000 0.327600 0.824200\nvn 0.279400 0.937300 0.208100\nvn 0.657300 0.327600 -0.678700\nvn 0.017700 0.342000 0.939500\nvn 0.206400 0.978400 0.012000\nvn 0.126600 0.342000 -0.931200\nvn -0.813000 0.344400 0.469400\nvn 0.075700 0.985400 0.152600\nvn 0.865900 0.344400 -0.362700\nvn 0.902700 0.341400 0.261900\nvn 0.076100 0.976700 -0.200700\nvn -0.849500 0.341400 -0.402200\nvn 0.459300 0.341300 -0.820100\nvn -0.179000 0.976500 -0.120100\nvn -0.584500 0.341300 0.736100\nvn -0.489500 0.343100 -0.801700\nvn -0.169500 0.981600 0.087600\nvn 0.371000 0.343100 0.862900\nvn -0.936100 0.343100 0.077100\nvn 0.002100 0.981600 0.190800\nvn 0.937600 0.343100 0.056200\nvn -0.526200 0.341300 -0.778800\nvn -0.187700 0.976500 0.106000\nvn 0.395000 0.341300 0.852900\nvn 0.639600 0.341400 -0.688800\nvn -0.145100 0.976700 -0.158100\nvn -0.741000 0.341400 0.578200\nvn 0.054000 0.344400 0.937300\nvn 0.170400 0.985400 0.001000\nvn 0.065100 0.344400 -0.936600\nvn 0.847300 0.342000 0.406300\nvn 0.103500 0.978400 -0.179000\nvn -0.775000 0.342000 -0.531500\nvn 0.810000 0.342000 -0.476400\nvn -0.090800 0.978400 -0.185800\nvn -0.873500 0.342000 0.346600\nvn 0.807900 0.344400 0.478100\nvn 0.095900 0.985400 -0.140800\nvn -0.740900 0.344400 -0.576600\nvn -0.214700 0.341400 -0.915100\nvn -0.212200 0.976700 0.032200\nvn 0.066400 0.341400 0.937600\nvn -0.940000 0.341300 0.002100\nvn -0.016800 0.976500 0.214900\nvn 0.928200 0.341300 0.148100\nvn -0.458300 0.343100 0.819900\nvn 0.159500 0.981600 0.104700\nvn 0.569800 0.343100 -0.746700\nvn -0.727200 0.343100 0.594500\nvn 0.110000 0.981600 0.155900\nvn 0.804100 0.343100 -0.485500\nvn -0.875100 0.341300 -0.343000\nvn -0.094500 0.976500 0.193700\nvn 0.809100 0.341300 0.478400\nvn 0.136100 0.341400 -0.930000\nvn -0.209200 0.976700 -0.047900\nvn -0.282400 0.341400 0.896500\nvn 0.576100 0.344400 0.741300\nvn 0.140900 0.985400 -0.095800\nvn -0.477600 0.344400 -0.808200\nvn 0.928300 0.342000 -0.146000\nvn -0.016300 0.978400 -0.206100\nvn -0.939700 0.342000 0.001900\nvn -0.668800 0.342000 -0.660200\nvn -0.156200 0.978400 0.135600\nvn 0.559600 0.342000 0.754900\nvn 0.254200 0.344400 -0.903700\nvn -0.160700 0.985400 -0.056400\nvn -0.366600 0.344400 0.864300\nvn -0.829100 0.341400 0.442900\nvn 0.085700 0.976700 0.196800\nvn 0.889000 0.341400 -0.305300\nvn 0.243800 0.341300 0.907800\nvn 0.212000 0.976500 -0.039100\nvn -0.095700 0.341300 -0.935100\nvn 0.910200 0.343100 0.232000\nvn 0.060100 0.981600 -0.181100\nvn -0.868200 0.343100 -0.358600\nvn -0.177700 0.343100 0.922300\nvn 0.184300 0.981600 0.049300\nvn 0.306600 0.343100 -0.887900\nvn -0.891700 0.341300 0.297200\nvn 0.051500 0.976500 0.209300\nvn 0.927800 0.341300 -0.150900\nvn -0.491200 0.341400 -0.801400\nvn -0.191400 0.976700 0.097200\nvn 0.357400 0.341400 0.869300\nvn 0.917200 0.344400 0.200200\nvn 0.046800 0.985400 -0.163800\nvn -0.884500 0.344400 -0.314800\nvn 0.405100 0.341000 0.848300\nvn 0.388800 0.344000 0.854700\nvn 0.145900 0.987800 -0.055200\nvn 0.209600 0.974600 -0.079400\nvn -0.274900 0.344000 -0.897800\nvn -0.258500 0.341000 -0.903800\nvn 0.081500 0.996200 -0.030900\nvn -0.545700 0.341700 0.765200\nvn -0.559300 0.344500 0.754000\nvn 0.112700 0.989100 0.094900\nvn 0.164900 0.976500 0.138900\nvn 0.647800 0.344500 -0.679400\nvn 0.661100 0.341700 -0.668000\nvn 0.060000 0.996900 0.050500\nvn -0.369400 0.348600 -0.861400\nvn -0.352800 0.351000 -0.867400\nvn -0.112900 0.992600 0.044900\nvn -0.177600 0.981800 0.067300\nvn 0.261800 0.340800 0.902900\nvn 0.245100 0.338400 0.908500\nvn -0.047600 0.998600 0.022300\nvn 0.924000 0.342300 0.170700\nvn 0.919600 0.345000 0.187700\nvn 0.035600 0.990300 -0.134100\nvn 0.053200 0.978300 -0.200100\nvn -0.891400 0.345000 -0.293800\nvn -0.886700 0.342300 -0.310700\nvn 0.017900 0.997600 -0.067400\nvn 0.480400 0.338000 -0.809300\nvn 0.494600 0.341700 -0.799200\nvn -0.153600 0.981700 -0.112400\nvn -0.208200 0.966100 -0.152400\nvn -0.612200 0.341700 0.713100\nvn -0.626100 0.338000 0.702700\nvn -0.098300 0.992500 -0.072000\nvn -0.939400 0.338000 -0.056400\nvn -0.936900 0.341700 -0.073600\nvn -0.029600 0.981700 0.188000\nvn -0.040100 0.966100 0.254900\nvn 0.914300 0.341700 0.217600\nvn 0.911400 0.338000 0.234700\nvn -0.018900 0.992500 0.120400\nvn 0.063900 0.338000 -0.939000\nvn 0.081200 0.341700 -0.936300\nvn -0.187800 0.981700 -0.031100\nvn -0.254500 0.966100 -0.042100\nvn -0.224900 0.341700 0.912500\nvn -0.242100 0.338000 0.909500\nvn -0.120200 0.992500 -0.019900\nvn 0.805400 0.338000 0.486900\nvn 0.795200 0.341700 0.501000\nvn 0.113600 0.981700 -0.152700\nvn 0.154000 0.966100 -0.207000\nvn -0.708200 0.341700 -0.617900\nvn -0.697600 0.338000 -0.631700\nvn 0.072800 0.992500 -0.097800\nvn -0.178100 0.342300 0.922600\nvn -0.195100 0.345000 0.918100\nvn 0.133800 0.990300 0.036700\nvn 0.199700 0.978300 0.054800\nvn 0.300900 0.345000 -0.889100\nvn 0.317800 0.342300 -0.884200\nvn 0.067300 0.997600 0.018500\nvn 0.864400 0.348600 -0.362500\nvn 0.870200 0.351000 -0.345800\nvn -0.044000 0.992600 -0.113200\nvn -0.065900 0.981800 -0.178200\nvn -0.905000 0.340800 0.254500\nvn -0.910500 0.338400 0.237800\nvn -0.021900 0.998600 -0.047800\nvn -0.760700 0.341700 -0.551800\nvn -0.749500 0.344500 -0.565300\nvn -0.095800 0.989100 0.111900\nvn -0.140200 0.976500 0.163800\nvn 0.674200 0.344500 0.653300\nvn 0.662600 0.341700 0.666500\nvn -0.051000 0.996900 0.059600\nvn -0.851500 0.341000 0.398300\nvn -0.857800 0.344000 0.381900\nvn 0.054100 0.987800 0.146300\nvn 0.077700 0.974600 0.210200\nvn 0.900000 0.344000 -0.267700\nvn 0.905900 0.341000 -0.251200\nvn 0.030200 0.996200 0.081800\nvn -0.104800 0.341000 -0.934200\nvn -0.087200 0.344000 -0.934900\nvn -0.155900 0.987800 0.004400\nvn -0.224000 0.974600 0.006300\nvn -0.034500 0.344000 0.938300\nvn -0.052000 0.341000 0.938600\nvn -0.087100 0.996200 0.002500\nvn 0.766300 0.341700 -0.544100\nvn 0.775500 0.344500 -0.529100\nvn -0.075400 0.989100 -0.126600\nvn -0.110300 0.976500 -0.185200\nvn -0.834700 0.344500 0.429600\nvn -0.843500 0.341700 0.414400\nvn -0.040100 0.996900 -0.067400\nvn 0.066700 0.348600 0.934900\nvn 0.049100 0.351000 0.935100\nvn 0.121300 0.992600 -0.005400\nvn 0.189900 0.981800 -0.005400\nvn 0.048500 0.340800 -0.938900\nvn 0.066200 0.338400 -0.938700\nvn 0.052300 0.998600 -0.005400\nvn -0.817000 0.342300 -0.464000\nvn -0.807300 0.345000 -0.478700\nvn -0.077600 0.990300 0.115000\nvn -0.115800 0.978300 0.171600\nvn 0.745900 0.345000 0.569700\nvn 0.735900 0.342300 0.584100\nvn -0.039000 0.997600 0.057800\nvn -0.719100 0.338000 0.607200\nvn -0.729200 0.341700 0.593000\nvn 0.108300 0.981700 0.156500\nvn 0.146800 0.966100 0.212200\nvn 0.812000 0.341700 -0.473100\nvn 0.821800 0.338000 -0.458700\nvn 0.069300 0.992500 0.100200\nvn 0.869100 0.338000 0.361100\nvn 0.861100 0.341700 0.376600\nvn 0.089600 0.981700 -0.168000\nvn 0.121400 0.966100 -0.227600\nvn -0.792500 0.341700 -0.505200\nvn -0.784100 0.338000 -0.520400\nvn 0.057300 0.992500 -0.107500\nvn 0.936800 0.338000 -0.090300\nvn 0.937000 0.341700 -0.072900\nvn 0.000000 0.981700 -0.190300\nvn 0.000000 0.966100 -0.258000\nvn -0.937000 0.341700 -0.072900\nvn -0.936800 0.338000 -0.090300\nvn -0.000000 0.992500 -0.121900\nvn -0.348800 0.338000 0.874100\nvn -0.364400 0.341700 0.866300\nvn 0.169200 0.981700 0.087200\nvn 0.229300 0.966100 0.118200\nvn 0.493900 0.341700 -0.799600\nvn 0.509300 0.338000 -0.791400\nvn 0.108300 0.992500 0.055800\nvn -0.939300 0.342300 -0.025000\nvn -0.937600 0.345000 -0.042500\nvn -0.014400 0.990300 0.138000\nvn -0.021500 0.978300 0.206000\nvn 0.926300 0.345000 0.151700\nvn 0.924200 0.342300 0.169200\nvn -0.007200 0.997600 0.069400\nvn 0.498800 0.348600 0.793600\nvn 0.483300 0.351000 0.802000\nvn 0.104500 0.992600 -0.061900\nvn 0.165000 0.981800 -0.094100\nvn -0.398900 0.340800 -0.851300\nvn -0.383300 0.338400 -0.859400\nvn 0.043600 0.998600 -0.029400\nvn 0.420200 0.341700 -0.840700\nvn 0.435300 0.344500 -0.831800\nvn -0.126100 0.989100 -0.076200\nvn -0.184500 0.976500 -0.111600\nvn -0.534400 0.344500 0.771900\nvn -0.549300 0.341700 0.762600\nvn -0.067100 0.996900 -0.040600\nvn -0.532000 0.341000 -0.775000\nvn -0.516900 0.344000 -0.783900\nvn -0.135500 0.987800 0.077200\nvn -0.194700 0.974600 0.111000\nvn 0.411100 0.344000 0.844200\nvn 0.395800 0.341000 0.852700\nvn -0.075700 0.996200 0.043200\nvn 0.882700 0.341000 -0.323500\nvn 0.887500 0.344000 -0.306600\nvn -0.041300 0.987800 -0.150400\nvn -0.059300 0.974600 -0.216100\nvn -0.919700 0.344000 0.189200\nvn -0.924200 0.341000 0.172200\nvn -0.023100 0.996200 -0.084100\nvn 0.710400 0.341700 0.615300\nvn 0.698000 0.344500 0.627800\nvn 0.105100 0.989100 -0.103300\nvn 0.153800 0.976500 -0.151100\nvn -0.615400 0.344500 -0.708900\nvn -0.602800 0.341700 -0.721100\nvn 0.056000 0.996900 -0.055000\nvn -0.892400 0.348600 0.286700\nvn -0.896700 0.351000 0.269600\nvn 0.034000 0.992600 0.116600\nvn 0.050300 0.981800 0.183200\nvn 0.923600 0.340800 -0.175600\nvn 0.927500 0.338400 -0.158500\nvn 0.017700 0.998600 0.049500\nvn 0.256900 0.342300 -0.903800\nvn 0.273500 0.345000 -0.897900\nvn -0.130100 0.990300 -0.048100\nvn -0.194200 0.978300 -0.071800\nvn -0.376400 0.345000 0.859800\nvn -0.392800 0.342300 0.853500\nvn -0.065400 0.997600 -0.024200\nvn -0.760500 0.338000 -0.554500\nvn -0.749100 0.341700 -0.567600\nvn -0.126400 0.981700 0.142300\nvn -0.171300 0.966100 0.192900\nvn 0.652300 0.341700 0.676600\nvn 0.640600 0.338000 0.689500\nvn -0.080900 0.992500 0.091100\nvn -0.144600 0.338000 0.930000\nvn -0.161500 0.341700 0.925800\nvn 0.184400 0.981700 0.047100\nvn 0.249900 0.966100 0.063900\nvn 0.302700 0.341700 -0.889800\nvn 0.319500 0.338000 -0.885200\nvn 0.118100 0.992500 0.030200\nvn 0.324600 0.338000 0.883400\nvn 0.307800 0.341700 0.888000\nvn 0.184100 0.981700 -0.048200\nvn 0.249600 0.966100 -0.065300\nvn -0.166900 0.341700 -0.924900\nvn -0.150000 0.338000 -0.929100\nvn 0.117900 0.992500 -0.030900\nvn -0.934000 0.338000 -0.116000\nvn -0.930400 0.341700 -0.133100\nvn -0.041500 0.981700 0.185800\nvn -0.056200 0.966100 0.251800\nvn 0.898600 0.341700 0.275300\nvn 0.894600 0.338000 0.292200\nvn -0.026600 0.992500 0.118900\nvn -0.213700 0.342300 -0.915000\nvn -0.196300 0.345000 -0.917800\nvn -0.137100 0.990300 0.021000\nvn -0.204700 0.978300 0.031400\nvn 0.087900 0.345000 0.934500\nvn 0.070500 0.342300 0.936900\nvn -0.068900 0.997600 0.010600\nvn -0.641300 0.348600 0.683500\nvn -0.653400 0.351000 0.670700\nvn 0.086300 0.992600 0.085400\nvn 0.132800 0.981800 0.135800\nvn 0.722500 0.340800 -0.601600\nvn 0.734300 0.338400 -0.588500\nvn 0.039500 0.998600 0.034700\nvn 0.919700 0.341700 0.193600\nvn 0.914900 0.344500 0.210400\nvn 0.041800 0.989100 -0.141300\nvn 0.061200 0.976500 -0.206700\nvn -0.882000 0.344500 -0.321400\nvn -0.876900 0.341700 -0.338200\nvn 0.022300 0.996900 -0.075200\nvn 0.619400 0.342000 -0.706700\nvn -0.144600 0.978400 -0.147900\nvn -0.720500 0.342000 0.603300\nvn 0.615000 0.341000 -0.711000\nvn 0.627400 0.344000 -0.698600\nvn -0.109000 0.987800 -0.111500\nvn -0.156700 0.974600 -0.160200\nvn -0.712500 0.344000 0.611500\nvn -0.724600 0.341000 0.598800\nvn -0.060900 0.996200 -0.062300\ns 1\nf 1/1/1 2/2/2 3/3/2 4/4/1\nf 2/2/2 5/5/3 6/6/3 3/3/2\nf 7/1/4 8/2/5 9/3/5 10/4/4\nf 8/2/5 11/5/6 12/6/6 9/3/5\nf 13/1/7 14/2/8 15/3/8 16/4/7\nf 14/2/8 17/5/9 18/6/9 15/3/8\nf 19/1/10 20/2/11 21/3/11 22/4/10\nf 20/2/11 23/5/12 24/6/12 21/3/11\nf 25/1/13 26/2/14 27/3/14 28/4/13\nf 26/2/14 29/5/15 30/6/15 27/3/14\nf 31/1/16 32/2/17 33/3/17 34/4/16\nf 32/2/17 35/5/18 36/6/18 33/3/17\nf 37/1/19 38/2/20 39/3/20 40/4/19\nf 38/2/20 41/5/21 42/6/21 39/3/20\nf 43/1/22 44/2/23 45/3/23 46/4/22\nf 44/2/23 47/5/24 48/6/24 45/3/23\nf 49/1/25 50/2/26 51/3/26 52/4/25\nf 50/2/26 53/5/27 54/6/27 51/3/26\nf 55/1/28 56/2/29 57/3/29 58/4/28\nf 56/2/29 59/5/30 60/6/30 57/3/29\nf 61/1/31 62/2/32 63/3/32 64/4/31\nf 62/2/32 65/5/33 66/6/33 63/3/32\nf 67/1/34 68/2/35 69/3/35 70/4/34\nf 68/2/35 71/5/36 72/6/36 69/3/35\nf 73/1/37 74/2/38 75/3/38 76/4/37\nf 74/2/38 77/5/39 78/6/39 75/3/38\nf 79/1/40 80/2/41 81/3/41 82/4/40\nf 80/2/41 83/5/42 84/6/42 81/3/41\nf 85/1/43 86/2/44 87/3/44 88/4/43\nf 86/2/44 89/5/45 90/6/45 87/3/44\nf 91/1/46 92/2/47 93/3/47 94/4/46\nf 92/2/47 95/5/48 96/6/48 93/3/47\nf 97/1/49 98/2/50 99/3/50 100/4/49\nf 98/2/50 101/5/51 102/6/51 99/3/50\nf 103/1/52 104/2/53 105/3/53 106/4/52\nf 104/2/53 107/5/54 108/6/54 105/3/53\nf 109/1/55 110/2/56 111/3/56 112/4/55\nf 110/2/56 113/5/57 114/6/57 111/3/56\nf 115/1/58 116/2/59 117/3/59 118/4/58\nf 116/2/59 119/5/60 120/6/60 117/3/59\nf 121/1/61 122/2/62 123/3/62 124/4/61\nf 122/2/62 125/5/63 126/6/63 123/3/62\nf 127/1/64 128/2/65 129/3/65 130/4/64\nf 128/2/65 131/5/66 132/6/66 129/3/65\nf 133/1/67 134/2/68 135/3/68 136/4/67\nf 134/2/68 137/5/69 138/6/69 135/3/68\nf 139/1/70 140/2/71 141/3/71 142/4/70\nf 140/2/71 143/5/72 144/6/72 141/3/71\nf 145/1/73 146/2/74 147/3/74 148/4/73\nf 146/2/74 149/5/75 150/6/75 147/3/74\nf 151/1/76 152/2/77 153/3/77 154/4/76\nf 152/2/77 155/5/78 156/6/78 153/3/77\nf 157/1/79 158/2/80 159/3/80 160/4/79\nf 158/2/80 161/5/81 162/6/81 159/3/80\nf 163/1/82 164/2/83 165/3/83 166/4/82\nf 164/2/83 167/5/84 168/6/84 165/3/83\nf 169/1/85 170/2/86 171/3/86 172/4/85\nf 170/2/86 173/5/87 174/6/87 171/3/86\nf 175/1/88 176/2/89 177/3/89 178/4/88\nf 176/2/89 179/5/90 180/6/90 177/3/89\nf 181/1/91 182/2/92 183/3/92 184/4/91\nf 182/2/92 185/5/93 186/6/93 183/3/92\nf 187/1/94 188/2/95 189/3/95 190/4/94\nf 188/2/95 191/5/96 192/6/96 189/3/95\nf 193/1/97 194/2/98 195/3/98 196/4/97\nf 194/2/98 197/5/99 198/6/99 195/3/98\nf 199/1/100 200/2/101 201/3/101 202/4/100\nf 200/2/101 203/5/102 204/6/102 201/3/101\nf 205/1/103 206/2/104 207/3/104 208/4/103\nf 206/2/104 209/5/105 210/6/105 207/3/104\nf 211/1/106 212/2/107 213/3/107 214/4/106\nf 212/2/107 215/5/108 216/6/108 213/3/107\nf 217/1/109 218/2/110 219/3/110 220/4/109\nf 218/2/110 221/5/111 222/6/111 219/3/110\nf 223/1/112 224/2/113 225/3/113 226/4/112\nf 224/2/113 227/5/114 228/6/114 225/3/113\nf 229/1/115 230/2/116 231/3/116 232/4/115\nf 230/2/116 233/5/117 234/6/117 231/3/116\nf 235/1/118 236/2/119 237/3/119 238/4/118\nf 236/2/119 239/5/120 240/6/120 237/3/119\nf 241/1/121 242/2/122 243/3/122 244/4/121\nf 242/2/122 245/5/123 246/6/123 243/3/122\nf 247/1/124 248/2/125 249/3/125 250/4/124\nf 248/2/125 251/5/126 252/6/126 249/3/125\nf 253/1/127 254/2/128 255/3/128 256/4/127\nf 254/2/128 257/5/129 258/6/129 255/3/128\nf 259/1/130 260/2/131 261/3/131 262/4/130\nf 260/2/131 263/5/132 264/6/132 261/3/131\nf 265/1/133 266/2/134 267/3/134 268/4/133\nf 266/2/134 269/5/135 270/6/135 267/3/134\nf 271/1/136 272/2/137 273/3/137 274/4/136\nf 272/2/137 275/5/138 276/6/138 273/3/137\nf 277/1/139 278/2/140 279/3/140 280/4/139\nf 278/2/140 281/5/141 282/6/141 279/3/140\nf 283/1/142 284/2/143 285/3/143 286/4/142\nf 284/2/143 287/5/144 288/6/144 285/3/143\nf 289/1/145 290/2/146 291/3/146 292/4/145\nf 290/2/146 293/5/147 294/6/147 291/3/146\nf 295/4/148 296/7/149 297/8/150 298/3/151\nf 299/9/152 300/6/153 298/3/151 297/8/150\nf 301/10/154 297/8/150 296/7/149\nf 299/9/152 297/8/150 301/10/154\nf 302/4/155 303/7/156 304/8/157 305/3/158\nf 306/9/159 307/6/160 305/3/158 304/8/157\nf 308/10/161 304/8/157 303/7/156\nf 306/9/159 304/8/157 308/10/161\nf 309/4/162 310/7/163 311/8/164 312/3/165\nf 313/9/166 314/6/167 312/3/165 311/8/164\nf 315/10/168 311/8/164 310/7/163\nf 313/9/166 311/8/164 315/10/168\nf 316/4/169 317/7/170 318/8/171 319/3/172\nf 320/9/173 321/6/174 319/3/172 318/8/171\nf 322/10/175 318/8/171 317/7/170\nf 320/9/173 318/8/171 322/10/175\nf 323/4/176 324/7/177 325/8/178 326/3/179\nf 327/9/180 328/6/181 326/3/179 325/8/178\nf 329/10/182 325/8/178 324/7/177\nf 327/9/180 325/8/178 329/10/182\nf 330/4/183 331/7/184 332/8/185 333/3/186\nf 334/9/187 335/6/188 333/3/186 332/8/185\nf 336/10/189 332/8/185 331/7/184\nf 334/9/187 332/8/185 336/10/189\nf 337/4/190 338/7/191 339/8/192 340/3/193\nf 341/9/194 342/6/195 340/3/193 339/8/192\nf 343/10/196 339/8/192 338/7/191\nf 341/9/194 339/8/192 343/10/196\nf 344/4/197 345/7/198 346/8/199 347/3/200\nf 348/9/201 349/6/202 347/3/200 346/8/199\nf 350/10/203 346/8/199 345/7/198\nf 348/9/201 346/8/199 350/10/203\nf 351/4/204 352/7/205 353/8/206 354/3/207\nf 355/9/208 356/6/209 354/3/207 353/8/206\nf 357/10/210 353/8/206 352/7/205\nf 355/9/208 353/8/206 357/10/210\nf 358/4/211 359/7/212 360/8/213 361/3/214\nf 362/9/215 363/6/216 361/3/214 360/8/213\nf 364/10/217 360/8/213 359/7/212\nf 362/9/215 360/8/213 364/10/217\nf 365/4/218 366/7/219 367/8/220 368/3/221\nf 369/9/222 370/6/223 368/3/221 367/8/220\nf 371/10/224 367/8/220 366/7/219\nf 369/9/222 367/8/220 371/10/224\nf 372/4/225 373/7/226 374/8/227 375/3/228\nf 376/9/229 377/6/230 375/3/228 374/8/227\nf 378/10/231 374/8/227 373/7/226\nf 376/9/229 374/8/227 378/10/231\nf 379/4/232 380/7/233 381/8/234 382/3/235\nf 383/9/236 384/6/237 382/3/235 381/8/234\nf 385/10/238 381/8/234 380/7/233\nf 383/9/236 381/8/234 385/10/238\nf 386/4/239 387/7/240 388/8/241 389/3/242\nf 390/9/243 391/6/244 389/3/242 388/8/241\nf 392/10/245 388/8/241 387/7/240\nf 390/9/243 388/8/241 392/10/245\nf 393/4/246 394/7/247 395/8/248 396/3/249\nf 397/9/250 398/6/251 396/3/249 395/8/248\nf 399/10/252 395/8/248 394/7/247\nf 397/9/250 395/8/248 399/10/252\nf 400/4/253 401/7/254 402/8/255 403/3/256\nf 404/9/257 405/6/258 403/3/256 402/8/255\nf 406/10/259 402/8/255 401/7/254\nf 404/9/257 402/8/255 406/10/259\nf 407/4/260 408/7/261 409/8/262 410/3/263\nf 411/9/264 412/6/265 410/3/263 409/8/262\nf 413/10/266 409/8/262 408/7/261\nf 411/9/264 409/8/262 413/10/266\nf 414/4/267 415/7/268 416/8/269 417/3/270\nf 418/9/271 419/6/272 417/3/270 416/8/269\nf 420/10/273 416/8/269 415/7/268\nf 418/9/271 416/8/269 420/10/273\nf 421/4/274 422/7/275 423/8/276 424/3/277\nf 425/9/278 426/6/279 424/3/277 423/8/276\nf 427/10/280 423/8/276 422/7/275\nf 425/9/278 423/8/276 427/10/280\nf 428/4/281 429/7/282 430/8/283 431/3/284\nf 432/9/285 433/6/286 431/3/284 430/8/283\nf 434/10/287 430/8/283 429/7/282\nf 432/9/285 430/8/283 434/10/287\nf 435/4/288 436/7/289 437/8/290 438/3/291\nf 439/9/292 440/6/293 438/3/291 437/8/290\nf 441/10/294 437/8/290 436/7/289\nf 439/9/292 437/8/290 441/10/294\nf 442/4/295 443/7/296 444/8/297 445/3/298\nf 446/9/299 447/6/300 445/3/298 444/8/297\nf 448/10/301 444/8/297 443/7/296\nf 446/9/299 444/8/297 448/10/301\nf 449/4/302 450/7/303 451/8/304 452/3/305\nf 453/9/306 454/6/307 452/3/305 451/8/304\nf 455/10/308 451/8/304 450/7/303\nf 453/9/306 451/8/304 455/10/308\nf 456/4/309 457/7/310 458/8/311 459/3/312\nf 460/9/313 461/6/314 459/3/312 458/8/311\nf 462/10/315 458/8/311 457/7/310\nf 460/9/313 458/8/311 462/10/315\nf 463/4/316 464/7/317 465/8/318 466/3/319\nf 467/9/320 468/6/321 466/3/319 465/8/318\nf 469/10/322 465/8/318 464/7/317\nf 467/9/320 465/8/318 469/10/322\nf 470/4/323 471/7/324 472/8/325 473/3/326\nf 474/9/327 475/6/328 473/3/326 472/8/325\nf 476/10/329 472/8/325 471/7/324\nf 474/9/327 472/8/325 476/10/329\nf 477/4/330 478/7/331 479/8/332 480/3/333\nf 481/9/334 482/6/335 480/3/333 479/8/332\nf 483/10/336 479/8/332 478/7/331\nf 481/9/334 479/8/332 483/10/336\nf 484/4/337 485/7/338 486/8/339 487/3/340\nf 488/9/341 489/6/342 487/3/340 486/8/339\nf 490/10/343 486/8/339 485/7/338\nf 488/9/341 486/8/339 490/10/343\nf 491/4/344 492/7/345 493/8/346 494/3/347\nf 495/9/348 496/6/349 494/3/347 493/8/346\nf 497/10/350 493/8/346 492/7/345\nf 495/9/348 493/8/346 497/10/350\nf 498/4/351 499/7/352 500/8/353 501/3/354\nf 502/9/355 503/6/356 501/3/354 500/8/353\nf 504/10/357 500/8/353 499/7/352\nf 502/9/355 500/8/353 504/10/357\nf 505/4/358 506/7/359 507/8/360 508/3/361\nf 509/9/362 510/6/363 508/3/361 507/8/360\nf 511/10/364 507/8/360 506/7/359\nf 509/9/362 507/8/360 511/10/364\nf 512/4/365 513/7/366 514/8/367 515/3/368\nf 516/9/369 517/6/370 515/3/368 514/8/367\nf 518/10/371 514/8/367 513/7/366\nf 516/9/369 514/8/367 518/10/371\nf 519/4/372 520/7/373 521/8/374 522/3/375\nf 523/9/376 524/6/377 522/3/375 521/8/374\nf 525/10/378 521/8/374 520/7/373\nf 523/9/376 521/8/374 525/10/378\nf 526/4/379 527/7/380 528/8/381 529/3/382\nf 530/9/383 531/6/384 529/3/382 528/8/381\nf 532/10/385 528/8/381 527/7/380\nf 530/9/383 528/8/381 532/10/385\nf 533/4/386 534/7/387 535/8/388 536/3/389\nf 537/9/390 538/6/391 536/3/389 535/8/388\nf 539/10/392 535/8/388 534/7/387\nf 537/9/390 535/8/388 539/10/392\nf 540/1/393 541/2/394 542/3/394 543/4/393\nf 541/2/394 544/5/395 545/6/395 542/3/394\nf 546/4/396 547/7/397 548/8/398 549/3/399\nf 550/9/400 551/6/401 549/3/399 548/8/398\nf 552/10/402 548/8/398 547/7/397\nf 550/9/400 548/8/398 552/10/402\n"},function(t,e,n){"use strict";n.r(e),e.default="# Blender v2.75 (sub 0) OBJ File: ''\n# www.blender.org\no Spruce.001\nv 0.000000 4.848557 -0.113145\nv -0.097987 4.848557 -0.056572\nv 0.000000 11.164840 0.000001\nv 0.000000 0.152242 -0.197273\nv -0.170843 0.152242 -0.098636\nv -0.097987 4.848557 0.056574\nv -0.170843 0.152242 0.098636\nv 0.000000 4.848557 0.113147\nv 0.000000 0.152242 0.197273\nv 0.097987 4.848557 0.056574\nv 0.170843 0.152242 0.098636\nv 0.097987 4.848557 -0.056572\nv 0.170843 0.152242 -0.098636\nv 0.313929 0.000000 0.000000\nv 0.156964 -0.000000 0.271870\nv 0.156964 0.000000 -0.271870\nv -0.156964 -0.000000 0.271870\nv -0.313929 0.000000 0.000000\nv -0.156964 0.000000 -0.271870\nv 0.000000 -0.123511 0.271870\nv 0.201123 -0.079889 0.768636\nv 0.096512 -0.163476 0.723950\nv -0.017141 -0.079889 0.728775\nv 0.086418 0.023142 0.779219\nv -0.170487 -0.292544 1.213677\nv -0.530363 -0.133456 -0.399565\nv -0.655853 -0.052696 -0.398359\nv -0.686822 -0.361053 -0.798870\nv -0.437458 -0.052696 -0.483933\nv -0.566738 0.046850 -0.492399\nv -0.235446 -0.123511 -0.135935\nv 0.235446 -0.123511 -0.135935\nv 0.580023 -0.067900 -0.462976\nv 0.613698 -0.151487 -0.354319\nv 0.690960 -0.067900 -0.270827\nv 0.662354 0.035131 -0.382411\nv 1.001919 -0.347351 -0.578458\nv -0.239835 -0.115751 0.138469\nv 0.000000 -0.115751 -0.276937\nv 0.239835 -0.115751 0.138469\nv 0.000000 -0.156829 -0.000000\nvt 1.333332 0.860277\nvt 1.666665 0.860277\nvt 1.089126 4.018418\nvt 1.333333 -1.487882\nvt 1.666667 -1.487882\nvt 2.000000 0.860277\nvt 0.000000 -1.487882\nvt -0.000000 0.860277\nvt -0.333335 0.860277\nvt -0.333333 -1.487882\nvt 0.333335 0.860277\nvt 0.333333 -1.487882\nvt 0.666668 0.860277\nvt 0.666667 -1.487882\nvt 1.000000 0.860277\nvt 1.000000 -1.487882\nvt 0.833333 -1.564002\nvt 0.500000 -1.564002\nvt 1.166667 -1.564002\nvt 0.166667 -1.564002\nvt -0.166667 -1.564002\nvt -0.500000 -1.564002\nvt -0.666667 -1.487882\nvt 1.500000 -1.564002\nvt 1.000000 0.019041\nvt 0.750000 0.019041\nvt 0.746979 0.144310\nvt 1.000000 0.144310\nvt 0.250000 0.019041\nvt 0.000000 0.019041\nvt 0.000000 0.144310\nvt 0.253021 0.144310\nvt 0.500000 0.000392\nvt 0.500000 0.144310\nvt 0.499997 0.267706\nvt 0.000000 -1.621878\nvt 1.333333 -1.621878\nvt 0.666667 -1.621878\nvt 0.333333 -1.625758\nvt -0.333333 -1.625758\nvt -0.666667 -1.621878\nvt 1.000000 -1.625758\nvt 0.105323 -1.642417\nvn 0.000000 0.017900 -0.999800\nvn -0.865900 0.017900 -0.499900\nvn 0.000000 1.000000 -0.000000\nvn 0.000000 0.380700 -0.924700\nvn -0.708500 0.582100 -0.398900\nvn -0.865900 0.017900 0.499900\nvn -0.800800 0.380700 0.462300\nvn 0.000000 0.017900 0.999800\nvn -0.022800 0.572200 0.819800\nvn 0.865900 0.017900 0.499900\nvn 0.800800 0.380700 0.462300\nvn 0.865900 0.017900 -0.499900\nvn 0.704800 0.581200 -0.406900\nvn 0.872000 0.091500 0.480900\nvn 0.894700 0.104100 0.434300\nvn 0.019500 0.091500 -0.995600\nvn -0.809000 0.086300 0.581500\nvn -0.918900 0.107600 0.379500\nvn 0.113800 0.052100 -0.992100\nvn -0.029500 -0.975300 0.218800\nvn 0.964000 -0.040200 0.263000\nvn 0.153700 -0.977700 -0.142800\nvn -1.000000 -0.007700 0.006100\nvn 0.079300 0.915300 0.395000\nvn -0.449500 -0.379700 0.808600\nvn 0.016700 -0.955700 0.293900\nvn -0.916500 0.066900 0.394400\nvn -0.282400 -0.633000 -0.720800\nvn 0.711900 -0.048400 -0.700600\nvn -0.272900 0.870100 -0.410400\nvn -0.243100 -0.966800 -0.078500\nvn 0.190700 -0.975500 -0.110100\nvn -0.348000 0.008400 -0.937500\nvn -0.202200 -0.972400 0.116700\nvn 0.637900 0.008400 0.770100\nvn 0.392200 0.891600 -0.226500\nvn 0.719800 -0.556000 -0.415600\nvn -0.662000 -0.644700 0.382200\nvn 0.000000 -0.644700 -0.764500\nvn 0.662000 -0.644700 0.382200\nvn 0.000000 -1.000000 -0.000000\ns 1\nf 1/1/1 2/2/2 3/3/3\nf 4/4/4 5/5/5 2/2/2 1/1/1\nf 6/6/6 3/3/3 2/2/2\nf 7/7/7 6/8/6 2/9/2 5/10/5\nf 8/11/8 3/3/3 6/6/6\nf 9/12/9 8/11/8 6/8/6 7/7/7\nf 10/13/10 3/3/3 8/11/8\nf 11/14/11 10/13/10 8/11/8 9/12/9\nf 12/15/12 3/3/3 10/13/10\nf 13/16/13 12/15/12 10/13/10 11/14/11\nf 1/1/1 3/3/3 12/15/12\nf 4/4/4 1/1/1 12/15/12 13/16/13\nf 14/17/14 13/16/13 11/14/11\nf 15/18/15 14/17/14 11/14/11\nf 16/19/16 4/4/4 13/16/13\nf 17/20/17 9/12/9 7/7/7\nf 18/21/18 17/20/17 7/7/7\nf 15/18/15 11/14/11 9/12/9\nf 19/22/19 5/10/5 4/23/4\nf 16/19/16 19/24/19 4/4/4\nf 18/21/18 7/7/7 5/10/5\nf 20/25/20 15/26/15 21/27/21 22/28/22\nf 17/29/17 20/30/20 22/31/22 23/32/23\nf 15/26/15 9/33/9 24/34/24 21/27/21\nf 9/33/9 17/29/17 23/32/23 24/34/24\nf 24/34/24 23/32/23 25/35/25\nf 21/27/21 24/34/24 25/35/25\nf 23/32/23 22/31/22 25/35/25\nf 22/28/22 21/27/21 25/35/25\nf 26/28/26 27/27/27 28/35/28\nf 29/32/29 26/31/26 28/35/28\nf 27/27/27 30/34/30 28/35/28\nf 30/34/30 29/32/29 28/35/28\nf 5/33/5 19/29/19 29/32/29 30/34/30\nf 18/26/18 5/33/5 30/34/30 27/27/27\nf 19/29/19 31/30/31 26/31/26 29/32/29\nf 31/25/31 18/26/18 27/27/27 26/28/26\nf 32/25/32 16/26/16 33/27/33 34/28/34\nf 14/29/14 32/30/32 34/31/34 35/32/35\nf 16/26/16 13/33/13 36/34/36 33/27/33\nf 13/33/13 14/29/14 35/32/35 36/34/36\nf 36/34/36 35/32/35 37/35/37\nf 33/27/33 36/34/36 37/35/37\nf 35/32/35 34/31/34 37/35/37\nf 34/28/34 33/27/33 37/35/37\nf 18/21/18 38/36/38 17/20/17\nf 16/19/16 39/37/39 19/24/19\nf 15/18/15 40/38/40 14/17/14\nf 17/20/17 38/36/38 20/39/20\nf 18/21/18 31/40/31 38/36/38\nf 19/22/19 39/41/39 31/40/31\nf 16/19/16 32/42/32 39/37/39\nf 14/17/14 40/38/40 32/42/32\nf 15/18/15 20/39/20 40/38/40\nf 40/38/40 20/39/20 41/43/41\nf 32/42/32 40/38/40 41/43/41\nf 39/37/39 32/42/32 41/43/41\nf 31/40/31 39/41/39 41/43/41\nf 38/36/38 31/40/31 41/43/41\nf 20/39/20 38/36/38 41/43/41\n"},function(t,e,n){"use strict";e.__esModule=!0;var r=n(0),i=n(10),o=n(126).default,a=n(127).default,s=function(){function t(){this.skyboxShader=new i.default(a,o),this.uInvViewProjectionLocation=this.skyboxShader.getUniformLocation("uInvViewProjection"),this.uSunDirLocation=this.skyboxShader.getUniformLocation("uSunDir")}return t.prototype.draw=function(t,e){this.skyboxShader.use(),this.skyboxShader.setUniformMat4(this.uInvViewProjectionLocation,t),this.skyboxShader.setUniformVec3(this.uSunDirLocation,e),r.gl.drawArrays(r.gl.TRIANGLES,0,3)},t}();e.default=s},function(t,e,n){"use strict";n.r(e),e.default="#version 300 es\n\nprecision mediump float;\n\nuniform mat4 uInvViewProjection;\nuniform vec3 uSunDir;\n\nin vec4 vRay;\nlayout(location = 0) out vec4 oColor;\nlayout(location = 1) out vec4 oDepth;\n\nconst float A = 0.15; // shoulder strength\nconst float B = 0.50; // linear strength\nconst float C = 0.10; // linear angle\nconst float D = 0.20; // toe strength\nconst float E = 0.02; // toe numerator\nconst float F = 0.30; // toe denominator\nconst vec3 W = vec3(11.2); // linear white point value\n\nvec3 uncharted2Tonemap(vec3 x)\n{\n   return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;\n}\n\nvec3 accurateLinearToSRGB(in vec3 linearCol)\n{\n\tvec3 sRGBLo = linearCol * 12.92;\n\tvec3 sRGBHi = (pow(abs(linearCol), vec3(1.0/2.4)) * 1.055) - 0.055;\n\tvec3 sRGB = mix(sRGBLo, sRGBHi, vec3(greaterThan(linearCol, vec3(0.0031308))));\n\treturn sRGB;\n}\n\n//\n// Fast skycolor function by Íñigo Quílez\n// https://www.shadertoy.com/view/MdX3Rr\n//\nvec3 getSkyColor(vec3 rd) {\n\tvec3 sunDir = normalize(uSunDir);\n    float sundot = clamp(dot(rd,sunDir),0.0,1.0);\n\tvec3 col = vec3(0.2,0.5,0.85)*1.1 - max(rd.y,0.01)*max(rd.y,0.01)*0.5;\n    col = mix( col, 0.85*vec3(0.7,0.75,0.85), pow(1.0-max(rd.y,0.0), 6.0) );\n\n    col += 0.25*vec3(1.0,0.7,0.4)*pow( sundot,5.0 );\n    col += 0.25*vec3(1.0,0.8,0.6)*pow( sundot,64.0 );\n    col += 0.20*vec3(1.0,0.8,0.6)*pow( sundot,512.0 );\n    \n    col += clamp((0.1-rd.y)*10., 0., 1.) * vec3(.0,.1,.2);\n    col += 0.2*vec3(1.0,0.8,0.6)*pow( sundot, 8.0 );\n    return col;\n}\n\nvoid main(void) {\n\tvec4 ray = uInvViewProjection * vRay;\n\tray.xyz /= ray.w;\n\tray.xyz = normalize(ray.xyz);\n\n\t//float alpha = ray.y * 0.5 + 0.5;\n\t//alpha = pow(alpha, 0.5);\n\t//vec3 sky = mix(vec3(0.2, 0.1, 0.05), vec3(0.529, 0.808, 0.922) * 1.2, alpha);\n//\n\t//vec3 sunDir = normalize(vec3(0.0, 1.118, 0.559));\n\t//vec3 sun = vec3(1.0, 0.89, 0.77) * min(pow(max(0.0, dot(ray.xyz, sunDir)), 2000.0), 1.0);\n//\n\t//vec3 color = sky + sun;\n\tvec3 color = getSkyColor(ray.xyz);\n\n\toColor = vec4(color, 1.0);\n\t//float alpha = ray.y * 0.5 + 0.5;\n\t//alpha = pow(alpha, 0.5);\n\t//oColor.rgb = mix(vec3(0.2, 0.1, 0.05), vec3(0.529, 0.808, 0.922), alpha);\n\t//oColor.a = 1.0;\n\toDepth = vec4(0.0);\n}"},function(t,e,n){"use strict";n.r(e),e.default="#version 300 es\nprecision highp float;\n\nout vec4 vRay;\n\nvoid main() {\n\tfloat x = -1.0 + float((gl_VertexID & 1) << 2);\n\tfloat y = -1.0 + float((gl_VertexID & 2) << 1);\n\tgl_Position = vec4(x, -y, 1.0, 1.0);\n\tvRay = vec4(x, -y, 1.0, 1.0);\n}"},function(t,e,n){"use strict";e.__esModule=!0;var r=n(8),i=function(){this.viewProjection=r.mat4.create(),this.camPos=r.vec3.create(),this.cursorPosRadius=r.vec3.create(),this.lightDir=r.vec3.create(),this.texelSizeInMeters=1,this.heightScaleInMeters=1,this.enableAlphaBlending=!1,this.drawCursor=!1,this.time=0,this.activeLayers=0,this.layerOrder=[],this.heightMap=null,this.shadowMap=null,this.shadowMap2=null,this.weightMap=null,this.debugTexture=null,this.materialUBO=null};e.default=i},function(t,e,n){"use strict";e.__esModule=!0;var r=n(8),i=n(0),o=n(4),a=n(10),s=n(24),u=2048,l=1024,h=n(130).default,c=n(49).default,f=n(131).default,d=n(27).default,g=function(){function t(){this.terrainShadowsShader=new a.default(c,h),this.uTransformLocation=this.terrainShadowsShader.getUniformLocation("uTransform"),this.uTexelSizeInMetersLocation=this.terrainShadowsShader.getUniformLocation("uTexelSizeInMeters"),this.uHeightScaleInMetersLocation=this.terrainShadowsShader.getUniformLocation("uHeightScaleInMeters"),this.uGridResolutionLocation=this.terrainShadowsShader.getUniformLocation("uGridResolution"),this.uHeightMapLocation=this.terrainShadowsShader.getUniformLocation("uHeightmapTexture"),this.terrainShadowHeightShader=new a.default(d,f),this.uTexelSizeInMetersLocation2=this.terrainShadowHeightShader.getUniformLocation("uTexelSizeInMeters"),this.uHeightScaleInMetersLocation2=this.terrainShadowHeightShader.getUniformLocation("uHeightScaleInMeters"),this.uHeightMapLocation2=this.terrainShadowHeightShader.getUniformLocation("uHeightMap"),this.uShadowMapLocation2=this.terrainShadowHeightShader.getUniformLocation("uShadowMap"),this.uShadowMatrixLocation2=this.terrainShadowHeightShader.getUniformLocation("uShadowMatrix"),this.fbo=i.gl.createFramebuffer(),this.depthAttachment=new s.default,this.depthAttachment.bind(0),i.gl.texStorage2D(i.gl.TEXTURE_2D,1,i.gl.DEPTH_COMPONENT32F,u,u),i.gl.texParameteri(i.gl.TEXTURE_2D,i.gl.TEXTURE_MIN_FILTER,i.gl.LINEAR),i.gl.texParameteri(i.gl.TEXTURE_2D,i.gl.TEXTURE_MAG_FILTER,i.gl.LINEAR),i.gl.texParameteri(i.gl.TEXTURE_2D,i.gl.TEXTURE_WRAP_S,i.gl.CLAMP_TO_EDGE),i.gl.texParameteri(i.gl.TEXTURE_2D,i.gl.TEXTURE_WRAP_T,i.gl.CLAMP_TO_EDGE),i.gl.texParameteri(i.gl.TEXTURE_2D,i.gl.TEXTURE_BASE_LEVEL,0),i.gl.texParameteri(i.gl.TEXTURE_2D,i.gl.TEXTURE_MAX_LEVEL,0),this.shadowMapAttachment=new s.default,this.shadowMapAttachment.bind(0),i.gl.texStorage2D(i.gl.TEXTURE_2D,1,i.gl.R32F,u,u),i.gl.texParameteri(i.gl.TEXTURE_2D,i.gl.TEXTURE_MIN_FILTER,i.gl.LINEAR),i.gl.texParameteri(i.gl.TEXTURE_2D,i.gl.TEXTURE_MAG_FILTER,i.gl.LINEAR),i.gl.texParameteri(i.gl.TEXTURE_2D,i.gl.TEXTURE_WRAP_S,i.gl.CLAMP_TO_EDGE),i.gl.texParameteri(i.gl.TEXTURE_2D,i.gl.TEXTURE_WRAP_T,i.gl.CLAMP_TO_EDGE),i.gl.texParameteri(i.gl.TEXTURE_2D,i.gl.TEXTURE_BASE_LEVEL,0),i.gl.texParameteri(i.gl.TEXTURE_2D,i.gl.TEXTURE_MAX_LEVEL,0),i.gl.bindFramebuffer(i.gl.FRAMEBUFFER,this.fbo),i.gl.framebufferTexture2D(i.gl.FRAMEBUFFER,i.gl.DEPTH_ATTACHMENT,i.gl.TEXTURE_2D,this.depthAttachment.id,0),i.gl.framebufferTexture2D(i.gl.FRAMEBUFFER,i.gl.COLOR_ATTACHMENT0,i.gl.TEXTURE_2D,this.shadowMapAttachment.id,0),i.gl.bindFramebuffer(i.gl.FRAMEBUFFER,null),this.shadowHeightFbo=i.gl.createFramebuffer(),this.shadowHeightMapAttachment=new s.default,this.shadowHeightMapAttachment.bind(0),i.gl.texStorage2D(i.gl.TEXTURE_2D,1,i.gl.R32F,l,l),i.gl.texParameteri(i.gl.TEXTURE_2D,i.gl.TEXTURE_MIN_FILTER,i.gl.LINEAR),i.gl.texParameteri(i.gl.TEXTURE_2D,i.gl.TEXTURE_MAG_FILTER,i.gl.LINEAR),i.gl.texParameteri(i.gl.TEXTURE_2D,i.gl.TEXTURE_WRAP_S,i.gl.CLAMP_TO_EDGE),i.gl.texParameteri(i.gl.TEXTURE_2D,i.gl.TEXTURE_WRAP_T,i.gl.CLAMP_TO_EDGE),i.gl.texParameteri(i.gl.TEXTURE_2D,i.gl.TEXTURE_BASE_LEVEL,0),i.gl.texParameteri(i.gl.TEXTURE_2D,i.gl.TEXTURE_MAX_LEVEL,0),i.gl.bindFramebuffer(i.gl.FRAMEBUFFER,this.shadowHeightFbo),i.gl.framebufferTexture2D(i.gl.FRAMEBUFFER,i.gl.COLOR_ATTACHMENT0,i.gl.TEXTURE_2D,this.shadowHeightMapAttachment.id,0),i.gl.bindFramebuffer(i.gl.FRAMEBUFFER,null),o.default.checkGLError(),this.shadowMatrix=r.mat4.identity(r.mat4.create())}return t.prototype.update=function(t,e,n,a){var s=r.mat4.create(),h=r.vec3.create(),c=1024*t,f=r.vec3.clone([1024*t*.5,0,1024*t*.5]);r.vec3.multiply(h,n,[c,c,c]),r.vec3.add(h,h,f),r.mat4.lookAt(s,h,f,[0,1,0]);var d=r.mat4.create(),g=1024*t*.8;r.mat4.ortho(d,-g,g,-g,g,.01,1024*t*5),r.mat4.multiply(this.shadowMatrix,d,s),i.gl.bindFramebuffer(i.gl.FRAMEBUFFER,this.fbo),i.gl.viewport(0,0,u,u),i.gl.drawBuffers([i.gl.COLOR_ATTACHMENT0]),i.gl.clearBufferfv(i.gl.DEPTH,0,[1]),i.gl.clearBufferfv(i.gl.COLOR,0,[1,0,0,1]),this.terrainShadowsShader.use(),this.terrainShadowsShader.setUniformMat4(this.uTransformLocation,this.shadowMatrix),this.terrainShadowsShader.setUniformF(this.uTexelSizeInMetersLocation,t),this.terrainShadowsShader.setUniformF(this.uHeightScaleInMetersLocation,e),this.terrainShadowsShader.setUniformI(this.uHeightMapLocation,0),this.terrainShadowsShader.setUniformI(this.uGridResolutionLocation,1024),i.gl.activeTexture(i.gl.TEXTURE0),i.gl.bindTexture(i.gl.TEXTURE_2D,a),o.default.checkGLError(),i.gl.enable(i.gl.CULL_FACE),i.gl.cullFace(i.gl.FRONT),i.gl.drawArrays(i.gl.TRIANGLES,0,6316056),i.gl.disable(i.gl.CULL_FACE),o.default.checkGLError(),i.gl.bindFramebuffer(i.gl.FRAMEBUFFER,null),i.gl.bindFramebuffer(i.gl.FRAMEBUFFER,this.shadowHeightFbo),i.gl.viewport(0,0,l,l),i.gl.drawBuffers([i.gl.COLOR_ATTACHMENT0]),this.terrainShadowHeightShader.use(),this.terrainShadowHeightShader.setUniformMat4(this.uShadowMatrixLocation2,this.shadowMatrix),this.terrainShadowHeightShader.setUniformF(this.uTexelSizeInMetersLocation2,t),this.terrainShadowHeightShader.setUniformF(this.uHeightScaleInMetersLocation2,e),this.terrainShadowHeightShader.setUniformI(this.uHeightMapLocation2,0),this.terrainShadowHeightShader.setUniformI(this.uShadowMapLocation2,1),i.gl.activeTexture(i.gl.TEXTURE0),i.gl.bindTexture(i.gl.TEXTURE_2D,a),i.gl.activeTexture(i.gl.TEXTURE1),i.gl.bindTexture(i.gl.TEXTURE_2D,this.shadowMapAttachment.id),o.default.checkGLError(),i.gl.drawArrays(i.gl.TRIANGLES,0,3),o.default.checkGLError(),i.gl.bindFramebuffer(i.gl.FRAMEBUFFER,null)},t.prototype.getShadowMap=function(){return this.shadowHeightMapAttachment},t.prototype.getShadowMatrix=function(){return this.shadowMatrix},t}();e.default=g},function(t,e,n){"use strict";n.r(e),e.default="#version 300 es\n\nprecision mediump float;\n\nout vec4 oColor;\n\nin vec3 vWorldSpacePos;\n\nvoid main(void) {\n\toColor = vec4(vec3(gl_FragCoord.z), 1.0);\n}"},function(t,e,n){"use strict";n.r(e),e.default="#version 300 es\nprecision highp float;\n\nin vec2 vCoords;\n\nuniform sampler2D uHeightMap;\nuniform sampler2D uShadowMap;\nuniform mat4 uShadowMatrix;\nuniform float uTexelSizeInMeters;\nuniform float uHeightScaleInMeters;\n\nout vec4 oShadow;\n\nvoid main(void) {\t\n\tfloat currentHeight = textureLod(uHeightMap, vCoords, 0.0).x;\n\t\n\tvec2 heightMapSize = vec2(textureSize(uHeightMap, 0).xy);\n\tvec2 heightMapTexelSize = 1.0 / heightMapSize;\n\n\tfloat stepSize = 25.0;\n\tvec3 worldPos;\n\tworldPos.xz = vCoords * heightMapSize * uTexelSizeInMeters;\n\tworldPos.y = currentHeight * uHeightScaleInMeters;\n\n\tfloat lastShadowedHeight = -9999.0;\n\tfor (int i = 0; i < 16; ++i) {\n\t\tvec4 shadowPos = uShadowMatrix * vec4(worldPos, 1.0);\n\t\tshadowPos.xyz = shadowPos.xyz * 0.5 + 0.5;\n\t\tbool shadowed = true;\n\t\tfloat shadowDepth;\n\t\tif (any(greaterThanEqual(abs(shadowPos.xy * 2.0 - 1.0), vec2(1.0)))) {\n\t\t\tshadowed = true;\n\t\t} \n\t\telse {\n\t\t\tfloat shadowDepth = texture(uShadowMap, shadowPos.xy).x;\n\t\t\tshadowed = shadowDepth < shadowPos.z - 0.001;\n\t\t}\n\t\tlastShadowedHeight = shadowed ? worldPos.y : lastShadowedHeight;\n\t\tworldPos.y += shadowed ? stepSize : -stepSize;\n\t\tstepSize = shadowed ? stepSize * 0.5 : stepSize;\n\t}\n\n\toShadow = vec4(lastShadowedHeight, 0.0, 0.0, 1.0);\n}"},function(t,e,n){"use strict";e.__esModule=!0;var r=n(0),i=n(4),o=n(10),a=n(25),s=n(133).default,u=n(49).default,l=function(){function t(){this.terrainShader=new o.default(u,s),this.uTransformLocation=this.terrainShader.getUniformLocation("uTransform"),this.uTexelSizeInMetersLocation=this.terrainShader.getUniformLocation("uTexelSizeInMeters"),this.uHeightScaleInMetersLocation=this.terrainShader.getUniformLocation("uHeightScaleInMeters"),this.uGridResolutionLocation=this.terrainShader.getUniformLocation("uGridResolution"),this.uCamPosLocation=this.terrainShader.getUniformLocation("uCamPos"),this.uLightDirLocation=this.terrainShader.getUniformLocation("uLightDir"),this.uCursorPosRadiusLocation=this.terrainShader.getUniformLocation("uCursorPosRadius"),this.uDrawCursorLocation=this.terrainShader.getUniformLocation("uDrawCursor"),this.uHeightmapTexture=this.terrainShader.getUniformLocation("uHeightmapTexture"),this.uTerrainShadowTextureLocation=this.terrainShader.getUniformLocation("uTerrainShadowTexture"),this.uLayerWeightTexture=this.terrainShader.getUniformLocation("uLayerWeightTexture"),this.uAlphaBlendingEnabledLocation=this.terrainShader.getUniformLocation("uAlphaBlendingEnabled"),this.uActiveLayersLocation=this.terrainShader.getUniformLocation("uActiveLayers"),this.uTimeLocation=this.terrainShader.getUniformLocation("uTime"),this.uLayerOrderLocation=[];for(var t=0;t<a.MAX_LAYERS/4;t+=1)this.uLayerOrderLocation[t]=this.terrainShader.getUniformLocation("uLayerOrder["+t+"]");this.uMaterialLocation=r.gl.getUniformBlockIndex(this.terrainShader.getId(),"MATERIAL_BUFFER"),i.default.checkGLError()}return t.prototype.draw=function(t){var e=r.gl.TRIANGLES;this.terrainShader.use(),this.terrainShader.setUniformMat4(this.uTransformLocation,t.viewProjection),this.terrainShader.setUniformF(this.uTexelSizeInMetersLocation,t.texelSizeInMeters),this.terrainShader.setUniformF(this.uHeightScaleInMetersLocation,t.heightScaleInMeters),this.terrainShader.setUniformVec3(this.uCamPosLocation,t.camPos),this.terrainShader.setUniformVec3(this.uLightDirLocation,t.lightDir),this.terrainShader.setUniformVec3(this.uCursorPosRadiusLocation,t.cursorPosRadius),this.terrainShader.setUniformUi(this.uAlphaBlendingEnabledLocation,t.enableAlphaBlending?1:0),this.terrainShader.setUniformUi(this.uActiveLayersLocation,t.activeLayers),this.terrainShader.setUniformUi(this.uDrawCursorLocation,t.drawCursor?1:0),this.terrainShader.setUniformF(this.uTimeLocation,t.time),this.terrainShader.setUniformI(this.uHeightmapTexture,0),this.terrainShader.setUniformI(this.uLayerWeightTexture,1),this.terrainShader.setUniformI(this.uTerrainShadowTextureLocation,2),this.terrainShader.setUniformI(this.uGridResolutionLocation,1024);for(var n=0;n<a.MAX_LAYERS/4;n+=1){for(var o=[],s=0;s<4;s+=1)o[s]=t.layerOrder[4*n+s];this.terrainShader.setUniformUvec4(this.uLayerOrderLocation[n],o)}i.default.checkGLError(),r.gl.uniformBlockBinding(this.terrainShader.getId(),this.uMaterialLocation,0),r.gl.bindBufferBase(r.gl.UNIFORM_BUFFER,0,t.materialUBO),i.default.checkGLError(),r.gl.activeTexture(r.gl.TEXTURE0),r.gl.bindTexture(r.gl.TEXTURE_2D,t.heightMap),r.gl.activeTexture(r.gl.TEXTURE1),r.gl.bindTexture(r.gl.TEXTURE_2D_ARRAY,t.weightMap),r.gl.activeTexture(r.gl.TEXTURE2),r.gl.bindTexture(r.gl.TEXTURE_2D,t.shadowMap2),r.gl.activeTexture(r.gl.TEXTURE3),r.gl.bindTexture(r.gl.TEXTURE_2D,t.debugTexture),i.default.checkGLError(),r.gl.enable(r.gl.CULL_FACE),r.gl.cullFace(r.gl.FRONT),r.gl.drawArrays(e,0,6316056),r.gl.disable(r.gl.CULL_FACE),i.default.checkGLError()},t}();e.default=l},function(t,e,n){"use strict";n.r(e),e.default="#version 300 es\n\n#ifndef PI\n#define PI (3.14159265359)\n#endif // PI\n\n#ifndef MAX_LAYERS\n#define MAX_LAYERS (8)\n#endif // MAX_LAYERS\n\nprecision mediump float;\nprecision highp sampler2DArray;\n\nuniform sampler2D uHeightmapTexture;\nuniform sampler2D uSurfacemapTexture;\nuniform sampler2DArray uLayerWeightTexture;\nuniform sampler2D uTerrainShadowTexture;\nuniform sampler2D uErosionDebugTexture;\nuniform vec3 uColor;\nuniform vec3 uCamPos;\nuniform vec3 uCursorPosRadius;\nuniform vec3 uLightDir;\nuniform float uTexelSizeInMeters;\nuniform float uHeightScaleInMeters;\nuniform uint uActiveLayers;\nuniform uvec4 uLayerOrder[2];\nuniform uint uAlphaBlendingEnabled;\nuniform uint uDrawCursor;\nuniform float uTime;\n\nstruct Material {\n\tuint albedoRoughness;\n\tuint pad0;\n\tuint pad1;\n\tuint pad2;\n};\n\nlayout(std140) uniform MATERIAL_BUFFER\n{\n    Material materials[MAX_LAYERS];\n} uMaterial;\n\nin vec3 vWorldSpacePos;\nin float vIsSkirt;\n\nlayout(location = 0) out vec4 oColor;\nlayout(location = 1) out vec4 oDepth;\n\nstruct LightingParams {\n\tvec3 albedo;\n\tvec3 N;\n\tvec3 V;\n\tfloat metalness;\n\tfloat roughness;\n};\n\nconst float A = 0.15; // shoulder strength\nconst float B = 0.50; // linear strength\nconst float C = 0.10; // linear angle\nconst float D = 0.20; // toe strength\nconst float E = 0.02; // toe numerator\nconst float F = 0.30; // toe denominator\nconst vec3 W = vec3(11.2); // linear white point value\n\nvec3 uncharted2Tonemap(vec3 x)\n{\n   return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;\n}\n\nvec3 accurateLinearToSRGB(in vec3 linearCol)\n{\n\tvec3 sRGBLo = linearCol * 12.92;\n\tvec3 sRGBHi = (pow(abs(linearCol), vec3(1.0/2.4)) * 1.055) - 0.055;\n\tvec3 sRGB = mix(sRGBLo, sRGBHi, vec3(greaterThan(linearCol, vec3(0.0031308))));\n\treturn sRGB;\n}\n\nfloat DistributionGGX(vec3 N, vec3 H, float roughness) {\n    float a2 = roughness*roughness;\n    a2 *= a2;\n    float NdotH2 = max(dot(N, H), 0.0);\n    NdotH2 *= NdotH2;\n\n    float nom   = a2;\n    float denom = NdotH2 * (a2 - 1.0) + 1.0;\n\n    denom = PI * denom * denom;\n\n    return nom / max(denom, 0.0000001);\n}\n\nfloat GeometrySmith(float NdotV, float NdotL, float roughness) {\n\tfloat r = (roughness + 1.0);\n    float k = (r*r) / 8.0;\n    float ggx2 =  NdotV / max(NdotV * (1.0 - k) + k, 0.0000001);\n    float ggx1 = NdotL / max(NdotL * (1.0 - k) + k, 0.0000001);\n\n    return ggx1 * ggx2;\n}\n\n\nvec3 fresnelSchlick(float HdotV, vec3 F0) {\n\tfloat power = (-5.55473 * HdotV - 6.98316) * HdotV;\n\treturn F0 + (1.0 - F0) * pow(2.0, power);\n}\n\nvec3 cookTorranceSpecularBrdf(const LightingParams params, vec3 radiance, vec3 L) {\n\tvec3 H = normalize(params.V + L);\n\tfloat NdotL = max(dot(params.N, L), 0.0);\n\tfloat NdotV = max(dot(params.N, params.V), 0.0);\n\t\n\t// Cook-Torrance BRDF\n\tfloat NDF = DistributionGGX(params.N, H, params.roughness);\n\tfloat G = GeometrySmith(NdotV, NdotL, params.roughness);\n\tvec3 F0 = mix(vec3(0.04), params.albedo, params.metalness);\n\tvec3 F = fresnelSchlick(max(dot(H, params.V), 0.0), F0);\n\t\n\tvec3 numerator = NDF * G * F;\n\tfloat denominator = max(4.0 * NdotV * NdotL, 1e-6);\n\n\tvec3 specular = numerator * (1.0 / denominator);\n\t\n\t// because of energy conversion kD and kS must add up to 1.0.\n\t// multiply kD by the inverse metalness so if a material is metallic, it has no diffuse lighting (and otherwise a blend)\n\tvec3 kD = (vec3(1.0) - F) * (1.0 - params.metalness);\n\n\treturn (kD * params.albedo * (1.0 / PI) + specular) * radiance * NdotL;\n}\n\nfloat linearDepth(float depth)\n{\n\tfloat n = 0.1;\n\tfloat f = 10000.0;\n    float z_n = 2.0 * depth - 1.0;\n    return 2.0 * n * f / (f + n - z_n * (f - n));\n}\n\n// returns the grid value 1.0 is grid, 0.0 no grid\nfloat getGridValue(vec3 position, vec3 campos, float size) {\n\tvec2 coord = position.xz / size;\n\tvec2 grid = abs(fract(coord - 0.5) - 0.5) / fwidth(coord);\n\tfloat lines = min(grid.x, grid.y);\n\n\tvec3 pc = campos - position;\n\tpc.y *= 0.333; // make the grid spread more in y than in xz\n\tfloat distanceLimiter = max(min(1.0 - dot(pc, pc) / 400000.0, 1.0), 0.0); // grid is only visible around camera position\n\n\treturn max(min(1.0 - lines / distanceLimiter, 1.0), 0.0);\n}\n\nvec4 unpackUnorm4x8(uint value){\n\tvec4 result = vec4(0.0);\n\tresult[0] = float((value >> 24) & 0xFFu) / 255.0;\n\tresult[1] = float((value >> 16) & 0xFFu) / 255.0;\n\tresult[2] = float((value >> 8) & 0xFFu) / 255.0;\n\tresult[3] = float(value & 0xFFu) / 255.0;\n\treturn result;\n}\n\nfloat w0(float a)\n{\n\treturn (1.0/6.0)*(a*(a*(-a + 3.0) - 3.0) + 1.0);\n}\n\nfloat w1(float a)\n{\n\treturn (1.0/6.0)*(a*a*(3.0*a - 6.0) + 4.0);\n}\n\nfloat w2(float a)\n{\n\treturn (1.0/6.0)*(a*(a*(-3.0*a + 3.0) + 3.0) + 1.0);\n}\n\nfloat w3(float a)\n{\n\treturn (1.0/6.0)*(a*a*a);\n}\n\n// g0 and g1 are the two amplitude functions\nfloat g0(float a)\n{\n\treturn w0(a) + w1(a);\n}\n\nfloat g1(float a)\n{\n\treturn w2(a) + w3(a);\n}\n\n// h0 and h1 are the two offset functions\nfloat h0(float a)\n{\n\treturn -1.0 + w1(a) / (w0(a) + w1(a));\n}\n\nfloat h1(float a)\n{\n\treturn 1.0 + w3(a) / (w2(a) + w3(a));\n}\n\nvec4 textureBicubic(sampler2D tex, vec2 uv, vec2 res) {\n\tuv = uv * res + 0.5;\n\tvec2 iuv = floor(uv);\n\tvec2 fuv = fract(uv);\n\n\tfloat g0x = g0(fuv.x);\n\tfloat g1x = g1(fuv.x);\n\tfloat h0x = h0(fuv.x);\n\tfloat h1x = h1(fuv.x);\n\tfloat h0y = h0(fuv.y);\n\tfloat h1y = h1(fuv.y);\n\n\tvec2 p0 = (vec2(iuv.x + h0x, iuv.y + h0y) - 0.5) / res;\n\tvec2 p1 = (vec2(iuv.x + h1x, iuv.y + h0y) - 0.5) / res;\n\tvec2 p2 = (vec2(iuv.x + h0x, iuv.y + h1y) - 0.5) / res;\n\tvec2 p3 = (vec2(iuv.x + h1x, iuv.y + h1y) - 0.5) / res;\n\n\treturn g0(fuv.y) * (g0x * texture(tex, p0) + g1x * texture(tex, p1)) + g1(fuv.y) * (g0x * texture(tex, p2) + g1x * texture(tex, p3));\n}\n\nvec4 textureBicubic(sampler2DArray tex, vec3 uv, vec2 res) {\n\tuv.xy = uv.xy * res + 0.5;\n\tvec2 iuv = floor(uv.xy);\n\tvec2 fuv = fract(uv.xy);\n\n\tfloat g0x = g0(fuv.x);\n\tfloat g1x = g1(fuv.x);\n\tfloat h0x = h0(fuv.x);\n\tfloat h1x = h1(fuv.x);\n\tfloat h0y = h0(fuv.y);\n\tfloat h1y = h1(fuv.y);\n\n\tvec2 p0 = (vec2(iuv.x + h0x, iuv.y + h0y) - 0.5) / res;\n\tvec2 p1 = (vec2(iuv.x + h1x, iuv.y + h0y) - 0.5) / res;\n\tvec2 p2 = (vec2(iuv.x + h0x, iuv.y + h1y) - 0.5) / res;\n\tvec2 p3 = (vec2(iuv.x + h1x, iuv.y + h1y) - 0.5) / res;\n\n\treturn g0(fuv.y) * (g0x * texture(tex, vec3(p0, uv.z)) + g1x * texture(tex, vec3(p1, uv.z))) + g1(fuv.y) * (g0x * texture(tex, vec3(p2, uv.z)) + g1x * texture(tex, vec3(p3, uv.z)));\n}\n\nvoid main(void) {\n\tbool isSkirt = vIsSkirt != 0.0;\n\n\tvec2 texSize = vec2(textureSize(uHeightmapTexture, 0).xy);\n\tvec2 texelSize = (1.0 / texSize);\n\tvec2 texCoord = vWorldSpacePos.xz  * uTexelSizeInMeters * texelSize;\n\n\tvec3 P = vec3(vWorldSpacePos.x, textureBicubic(uHeightmapTexture, texCoord, texSize).x * uHeightScaleInMeters, vWorldSpacePos.z);\n\t// Sample neighboring pixels\n\tvec3 Pr = vWorldSpacePos + vec3(uTexelSizeInMeters, 0.0, 0.0);\n\tvec3 Pl = vWorldSpacePos + vec3(-uTexelSizeInMeters, 0.0, 0.0);\n\tvec3 Pb = vWorldSpacePos + vec3(0.0, 0.0, uTexelSizeInMeters);\n\tvec3 Pt = vWorldSpacePos + vec3(0.0, 0.0, -uTexelSizeInMeters);\n\n\tPr.y = textureBicubic(uHeightmapTexture, Pr.xz  * uTexelSizeInMeters * texelSize, texSize).x * uHeightScaleInMeters;\n\tPl.y = textureBicubic(uHeightmapTexture, Pl.xz  * uTexelSizeInMeters * texelSize, texSize).x * uHeightScaleInMeters;\n\tPb.y = textureBicubic(uHeightmapTexture, Pb.xz  * uTexelSizeInMeters * texelSize, texSize).x * uHeightScaleInMeters;\n\tPt.y = textureBicubic(uHeightmapTexture, Pt.xz  * uTexelSizeInMeters * texelSize, texSize).x * uHeightScaleInMeters;\n\n\t// Calculate tangent basis vectors using the difference\n\tvec3 dPdu =  Pr - Pl;\n\tvec3 dPdv =  Pt - Pb;\n\n\tvec3 N = normalize(cross(dPdu, dPdv));\n\n\t// calculate surface color\n\tvec4 surfaceWeights = texture(uSurfacemapTexture, texCoord);\n\tvec4 albedoRoughness = vec4(0.0);\n\tfloat weightSum = 0.0;\n\n\tvec4 weights[2];\n\tweights[0] = textureBicubic(uLayerWeightTexture, vec3(texCoord, 0.0), vec2(textureSize(uLayerWeightTexture, 0).xy));\n\tweights[1] = textureBicubic(uLayerWeightTexture, vec3(texCoord, 1.0), vec2(textureSize(uLayerWeightTexture, 0).xy));\n\n\tfor (uint i = 0u; i < uint(MAX_LAYERS); ++i) {\n\t\tuint layerid = uLayerOrder[i / 4u][i % 4u];\n\t\tfloat weight = weights[layerid / 4u][layerid % 4u];\n\n\t\tMaterial material = uMaterial.materials[layerid];\n\t\tweight *= (uActiveLayers & (1u << layerid)) != 0u ? 1.0 : 0.0;\n\t\tvec4 layerAlbedoRoughness = unpackUnorm4x8(material.albedoRoughness);\n\t\talbedoRoughness = uAlphaBlendingEnabled != 0u ? mix(albedoRoughness, layerAlbedoRoughness, weight) : albedoRoughness + layerAlbedoRoughness * weight;\n\t\tweightSum += weight;\n\t}\n\n\talbedoRoughness = uAlphaBlendingEnabled == 0u && weightSum != 0.0 ? albedoRoughness / weightSum : albedoRoughness;\n\talbedoRoughness.a = 0.8;\n\n\t//albedo += surfaceWeights[0] * vec3(1.0, 1.0, 1.0);\n\t//albedo += surfaceWeights[1] * vec3(0.2, 0.2, 0.2);\n\t//albedo += surfaceWeights[2] * vec3(0.07, 0.4, 0.05);\n\t//albedo += surfaceWeights[3] * vec3(0.2, 0.1, 0.05);\n\n\n\t//\n\tLightingParams lightingParams;\n\tlightingParams.albedo = albedoRoughness.rgb;\n\t// lightingParams.albedo = vec3(0.07, 0.2, 0.05);\n\tlightingParams.N = N;\n\tlightingParams.V = normalize(uCamPos - P);\n\tlightingParams.metalness = 0.0;\n\tlightingParams.roughness = albedoRoughness.a;\n\n\tfloat terrainShadowHeight = texture(uTerrainShadowTexture, texCoord).x;\n\tfloat currentHeight = P.y;\n\tfloat penumbraZone = 25.0;\n\tfloat distToShadowHeight = -clamp(currentHeight - terrainShadowHeight, -penumbraZone, 0.0);\n\tfloat shadowAlpha = 1.0 - distToShadowHeight / penumbraZone;\n\tfloat shadow = smoothstep(0.0, 1.0, shadowAlpha);\n\n\tvec3 color = cookTorranceSpecularBrdf(lightingParams, vec3(10.0), normalize(uLightDir)) * shadow;\n\n\tvec3 skyColor = pow(vec3(0.529, 0.808, 0.922), vec3(2.2));\n\n\t// ambient\n\tvec3 ambientColor = mix(vec3(0.18), skyColor, vec3(N.y) * 0.5 + 0.5);\n\tcolor += ambientColor * 2.0 * (1.0 / PI) * lightingParams.albedo;\n\n\tcolor = isSkirt ? color * 0.1 : color;\n\n\t// fog\n\tfloat fogAlpha = exp(-0.66 * linearDepth(gl_FragCoord.z) / 10000.0);\n\tcolor += mix(skyColor, color, clamp(fogAlpha * fogAlpha, 0.0, 1.0));\n\n\n\tcolor = uncharted2Tonemap(1.0 * color);\n\tvec3 whiteScale = 1.0/uncharted2Tonemap(W);\n\tcolor *= whiteScale;\n    // gamma correct\n    color = accurateLinearToSRGB(color);//pow(color, vec3(1.0/2.2));\n\n\t//color = texture(uErosionDebugTexture, texCoord).x == 0.0 ? vec3(1.0) : vec3(0.0);\n\n\t// apply grid\n\t// color *= max(0.95, getGridValue(vWorldSpacePos, uCamPos, 8.0));\n\n\t// color = min(max(color, 0.0), 1.0);\n\tif (!isSkirt) {\n\t\tfloat currentColorBrightness = step(0.5, max(color.r, max(color.g, color.b)));\n\t\tvec3 gridColor = -0.13 * vec3(currentColorBrightness - 0.5) * getGridValue(vWorldSpacePos, uCamPos, 8.0);\n\t\tcolor += gridColor;\n\t}\n\t\n\n\t// mouse cursor\n\tif (uDrawCursor != 0u)\n\t{\n\t\tvec3 cursorColor = vec3(1.0, 0.0, 0.0);\n\t\tfloat distToBrushBorder = abs(uCursorPosRadius.z - distance(vWorldSpacePos.xz, uCursorPosRadius.xy));\n\t\tfloat alpha = 1.0 - clamp(distToBrushBorder / min(fwidth(vWorldSpacePos.x), fwidth(vWorldSpacePos.z)) * 0.5, 0.2, 1.0);\n\t\tvec2 centerToBorder = normalize(vWorldSpacePos.xz - uCursorPosRadius.xy);\n\t\tfloat angle = atan(centerToBorder.y, centerToBorder.x);\n\t\tangle += uTime * 0.0002;\n\t\tangle *= (1.0 / (2.0 * PI));\n\t\tangle = fract(angle);\n\t\tangle *= 32.0;\n\t\tcursorColor = mix(vec3(1.0), vec3(0.0), (int(angle) & 1) != 0 ? 1.0 : 0.0);\n\t\tcolor = mix(color, cursorColor, vec3(alpha));\n\t}\n\n\t//\t\n\toColor = vec4(color, 1.0);\n\toDepth = isSkirt ? vec4(0.0) : vec4(vWorldSpacePos, 1.0);\n}"},function(t,e,n){"use strict";e.__esModule=!0;var r=n(0),i=n(4),o=n(10),a=n(135).default,s=n(136).default,u=function(){function t(){this.waterShader=new o.default(s,a),this.uTransformLocation=this.waterShader.getUniformLocation("uTransform"),this.uTexelSizeInMetersLocation=this.waterShader.getUniformLocation("uTexelSizeInMeters"),this.uHeightScaleInMetersLocation=this.waterShader.getUniformLocation("uHeightScaleInMeters"),this.uGridResolutionLocation=this.waterShader.getUniformLocation("uGridResolution"),this.uTerrainHeightTextureLocation=this.waterShader.getUniformLocation("uTerrainHeightTexture"),this.uWaterHeightTextureLocation=this.waterShader.getUniformLocation("uWaterHeightTexture"),this.uCamPosLocation=this.waterShader.getUniformLocation("uCamPos"),this.uLightDirLocation=this.waterShader.getUniformLocation("uLightDir"),this.uTerrainShadowTextureLocation=this.waterShader.getUniformLocation("uTerrainShadowTexture"),i.default.checkGLError()}return t.prototype.draw=function(t){var e=r.gl.TRIANGLES;this.waterShader.use(),this.waterShader.setUniformMat4(this.uTransformLocation,t.viewProjection),this.waterShader.setUniformF(this.uTexelSizeInMetersLocation,t.texelSizeInMeters),this.waterShader.setUniformF(this.uHeightScaleInMetersLocation,t.heightScaleInMeters),this.waterShader.setUniformI(this.uGridResolutionLocation,1024),this.waterShader.setUniformI(this.uTerrainHeightTextureLocation,0),this.waterShader.setUniformI(this.uWaterHeightTextureLocation,1),this.waterShader.setUniformI(this.uTerrainShadowTextureLocation,2),this.waterShader.setUniformVec3(this.uCamPosLocation,t.camPos),this.waterShader.setUniformVec3(this.uLightDirLocation,t.lightDir),r.gl.activeTexture(r.gl.TEXTURE0),r.gl.bindTexture(r.gl.TEXTURE_2D,t.heightMap),r.gl.activeTexture(r.gl.TEXTURE1),r.gl.bindTexture(r.gl.TEXTURE_2D,t.debugTexture),r.gl.activeTexture(r.gl.TEXTURE2),r.gl.bindTexture(r.gl.TEXTURE_2D,t.shadowMap2),i.default.checkGLError(),r.gl.enable(r.gl.CULL_FACE),r.gl.enable(r.gl.BLEND),r.gl.blendFunc(r.gl.SRC_ALPHA,r.gl.ONE_MINUS_SRC_ALPHA),r.gl.blendEquation(r.gl.FUNC_ADD),r.gl.cullFace(r.gl.FRONT),r.gl.drawArrays(e,0,6316056),r.gl.disable(r.gl.BLEND),r.gl.disable(r.gl.CULL_FACE),i.default.checkGLError()},t}();e.default=u},function(t,e,n){"use strict";n.r(e),e.default="#version 300 es\n\n#ifndef PI\n#define PI (3.14159265359)\n#endif // PI\n\nprecision mediump float;\n\nuniform vec3 uCamPos;\nuniform vec3 uLightDir;\nuniform float uTexelSizeInMeters;\nuniform float uHeightScaleInMeters;\nuniform sampler2D uTerrainHeightTexture;\nuniform sampler2D uWaterHeightTexture;\nuniform sampler2D uTerrainShadowTexture;\n\nlayout(location = 0) out vec4 oColor;\n\nin vec3 vWorldSpacePos;\n\nstruct LightingParams {\n\tvec3 albedo;\n\tvec3 N;\n\tvec3 V;\n\tfloat metalness;\n\tfloat roughness;\n};\n\nconst float A = 0.15; // shoulder strength\nconst float B = 0.50; // linear strength\nconst float C = 0.10; // linear angle\nconst float D = 0.20; // toe strength\nconst float E = 0.02; // toe numerator\nconst float F = 0.30; // toe denominator\nconst vec3 W = vec3(11.2); // linear white point value\n\nvec3 uncharted2Tonemap(vec3 x)\n{\n   return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;\n}\n\nvec3 accurateLinearToSRGB(in vec3 linearCol)\n{\n\tvec3 sRGBLo = linearCol * 12.92;\n\tvec3 sRGBHi = (pow(abs(linearCol), vec3(1.0/2.4)) * 1.055) - 0.055;\n\tvec3 sRGB = mix(sRGBLo, sRGBHi, vec3(greaterThan(linearCol, vec3(0.0031308))));\n\treturn sRGB;\n}\n\nfloat DistributionGGX(vec3 N, vec3 H, float roughness) {\n    float a2 = roughness*roughness;\n    a2 *= a2;\n    float NdotH2 = max(dot(N, H), 0.0);\n    NdotH2 *= NdotH2;\n\n    float nom   = a2;\n    float denom = NdotH2 * (a2 - 1.0) + 1.0;\n\n    denom = PI * denom * denom;\n\n    return nom / max(denom, 0.0000001);\n}\n\nfloat GeometrySmith(float NdotV, float NdotL, float roughness) {\n\tfloat r = (roughness + 1.0);\n    float k = (r*r) / 8.0;\n    float ggx2 =  NdotV / max(NdotV * (1.0 - k) + k, 0.0000001);\n    float ggx1 = NdotL / max(NdotL * (1.0 - k) + k, 0.0000001);\n\n    return ggx1 * ggx2;\n}\n\n\nvec3 fresnelSchlick(float HdotV, vec3 F0) {\n\tfloat power = (-5.55473 * HdotV - 6.98316) * HdotV;\n\treturn F0 + (1.0 - F0) * pow(2.0, power);\n}\n\nvec3 cookTorranceSpecularBrdf(const LightingParams params, vec3 radiance, vec3 L) {\n\tvec3 H = normalize(params.V + L);\n\tfloat NdotL = max(dot(params.N, L), 0.0);\n\tfloat NdotV = max(dot(params.N, params.V), 0.0);\n\t\n\t// Cook-Torrance BRDF\n\tfloat NDF = DistributionGGX(params.N, H, params.roughness);\n\tfloat G = GeometrySmith(NdotV, NdotL, params.roughness);\n\tvec3 F0 = mix(vec3(0.04), params.albedo, params.metalness);\n\tvec3 F = fresnelSchlick(max(dot(H, params.V), 0.0), F0);\n\t\n\tvec3 numerator = NDF * G * F;\n\tfloat denominator = max(4.0 * NdotV * NdotL, 1e-6);\n\n\tvec3 specular = numerator * (1.0 / denominator);\n\t\n\t// because of energy conversion kD and kS must add up to 1.0.\n\t// multiply kD by the inverse metalness so if a material is metallic, it has no diffuse lighting (and otherwise a blend)\n\tvec3 kD = (vec3(1.0) - F) * (1.0 - params.metalness);\n\n\treturn (kD * params.albedo * (1.0 / PI) + specular) * radiance * NdotL;\n}\n\n\nfloat w0(float a)\n{\n\treturn (1.0/6.0)*(a*(a*(-a + 3.0) - 3.0) + 1.0);\n}\n\nfloat w1(float a)\n{\n\treturn (1.0/6.0)*(a*a*(3.0*a - 6.0) + 4.0);\n}\n\nfloat w2(float a)\n{\n\treturn (1.0/6.0)*(a*(a*(-3.0*a + 3.0) + 3.0) + 1.0);\n}\n\nfloat w3(float a)\n{\n\treturn (1.0/6.0)*(a*a*a);\n}\n\n// g0 and g1 are the two amplitude functions\nfloat g0(float a)\n{\n\treturn w0(a) + w1(a);\n}\n\nfloat g1(float a)\n{\n\treturn w2(a) + w3(a);\n}\n\n// h0 and h1 are the two offset functions\nfloat h0(float a)\n{\n\treturn -1.0 + w1(a) / (w0(a) + w1(a));\n}\n\nfloat h1(float a)\n{\n\treturn 1.0 + w3(a) / (w2(a) + w3(a));\n}\n\nvec4 textureBicubic(sampler2D tex, vec2 uv, vec2 res) {\n\tuv = uv * res + 0.5;\n\tvec2 iuv = floor(uv);\n\tvec2 fuv = fract(uv);\n\n\tfloat g0x = g0(fuv.x);\n\tfloat g1x = g1(fuv.x);\n\tfloat h0x = h0(fuv.x);\n\tfloat h1x = h1(fuv.x);\n\tfloat h0y = h0(fuv.y);\n\tfloat h1y = h1(fuv.y);\n\n\tvec2 p0 = (vec2(iuv.x + h0x, iuv.y + h0y) - 0.5) / res;\n\tvec2 p1 = (vec2(iuv.x + h1x, iuv.y + h0y) - 0.5) / res;\n\tvec2 p2 = (vec2(iuv.x + h0x, iuv.y + h1y) - 0.5) / res;\n\tvec2 p3 = (vec2(iuv.x + h1x, iuv.y + h1y) - 0.5) / res;\n\n\treturn g0(fuv.y) * (g0x * texture(tex, p0) + g1x * texture(tex, p1)) + g1(fuv.y) * (g0x * texture(tex, p2) + g1x * texture(tex, p3));\n}\n\nvec4 textureBicubic(sampler2DArray tex, vec3 uv, vec2 res) {\n\tuv.xy = uv.xy * res + 0.5;\n\tvec2 iuv = floor(uv.xy);\n\tvec2 fuv = fract(uv.xy);\n\n\tfloat g0x = g0(fuv.x);\n\tfloat g1x = g1(fuv.x);\n\tfloat h0x = h0(fuv.x);\n\tfloat h1x = h1(fuv.x);\n\tfloat h0y = h0(fuv.y);\n\tfloat h1y = h1(fuv.y);\n\n\tvec2 p0 = (vec2(iuv.x + h0x, iuv.y + h0y) - 0.5) / res;\n\tvec2 p1 = (vec2(iuv.x + h1x, iuv.y + h0y) - 0.5) / res;\n\tvec2 p2 = (vec2(iuv.x + h0x, iuv.y + h1y) - 0.5) / res;\n\tvec2 p3 = (vec2(iuv.x + h1x, iuv.y + h1y) - 0.5) / res;\n\n\treturn g0(fuv.y) * (g0x * texture(tex, vec3(p0, uv.z)) + g1x * texture(tex, vec3(p1, uv.z))) + g1(fuv.y) * (g0x * texture(tex, vec3(p2, uv.z)) + g1x * texture(tex, vec3(p3, uv.z)));\n}\n\nfloat linearDepth(float depth)\n{\n\tfloat n = 0.1;\n\tfloat f = 10000.0;\n    float z_n = 2.0 * depth - 1.0;\n    return 2.0 * n * f / (f + n - z_n * (f - n));\n}\n\nvoid main(void) {\n\n\tvec2 texSize = vec2(textureSize(uTerrainHeightTexture, 0).xy);\n\tvec2 texelSize = (1.0 / texSize);\n\tvec2 texCoord = vWorldSpacePos.xz  * uTexelSizeInMeters * texelSize;\n\n\tvec3 P = vec3(vWorldSpacePos.x, textureBicubic(uTerrainHeightTexture, texCoord, texSize).x * uHeightScaleInMeters, vWorldSpacePos.z);\n\tP.y += textureBicubic(uWaterHeightTexture, texCoord, texSize).x * uHeightScaleInMeters;\n\n\t// Sample neighboring pixels\n\tvec3 Pr = vWorldSpacePos + vec3(uTexelSizeInMeters, 0.0, 0.0);\n\tvec3 Pl = vWorldSpacePos + vec3(-uTexelSizeInMeters, 0.0, 0.0);\n\tvec3 Pb = vWorldSpacePos + vec3(0.0, 0.0, uTexelSizeInMeters);\n\tvec3 Pt = vWorldSpacePos + vec3(0.0, 0.0, -uTexelSizeInMeters);\n\n\tPr.y = textureBicubic(uTerrainHeightTexture, Pr.xz  * uTexelSizeInMeters * texelSize, texSize).x * uHeightScaleInMeters + textureBicubic(uWaterHeightTexture, Pr.xz  * uTexelSizeInMeters * texelSize, texSize).x * uHeightScaleInMeters;\n\tPl.y = textureBicubic(uTerrainHeightTexture, Pl.xz  * uTexelSizeInMeters * texelSize, texSize).x * uHeightScaleInMeters + textureBicubic(uWaterHeightTexture, Pl.xz  * uTexelSizeInMeters * texelSize, texSize).x * uHeightScaleInMeters;\n\tPb.y = textureBicubic(uTerrainHeightTexture, Pb.xz  * uTexelSizeInMeters * texelSize, texSize).x * uHeightScaleInMeters + textureBicubic(uWaterHeightTexture, Pb.xz  * uTexelSizeInMeters * texelSize, texSize).x * uHeightScaleInMeters;\n\tPt.y = textureBicubic(uTerrainHeightTexture, Pt.xz  * uTexelSizeInMeters * texelSize, texSize).x * uHeightScaleInMeters + textureBicubic(uWaterHeightTexture, Pt.xz  * uTexelSizeInMeters * texelSize, texSize).x * uHeightScaleInMeters;\n\n\t// Calculate tangent basis vectors using the difference\n\tvec3 dPdu =  Pr - Pl;\n\tvec3 dPdv =  Pt - Pb;\n\n\tvec3 N = normalize(cross(dPdu, dPdv));\n\n\tLightingParams lightingParams;\n\tlightingParams.albedo = vec3(0.0, 0.0, 1.0);\n\tlightingParams.N = N;\n\tlightingParams.V = normalize(uCamPos - P);\n\tlightingParams.metalness = 0.0;\n\tlightingParams.roughness = 0.01;\n\n\tfloat terrainShadowHeight = texture(uTerrainShadowTexture, texCoord).x;\n\tfloat currentHeight = P.y;\n\tfloat penumbraZone = 25.0;\n\tfloat distToShadowHeight = -clamp(currentHeight - terrainShadowHeight, -penumbraZone, 0.0);\n\tfloat shadowAlpha = 1.0 - distToShadowHeight / penumbraZone;\n\tfloat shadow = smoothstep(0.0, 1.0, shadowAlpha);\n\n\tvec3 color = cookTorranceSpecularBrdf(lightingParams, vec3(10.0), normalize(uLightDir)) * shadow;\n\n\tvec3 skyColor = pow(vec3(0.529, 0.808, 0.922), vec3(2.2));\n\n\t// ambient\n\tvec3 ambientColor = mix(vec3(0.18), skyColor, vec3(N.y) * 0.5 + 0.5);\n\tcolor += ambientColor * 2.0 * (1.0 / PI) * lightingParams.albedo;\n\n\t// fog\n\tfloat fogAlpha = exp(-0.66 * linearDepth(gl_FragCoord.z) / 10000.0);\n\tcolor += mix(skyColor, color, clamp(fogAlpha * fogAlpha, 0.0, 1.0));\n\n\n\tcolor = uncharted2Tonemap(1.0 * color);\n\tvec3 whiteScale = 1.0/uncharted2Tonemap(W);\n\tcolor *= whiteScale;\n    // gamma correct\n    color = accurateLinearToSRGB(color);//pow(color, vec3(1.0/2.2));\n\n\tfloat alpha = max(dot(lightingParams.V, lightingParams.N), 0.0);\n\talpha *= alpha;\n\talpha *= alpha;\n\tclamp(alpha, 0.0, 0.7);\n\toColor = vec4(color, 1.0 - alpha);\n}"},function(t,e,n){"use strict";n.r(e),e.default="#version 300 es\n\nprecision mediump float;\n\nuniform mat4 uTransform;\nuniform int uGridResolution;\nuniform float uTexelSizeInMeters;\nuniform float uHeightScaleInMeters;\nuniform sampler2D uTerrainHeightTexture;\nuniform sampler2D uWaterHeightTexture;\n\nout vec3 vWorldSpacePos;\n\nvoid main(void) {\n\tint baseQuad = gl_VertexID / 6;\n\tvec2 quadOffset = vec2(baseQuad % (uGridResolution + 2), baseQuad / (uGridResolution + 2));\n\tint index = gl_VertexID % 6;\n\n\tvec2 positions[6] = vec2[](\n\t\tvec2(0.0, 0.0),\n\t\tvec2(1.0, 0.0),\n\t\tvec2(0.0, 1.0),\n\t\tvec2(0.0, 1.0),\n\t\tvec2(1.0, 0.0),\n\t\tvec2(1.0, 1.0)\n\t);\n\n\tvec3 position = vec3(quadOffset + positions[index], 0.0).xzy;\n\tposition.xz -= 1.0;\n\tposition.xz = position.xz;\n\n\tvec2 coord = position.xz * uTexelSizeInMeters * (1.0 / vec2(textureSize(uTerrainHeightTexture, 0).xy));\n\tposition.y = texture(uTerrainHeightTexture, coord).r * uHeightScaleInMeters;\n\tposition.y += texture(uWaterHeightTexture, coord).r * uHeightScaleInMeters;// - 0.5;\n\tvWorldSpacePos = position;\n\tgl_Position = uTransform * vec4(position, 1.0);\n\tgl_Position.z += 0.0005;\n}"},function(t,e,n){"use strict";e.__esModule=!0;var r=n(20),i=n(15);function o(t){for(var e="",n=new Uint8Array(t.buffer),r=n.byteLength,i=0;i<r;i++)e+=String.fromCharCode(n[i]);return window.btoa(e)}function a(t){for(var e=window.atob(t),n=e.length,r=new Uint8Array(n),i=0;i<n;i++)r[i]=e.charCodeAt(i);return new Float32Array(r.buffer)}e.save=function(t,e,n){var a={initData:n,layers:e.serialize(),trees:r.default.serializeTrees(),heightmap:o(t.getHeightMapData()),layerWeightmaps:t.getLayerWeightData().map(o)},s=JSON.stringify(a);i.downloadBlob("terrain.json",new Blob([s]))},e.load=function(t,e,n,i){var o=new FileReader;o.onload=function(t){if(t.target){var o=t.target.result,s=JSON.parse(o),u=a(s.heightmap),l=s.layerWeightmaps.map(a);e.setHeightMapData(u),e.setLayerWeightData(l),r.default.deserializeTrees(s.trees),n.deserialize(s.layers),i&&i(s)}},o.onerror=function(t){console.error(t),o.abort()},o.readAsText(t)}}]);